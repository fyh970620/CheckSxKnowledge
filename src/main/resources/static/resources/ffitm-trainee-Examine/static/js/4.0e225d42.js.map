{"version":3,"sources":["webpack:///resources/ffitm-trainee-Examine/static/js/4.0e225d42.js","webpack:///../node_modules/kindeditor/kindeditor-all.js","webpack:///./traineeExamineSys/views/examineCreat.vue","webpack:///./traineeExamineSys/views/examineCreat.vue?76aa","webpack:///./traineeExamineSys/views/examineCreat.vue?a43f","webpack:///./traineeExamineSys/views/examineCreat.vue?90bb","webpack:///traineeExamineSys/views/examineCreat.vue"],"names":["webpackJsonp","4uE9","module","exports","window","undefined","_isArray","val","Object","prototype","toString","call","_isFunction","_inArray","arr","i","len","length","_each","obj","fn","key","hasOwnProperty","_trim","str","replace","_inString","delimiter","indexOf","_addUnit","unit","test","_removeUnit","match","exec","parseInt","_escape","_unescape","_toCamel","split","charAt","toUpperCase","substr","_toHex","hex","d","s","$0","$1","$2","$3","_toMap","map","_toArray","offset","Array","slice","_undef","defaultVal","_invalidUrl","url","_addParam","param","_extend","child","parent","proto","childProto","constructor","_json","text","cx","lastIndex","a","charCodeAt","eval","_getBasePath","src","els","document","getElementsByTagName","substring","lastIndexOf","_bindEvent","el","type","addEventListener","_useCapture","attachEvent","_unbindEvent","removeEventListener","detachEvent","KEvent","event","this","init","_getId","_eventExpendo","_setId","_eventId","_removeId","e","removeAttribute","_bind","id","_eventData","events","kevent","push","_unbind","splice","count","_fire","_ctrl","ctrlKey","which","shiftKey","altKey","stop","_ready","readyFunc","loaded","KindEditor","_readyFinished","ieReadyFunc","documentElement","doScroll","setTimeout","ieReadyStateFunc","readyState","toplevel","frameElement","_getCssList","css","list","reg","toLowerCase","_getAttrList","tag","_addClassToTag","className","_formatCss","_formatUrl","mode","host","pathname","getRealPath","path","parts","paths","part","pop","join","getRelativePath","depth","prefix","location","protocol","m","_formatHtml","html","htmlTags","urlType","wellFormatted","indentChar","fontSizeList","htmlTagMap","script","style","re","tagStack","$4","$5","$6","full","startNewline","startSlash","tagName","attr","endSlash","endNewline","_SINGLE_TAG_MAP","_INLINE_TAG_MAP","_PRE_TAG_MAP","_BLOCK_TAG_MAP","attrMap","fontStyleMap","fontStyle","color","_FILL_ATTR_MAP","styleMap","k","v","_clearMsWord","_mediaType","_mediaClass","_mediaAttrs","srcTag","unescape","_mediaEmbed","attrs","_mediaImg","blankPath","width","height","escape","_tmpl","data","Function","_contains","nodeA","nodeB","nodeType","parentNode","_getAttr","_GET_SET_ATTRIBUTE","nodeName","getAttribute","div","ownerDocument","createElement","appendChild","cloneNode","innerHTML","_queryAll","expr","root","stripslashes","cmpTag","tagA","tagB","byId","doc","getElementById","byClass","getElementsByClassName","querySelectorAll","cls","byName","name","getElementsByName","byAttr","select","matches","exprList","mergedResults","results","subResults","j","l","isChild","lenth","_query","_get","K","_getDoc","node","_getWin","parentWindow","defaultView","_setHtml","temp","removeChild","empty","each","_hasClass","_setAttr","_IE","_V","setAttribute","_removeAttr","_getNodeName","_computedCss","win","camelKey","getComputedStyle","getPropertyValue","currentStyle","_hasVal","_VALUE_TAG_MAP","_docElement","_QUIRKS","body","_docHeight","Math","max","scrollHeight","clientHeight","_docWidth","scrollWidth","clientWidth","_getScrollPos","x","y","_NEWIE","_OPERA","scrollLeft","scrollTop","scrollX","scrollY","KNode","_updateCollapsed","range","collapsed","startContainer","endContainer","startOffset","endOffset","_copyAndDelete","isCopy","isDelete","splitTextNode","centerNode","nodeValue","splitText","center","setStart","right","setEnd","nodeList","extractNodes","frag","nextNode","firstChild","testRange","KRange","selectNode","start","compareBoundaryPoints","_START_TO_END","incStart","_START_TO_START","incEnd","_END_TO_END","end","_END_TO_START","nextSibling","childFlag","textNode","copyRange","cloneRange","down","ancestor","commonAncestor","createDocumentFragment","up","collapse","_moveToElementText","knode","moveToElementText","_getStartEnd","rng","isStart","parentElement","pointRange","duplicate","nodes","childNodes","index","startNode","startPos","cmp","compareEndPoints","dummy","nodeRange","newNode","isControl","after","setEndPoint","remove","moveStart","lastChild","prevNode","previousSibling","_getEndRange","createTextRange","children","span","kchild","before","_toRange","tr2td","cells","_IERANGE","item","_range","mixed","_nativeCommand","execCommand","_nativeCommandValue","queryCommandValue","_getSel","selection","getSelection","_getRng","sel","rangeCount","getRangeAt","createRange","_singleKeyMap","newMap","_hasAttrOrCss","_hasAttrOrCssByKey","mapKey","method","_removeAttrOrCss","_removeAttrOrCssByKey","allFlag","removeAttr","_getInnerNode","inner","first","_isEmptyNode","isSingle","_mergeWrapper","b","clone","lastA","childA","merged","_mergeAttrs","append","_wrapNode","wrapper","replaceWith","nodeWrapper","next","styles","_inPreElement","hasClass","KCmd","_cmd","selectNodeContents","_drag","options","moveEl","moveFn","clickEl","beforeDrag","iframeFix","docs","_iframeDoc","pos","mousedown","moveListener","preventDefault","kdoc","target","diffX","_round","pageX","diffY","pageY","selectListener","upListener","unbind","self","releaseCapture","stopPropagation","get","mousemove","mouseup","bind","setCapture","KWidget","_widget","iframe","contentDocument","contentWindow","_getInitHtml","themesPath","bodyClass","cssPath","cssData","_direction","_elementVal","hasVal","KEdit","_edit","_selectToolbar","KToolbar","_toolbar","KMenu","_menu","KColorPicker","_colorpicker","KUploadButton","_uploadbutton","_createButton","arg","btn","click","KDialog","_dialog","_tabs","afterSelect","liList","addClass","ul","add","tab","li","title","selectedIndex","panel","show","removeClass","mouseover","mouseout","hide","_loadScript","head","charset","onload","onreadystatechange","_chopQuery","_loadStyle","link","absoluteUrl","links","href","rel","_ajax","dataType","xhr","XMLHttpRequest","ActiveXObject","open","status","responseText","params","encodeURIComponent","setRequestHeader","send","_plugin","_plugins","_parseLangKey","ns","_lang","langType","_language","_getImageFromRange","sc","so","_WEBKIT","img","_bindContextmenuEvent","edit","contextmenu","menu","hideMenu","useContextmenu","_contextmenus","maxWidth","items","cond","shift","prevItem","clientX","clientY","visibility","shadowMode","addItem","docEl","menuHeight","_bindNewlineEvent","getAncestorTagName","isStyle","newlineTag","_GECKO","brSkipTagMap","pSkipTagMap","keydown","cmd","insertHtml","keyup","p","_bindTabEvent","afterTab","shrink","insertNode","_bindFocusEvent","textarea","focus","afterFocus","blur","afterBlur","_removeBookmarkTag","_removeTempTag","_addBookmarkToStack","stack","bookmark","prev","_undoToRedo","fromStack","toStack","designMode","createBookmark","moveToBookmark","KEditor","setOption","se","srcElement","minWidth","minHeight","_MOBILE","_IOS","initContent","plugin","isCreated","_handlers","_undoStack","_redoStack","_firstAddBookmark","dialogs","_editor","_create","create","editor","basePath","langPath","pluginsPath","loadStyleMode","themeType","_instances","DEBUG","_TIME","_VERSION","_eachEditor","console","log","_ua","navigator","userAgent","compatMode","_matches","Date","getTime","round","VERSION","IE","GECKO","WEBKIT","OPERA","V","TIME","isArray","isFunction","inArray","inString","trim","addUnit","removeUnit","toCamel","toHex","toMap","toArray","undef","invalidUrl","addParam","extend","json","_STYLE_TAG_MAP","_CONTROL_TAG_MAP","_NOSPLIT_TAG_MAP","_AUTOCLOSE_TAG_MAP","fullscreenMode","filterMode","wellFormatMode","resizeType","syncType","pasteType","dialogAlignType","fullscreenShortcut","minChangeSize","zIndex","noDisableItems","colorTable","fontSizeTable","font","table","td,th","embed","p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pre","hr","br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del","layout","_INPUT_KEY_MAP","_CURSORMOVE_KEY_MAP","_CHANGE_KEY_MAP","_EVENT_PROPS","relatedTarget","fromElement","toElement","clientLeft","clientTop","charCode","keyCode","metaKey","button","ev","returnValue","cancelBubble","ctrl","ready","formatUrl","formatHtml","getCssList","getAttrList","mediaType","mediaAttrs","mediaEmbed","mediaImg","clearMsWord","tmpl","_getSetAttrDiv","query","queryAll","fire","hasAttr","outer","eq","RegExp","innerText","textContent","value","offsetWidth","offsetHeight","opacity","filter","getBoundingClientRect","box","left","top","offsetLeft","offsetTop","offsetParent","bool","appendTo","insertBefore","replaceChild","keepChilds","_originDisplay","display","isInline","isBlock","contains","otherNode","last","sibling","scan","order","walk","n","_K","arguments","NodeClass","_BOOKMARK_ID","getParents","parents","parentA","parentB","parentsA","parentsB","lenA","lenB","setStartBefore","setStartAfter","setEndBefore","setEndAfter","toStart","how","rangeA","rangeB","nodeC","posA","posB","diff","cloneContents","deleteContents","extractContents","c","ec","eo","nodeCount","surroundContents","hasControlRange","createControlRange","addElement","downPos","upPos","enlarge","toBlock","enlargePos","serialize","endNode","dump","RangeClass","START_TO_START","START_TO_END","END_TO_END","END_TO_START","forceReset","hasDummy","hasU200b","ex","createTextNode","removeAllRanges","addRange","scrollTo","wrap","copyWrapper","tempRange","needSplit","dummyParent","ksc","kscp","sb","sa","startBefore","startDummy","endDummy","cmpStart","startAfter","endAfter","commonNode","find","cNode","state","queryCommandState","lc","h1,h2,h3,h4,h5,h6,p,div,pre,address","*","toggle","bold","strong","italic","em","underline","u","strikethrough","forecolor","hilitecolor","fontsize","fontname","fontfamily","removeformat","inserthtml","quickMode","outerHTML","pasteHTML","newRange","print","insertimage","border","align","createlink","setAttr","unlink","queryCommandSupported","CmdClass","z","_alignEl","alignEl","position","z-index","autoPos","autoScroll","scrollPos","updateProp","w","h","draggable","WidgetClass","widget","dir","isDocumentDomain","domain","write","close","afterChange","_mousedownHandler","disabled","contentEditable","afterCreate","beforeGetHtml","beforeSetHtml","afterSetHtml","srcScript","iframeSrc","tabIndex","isNaN","setWidth","setHeight","isFull","design","input","timeoutHandler","EditClass","iframeDoc","hover","disableMode","noDisableItemMap","_itemMap","unselect","enable","disable","disableAll","ToolbarClass","toolbar","centerLineMode","itemDiv","leftDiv","rightDiv","iconClass","centerDiv","checked","beforeRemove","MenuClass","colors","selectedColor","_cells","cellPadding","cellSpacing","row","insertRow","cell","insertCell","colSpan","_addAttr","noColor","ColorPickerClass","colorpicker","fieldName","extraParams","afterError","alert","hiddenElements","form","fileBox","submit","tempForm","reset","afterUpload","UploadButtonClass","uploadbutton","previewBtn","yesBtn","noBtn","closeBtn","showMask","contentDiv","iframeMask","headerDiv","closeIcon","bodyDiv","footerDiv","mask","docWidth","docHeight","isLoading","setMaskIndex","showLoading","msg","loading","hideLoading","DialogClass","dialog","tabs","loadScript","loadStyle","ajax","lang","loadPlugin","handler","clickToolbar","updateState","addContextmenu","initResize","statusbar","resize","overflow","container","toolbarDiv","editDiv","_scrollPos","_fullscreenExecuted","htmlList","menuName","editHeight","_docMousedownFn","addBookmark","readonlyMode","readonly","_fullscreenResizeHandler","hideDialog","fullHtml","isEmpty","isDirty","selectedHtml","changeFlag","apply","appendHtml","sync","checkSize","abs","undo","redo","fullscreen","isReadonly","createMenu","hideContextmenu","createDialog","firstDialog","parentDialog","errorDialog","EditorClass","instances","shortcutKeys","selectall","hasForm","resetBtn","blocks","heights","h1","h2","h3","H4","curVal","getSelectedLink","getSelectedImage","getSelectedFlash","getSelectedMedia","getSelectedAnchor","uName","getSelectedTable","getSelectedRow","getSelectedCell","movePastedData","pasting","white-space","imgAttrs","code","source","preview","cut","copy","paste","plainpaste","wordpaste","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","formatblock","image","multiimage","flash","media","tablecell","emoticons","about","filemanager","baidumap","lineheight","clearhtml","pagebreak","quickformat","insertfile","template","anchor","yes","no","editImage","deleteImage","editFlash","deleteFlash","editMedia","deleteMedia","editLink","deleteLink","editAnchor","deleteAnchor","tableprop","tablecellprop","tableinsert","tabledelete","tablecolinsertleft","tablecolinsertright","tablerowinsertabove","tablerowinsertbelow","tablerowmerge","tablecolmerge","tablerowsplit","tablecolsplit","tablecoldelete","tablerowdelete","pleaseSelectFile","invalidImg","invalidMedia","invalidWidth","invalidHeight","invalidBorder","invalidRows","invalidCols","invalidPadding","invalidSpacing","invalidJson","uploadSuccess","cutError","copyError","pasteError","ajaxLoading","uploadLoading","uploadError","plainpaste.comment","wordpaste.comment","code.pleaseInput","link.url","link.linkType","link.newWindow","link.selfWindow","flash.url","flash.width","flash.height","flash.upload","flash.viewServer","media.url","media.width","media.height","media.autostart","media.upload","media.viewServer","image.remoteImage","image.localImage","image.remoteUrl","image.localUrl","image.size","image.width","image.height","image.resetSize","image.align","image.defaultAlign","image.leftAlign","image.rightAlign","image.imgTitle","image.upload","image.viewServer","multiimage.uploadDesc","multiimage.startUpload","multiimage.clearAll","multiimage.insertAll","multiimage.queueLimitExceeded","multiimage.fileExceedsSizeLimit","multiimage.zeroByteFile","multiimage.invalidFiletype","multiimage.unknownError","multiimage.pending","multiimage.uploadError","filemanager.emptyFolder","filemanager.moveup","filemanager.viewType","filemanager.viewImage","filemanager.listImage","filemanager.orderType","filemanager.fileName","filemanager.fileSize","filemanager.fileType","insertfile.url","insertfile.title","insertfile.upload","insertfile.viewServer","table.cells","table.rows","table.cols","table.size","table.width","table.height","table.percent","table.px","table.space","table.padding","table.spacing","table.align","table.textAlign","table.verticalAlign","table.alignDefault","table.alignLeft","table.alignCenter","table.alignRight","table.alignTop","table.alignMiddle","table.alignBottom","table.alignBaseline","table.border","table.borderWidth","table.borderColor","table.backgroundColor","map.address","map.search","baidumap.address","baidumap.search","baidumap.insertDynamicMap","anchor.name","formatblock.formatBlock","h4","fontname.fontName","SimSun","NSimSun","FangSong_GB2312","KaiTi_GB2312","SimHei","Microsoft YaHei","Arial","Arial Black","Times New Roman","Courier New","Tahoma","Verdana","lineheight.lineHeight","1","1.5","2","2.5","3","template.selectTemplate","template.replaceContent","template.fileList","1.html","2.html","3.html","nameBox","delete","hideScroll","scroll","overflowY","resetHeight","autoHeightMode","mapWidth","mapHeight","address","search","insertDynamicMap","centerObj","getCenter","lng","lat","zoom","getZoom","checkbox","searchBtn","addressBox","geocoder","maptype","getMapTypeId","div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pleaseInput","emoticonsPath","allowPreview","allowPreviewEmoticons","currentPageNum","bindCellEvent","num","previewDiv","colsHalf","previewImg","createEmoticonsTable","pageNum","parentDiv","elements","startNum","rows","cols","removeEvent","bindPageEvent","pageDiv","wrapperDiv","createPageTable","pages","ceil","floor","makeFileTitle","filename","filesize","datetime","bindTitle","is_dir","fileManagerJson","imgPath","filemanagerDialog","reloadPage","func","dirName","bindEvent","result","createFunc","fileUrl","current_url","dirPath","current_dir_path","orderTypeBox","is_photo","clickFn","elList","createCommon","changeFunc","viewTypeBox","createView","createList","moveupLink","moveup_dir_path","change","fileList","file_list","iconUrl","cell0","has_file","emptyFolder","photoDiv","viewType","moveup","viewImage","listImage","orderType","fileName","fileSize","fileType","allowFlashUpload","allowFileManager","formatUploadUrl","extraFileUploadParams","filePostName","uploadJson","upload","viewServer","urlBox","widthBox","heightBox","quality","viewServerBtn","error","message","afterSelectFile","allowImageUpload","allowImageRemote","imageTabIndex","fillDescAfterUploadImage","imageDialog","setSize","originalWidth","originalHeight","showRemote","imageUrl","imageWidth","imageHeight","imageTitle","imageAlign","showLocal","remoteUrl","size","resetSize","imgTitle","localUrl","dialogWidth","dialogHeight","localUrlBox","titleBox","alignBox","refreshBtn","remoteImage","localImage","tempImg","allowFileUpload","fileDialog","fileTitle","lineHeight","linkType","typeBox","Option","newWindow","selfWindow","allowMediaUpload","autostart","autostartBox","loop","KSWFUpload","showError","progressbars","uploadDesc","startButtonValue","settings","debug","upload_url","uploadUrl","flash_url","flashUrl","file_post_name","button_placeholder","button_image_url","buttonImageUrl","button_width","buttonWidth","button_height","buttonHeight","button_cursor","SWFUpload","CURSOR","HAND","file_types","fileTypes","file_types_description","fileTypesDesc","file_upload_limit","fileUploadLimit","file_size_limit","fileSizeLimit","post_params","postParams","file_queued_handler","file","fileIconUrl","appendFile","file_queue_error_handler","errorCode","errorName","QUEUE_ERROR","QUEUE_LIMIT_EXCEEDED","queueLimitExceeded","FILE_EXCEEDS_SIZE_LIMIT","fileExceedsSizeLimit","ZERO_BYTE_FILE","zeroByteFile","INVALID_FILETYPE","invalidFiletype","unknownError","upload_start_handler","upload_progress_handler","bytesLoaded","bytesTotal","percent","progressbar","bar","upload_error_handler","filestatus","FILE_STATUS","ERROR","errorMessage","upload_success_handler","serverData","swfu","startUpload","getUrlList","COMPLETE","removeFile","fileId","cancelUpload","removeFiles","statusDiv","pendingMessage","destroy","swfupload","element","imageSizeLimit","imageUploadLimit","imageFileTypes","multiImageDialog","uploadLimit","sizeLimit","insertAll","clearAll","pending","urlList","initSWFUpload","customSettings","eventQueue","movieName","movieCount","movieElement","initSettings","loadFlash","displayDebugInfo","version","UPLOAD_ERROR","HTTP_ERROR","MISSING_UPLOAD_URL","IO_ERROR","SECURITY_ERROR","UPLOAD_LIMIT_EXCEEDED","UPLOAD_FAILED","SPECIFIED_FILE_ID_NOT_FOUND","FILE_VALIDATION_FAILED","FILE_CANCELLED","UPLOAD_STOPPED","QUEUED","IN_PROGRESS","CANCELLED","BUTTON_ACTION","SELECT_FILE","SELECT_FILES","START_UPLOAD","ARROW","WINDOW_MODE","WINDOW","TRANSPARENT","OPAQUE","completeURL","indexSlash","hostname","port","ensureDefault","settingName","defaultValue","debug_enabled","return_upload_start_handler","returnUploadStart","debugMessage","custom_settings","prevent_swf_caching","preserve_relative_urls","targetElement","tempParent","button_placeholder_id","getFlashHTML","getMovieElement","classid","button_window_mode","getFlashVars","paramString","buildParamString","httpSuccessString","http_success","use_query_string","requeue_on_error","assume_success_timeout","file_queue_limit","button_text","button_text_top_padding","button_text_left_padding","button_text_style","button_action","button_disabled","paramStringPairs","ex1","ex2","swfupload_loaded_handler","file_dialog_start_handler","upload_complete_handler","debug_handler","addSetting","default_value","getSetting","callFlash","functionName","argumentArray","returnString","CallFunction","__flash__argumentsToXML","post","unescapeFilePostParams","selectFile","selectFiles","fileID","triggerErrorEvent","stopUpload","getStats","setStats","statsObject","getFile","addFileParam","removeFileParam","setUploadURL","setPostParams","paramsObject","addPostParam","removePostParam","setFileTypes","types","description","setFileSizeLimit","setFileUploadLimit","setFileQueueLimit","fileQueueLimit","setFilePostName","setUseQueryString","useQueryString","setRequeueOnError","requeueOnError","setHTTPSuccess","http_status_codes","setAssumeSuccessTimeout","timeout_seconds","setDebugEnabled","debugEnabled","setButtonImageURL","buttonImageURL","setButtonDimensions","movie","setButtonText","setButtonTextPadding","setButtonTextStyle","setButtonDisabled","isDisabled","setButtonAction","buttonAction","setButtonCursor","cursor","queueEvent","handlerName","executeNextEvent","f","uk","unescapedPost","String","fromCharCode","testExternalInterface","flashReady","cleanUp","instance","flashEx","fileDialogStart","fileQueued","fileQueueError","fileDialogComplete","numFilesSelected","numFilesQueued","numFilesInQueue","uploadStart","uploadProgress","bytesComplete","responseReceived","uploadComplete","exceptionMessage","exceptionValues","Console","writeLine","documentForm","fontFamily","margin","queue","oldInitSettings","queueSettings","queue_cancelled_flag","queue_upload_count","user_upload_complete_handler","user_upload_start_handler","uploadCompleteHandler","uploadStartHandler","queue_complete_handler","cancelQueue","stats","files_queued","pagebreakHtml","tail","comment","getFirstChild","blockMap","subList","_setColor","_initColorPicker","dialogDiv","colorBox","removePicker","pickerList","picker","_getCellIndex","rowSpanCount","rowSpan","cellIndex","prop","isInsert","px","space","padding","spacing","alignDefault","alignLeft","alignCenter","alignRight","borderWidth","borderColor","backgroundColor","rowsBox","colsBox","widthType","widthTypeBox","heightType","heightTypeBox","paddingBox","spacingBox","borderBox","bgColor","tableWidth","tableHeight","cellprop","textAlign","verticalAlign","alignTop","alignMiddle","alignBottom","alignBaseline","textAlignBox","verticalAlignBox","background-color","text-align","vertical-align","border-width","border-style","border-color","cellWidth","cellHeight","insert","colinsert","newRow","newCell","colinsertleft","colinsertright","rowinsert","rowIndex","rowinsertabove","rowinsertbelow","rowmerge","nextRowIndex","nextRow","nextCell","deleteCell","colmerge","nextCellIndex","rowsplit","colsplit","coldelete","rowdelete","deleteRow","getFilePath","htmlPath","selectTemplate","replaceContent","selectBox","A6Ut","__webpack_exports__","__webpack_require__","injectStyle","ssrContext","defineProperty","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue___default","__WEBPACK_IMPORT_KEY__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_6fa29fdf_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_examineCreat_vue__","normalizeComponent","__vue_styles__","Component","EzXv","content","locals","JP4Z","ODjE","render","_vm","_h","$createElement","_c","_self","staticClass","ref","label-position","labelPosition","inline","label-width","rules","model","addDetail","label","placeholder","callback","$$v","staffname","expression","_v","grade","_n","staffGroupType","_l","typeId","typeValue","value-format","visitCreateDate","collectRemark","slot","on","$event","adddetail","cancel","staticRenderFns","esExports","T+6A","_service","_service2","__esModule","default","required","trigger","Contents","Contentss","Contentsss","subjectName","staffID","editDetail","weeklyType","subjectClass","staffType","weeklyDetail","mounted","getAauthor","getselect","methods","_this","getListGroupType","then","res","catch","err","_this2","getListSxByGType","Aauthor","staffId","formName","_this3","$refs","validate","valid","checkStaffId","$route","csc","addCheckStaffComment","response","iFdl"],"mappings":"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AAA84C,cAAA,mBACA94C,KAAA84C,cAAA,4BACA94C,KAAA84C,cAAA,oBACA94C,KAAA84C,cAAA,sCACA94C,KAAA84C,cAAA,qBACA94C,KAAA84C,cAAA,uBACA94C,KAAA84C,cAAA,sBACA94C,KAAA84C,cAAA,6BDMC94C,KAAK84C,cAAc,uBAAuB,GCJ3C94C,KAAA84C,cAAA,uBACA94C,KAAA84C,cAAA,kBACA94C,KAAA84C,cAAA,mBACA94C,KAAA84C,cAAA,kBACA94C,KAAA84C,cAAA,wDACA94C,KAAA84C,cAAA,6BACA94C,KAAA84C,cAAA,8BACA94C,KAAA84C,cAAA,gBAAAxG,UAAA2F,cAAAE,cACAn4C,KAAA84C,cAAA,sBACA94C,KAAA84C,cAAA,4BACA94C,KAAA84C,cAAA,2BACA94C,KAAA84C,cAAA,gBAAAxG,UAAAC,OAAA8F,OACAr4C,KAAA84C,cAAA,qBAAAxG,UAAAgG,YAAAC,QACAv4C,KAAA84C,cAAA,YDMC94C,KAAKuxC,SAAS0H,cAAgBj5C,KAAKuxC,SAASC,MCJ7CxxC,KAAAuxC,SAAA2H,4BAAAl5C,KAAAm5C,kBACAn5C,KAAA84C,cAAA,iCACA94C,KAAA84C,cAAA,kCACA94C,KAAA84C,cAAA,4BACA94C,KAAA84C,cAAS,iCACT94C,KAAA84C,cAAS,qCACT94C,KAAA84C,cAAS,6BACT94C,KAAA84C,cAAS,gCACT94C,KAAA84C,cAAS,6BACT94C,KAAA84C,cAAS,+BACT94C,KAAA84C,cAAS,gCACT94C,KAAA84C,cAAS,gBAAA94C,KAAAo5C,cACTp5C,KAAA84C,cAAS,sBACT94C,KAAA02C,eAAS12C,KAAAuxC,SAAA8H,gBACTr5C,KAASuxC,SAAA+H,sBACTt5C,KAAAuxC,SAASI,UAAA3xC,KAAAuxC,SAAAI,WAAA3xC,KAAAuxC,SAAAI,UAAA71C,QAAA,yCAAAgmB,OAAAC,WAET/hB,KAASuxC,SAAAgI,yBACTv5C,KAAAuxC,SAASE,WAAAa,UAAAoG,YAAA14C,KAAAuxC,SAAAE,YACTzxC,KAAAuxC,SAASQ,iBAAAO,U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","file":"resources/ffitm-trainee-Examine/static/js/4.0e225d42.js","sourcesContent":["webpackJsonp([4],{\n\n/***/ \"4uE9\":\n/***/ (function(module, exports) {\n\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n/***/ }),\n\n/***/ \"A6Ut\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue__ = __webpack_require__(\"T+6A\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue__);\n/* harmony namespace reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue__[key]; }) }(__WEBPACK_IMPORT_KEY__));\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_6fa29fdf_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_examineCreat_vue__ = __webpack_require__(\"ODjE\");\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"EzXv\")\n}\nvar normalizeComponent = __webpack_require__(\"/4AN\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6fa29fdf\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineCreat_vue___default.a,\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_6fa29fdf_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_examineCreat_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"EzXv\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"JP4Z\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"X/Wc\")(\"75a66a26\", content, true, {});\n\n/***/ }),\n\n/***/ \"JP4Z\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"lcwS\")(false);\n// imports\n\n\n// module\nexports.push([module.i, \".main-ctn[data-v-6fa29fdf]{background:#f8f8f8}.bg-purple[data-v-6fa29fdf]{background:#fff;border-radius:8px}.main-content[data-v-6fa29fdf]{padding-top:30px}.el-form-item[data-v-6fa29fdf]{margin-top:5px}.main-content .dialog-footer[data-v-6fa29fdf]{margin:0 auto}.weekly-footer[data-v-6fa29fdf]{float:left;margin-left:40%!important;margin-bottom:20px!important}.knowledge-content-editor[data-v-6fa29fdf]{width:110%}.updateweekly[data-v-6fa29fdf]{margin-top:5px;float:left;font-weight:400;color:#66666f}.selfile[data-v-6fa29fdf]{margin-left:10px!important}.upload-demo[data-v-6fa29fdf]{margin-left:58px;width:80%;padding-bottom:20px}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"ODjE\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-ctn\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"main-content clearfix\"},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"250px\",\"rules\":_vm.rules,\"model\":_vm.addDetail}},[_c('el-form-item',{attrs:{\"label\":\"考核人\",\"prop\":\"staffname\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"name\":\"createStaffId\",\"disabled\":true},model:{value:(_vm.addDetail.staffname),callback:function ($$v) {_vm.addDetail.staffname=$$v},expression:\"addDetail.staffname\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核分数\",\"prop\":\"grade\"}},[_c('el-input',{attrs:{\"placeholder\":\"考核分数\",\"name\":\"grade\"},model:{value:(_vm.addDetail.grade),callback:function ($$v) {_vm.addDetail.grade=_vm._n($$v)},expression:\"addDetail.grade\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"staffGroupType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.addDetail.staffGroupType),callback:function ($$v) {_vm.addDetail.staffGroupType=$$v},expression:\"addDetail.staffGroupType\"}},_vm._l((_vm.staffGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核时间\",\"prop\":\"visitCreateDate\"}},[[_c('el-date-picker',{attrs:{\"type\":\"date\",\"placeholder\":\"选择考核日期\",\"value-format\":\"yyyy-MM-dd\"},model:{value:(_vm.addDetail.visitCreateDate),callback:function ($$v) {_vm.addDetail.visitCreateDate=$$v},expression:\"addDetail.visitCreateDate\"}})]],2),_vm._v(\" \"),_c('el-form-item',{staticClass:\"collect\",attrs:{\"label\":\"新人考核评价\",\"prop\":\"collectRemark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.addDetail.collectRemark),callback:function ($$v) {_vm.addDetail.collectRemark=$$v},expression:\"addDetail.collectRemark\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"weekly-footer\",slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.adddetail(_vm.addDetail,'formName')}}},[_vm._v(\"新增\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cancel()}}},[_vm._v(\"取消\")])],1)],1)])])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n\n/***/ \"T+6A\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _service = __webpack_require__(\"CxL4\");\n\nvar _service2 = _interopRequireDefault(_service);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(\"4uE9\"); //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n__webpack_require__(\"iFdl\");\nexports.default = {\n  data: function data() {\n    return {\n      rules: {\n        grade: [{\n          required: true,\n          message: \"请输入考核分数\",\n          trigger: \"blur\"\n        }],\n        staffGroupType: [{\n          required: true,\n          message: \"请选择归属组\",\n          trigger: \"blur\"\n        }],\n        visitCreateDate: [{\n          required: true,\n          message: \"请选择考核时间\",\n          trigger: \"blur\"\n        }],\n        collectRemark: [{\n          required: true,\n          message: \"请输入考核评价\",\n          trigger: \"blur\"\n        }]\n      },\n      labelPosition: \"right\",\n      addDetail: {\n        staffGroupType: \"\"\n      },\n      Contents: \"\",\n      Contentss: \"\",\n      Contentsss: \"\",\n      subjectName: \"\",\n      staffname: \"\",\n      staffID: \"\",\n      editDetail: {},\n      weeklyType: [],\n      staffGroupType: [],\n      subjectClass: [],\n      staffType: [],\n      weeklyDetail: {}\n    };\n  },\n  mounted: function mounted() {\n    this.getAauthor();\n    this.getselect();\n  },\n  methods: {\n    getselect: function getselect() {\n      var _this = this;\n\n      _service2.default.getListGroupType().then(function (res) {\n        _this.staffGroupType = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    getAauthor: function getAauthor() {\n      var _this2 = this;\n\n      _service2.default.getListSxByGType().then(function (res) {\n        console.log(res);\n        _this2.Aauthor = res.data[4];\n        console.log(_this2.Aauthor);\n        _this2.staffname = _this2.Aauthor.staffname;\n        _this2.staffID = _this2.Aauthor.staffId;\n        console.log(_this2.staffname);\n        _this2.addDetail = {\n          subjectName: _this2.subjectName,\n          staffname: _this2.staffname,\n          staffGroupType: \"\",\n          visitCreateDate: \"\",\n          collectRemark: \"\"\n        };\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n\n    //取消\n    cancel: function cancel() {\n      window.close();\n    },\n\n    //新增\n    adddetail: function adddetail(addDetail, formName) {\n      var _this3 = this;\n\n      this.$refs[\"formName\"].validate(function (valid) {\n        if (valid) {\n          _this3.addDetail = {\n            checkStaffId: _this3.$route.query.checkStaffId,\n            staffId: _this3.staffID,\n            visitCreateDate: _this3.addDetail.visitCreateDate,\n            grade: _this3.addDetail.grade,\n            staffGroupType: _this3.addDetail.staffGroupType,\n            collectRemark: _this3.addDetail.collectRemark\n          };\n          console.log(_this3.addDetail);\n          var params = {\n            csc: _this3.addDetail\n          };\n          console.log(params);\n          _service2.default.addCheckStaffComment(params).then(function (response) {\n            alert(\"添加成功\");\n            window.close();\n          }).catch(function (error) {\n            console.log(error);\n          });\n        } else {\n          return false;\n        }\n      });\n    }\n  }\n};\n\n/***/ }),\n\n/***/ \"iFdl\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// resources/ffitm-trainee-Examine/static/js/4.0e225d42.js","/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/kindeditor/kindeditor-all.js\n// module id = 4uE9\n// module chunks = 0 1 2 3 4","function injectStyle (ssrContext) {\n  require(\"!!vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6fa29fdf\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./examineCreat.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./examineCreat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./examineCreat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6fa29fdf\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./examineCreat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6fa29fdf\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./traineeExamineSys/views/examineCreat.vue\n// module id = A6Ut\n// module chunks = 4","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6fa29fdf\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./examineCreat.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"75a66a26\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-style-loader!../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-6fa29fdf\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/examineCreat.vue\n// module id = EzXv\n// module chunks = 4","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".main-ctn[data-v-6fa29fdf]{background:#f8f8f8}.bg-purple[data-v-6fa29fdf]{background:#fff;border-radius:8px}.main-content[data-v-6fa29fdf]{padding-top:30px}.el-form-item[data-v-6fa29fdf]{margin-top:5px}.main-content .dialog-footer[data-v-6fa29fdf]{margin:0 auto}.weekly-footer[data-v-6fa29fdf]{float:left;margin-left:40%!important;margin-bottom:20px!important}.knowledge-content-editor[data-v-6fa29fdf]{width:110%}.updateweekly[data-v-6fa29fdf]{margin-top:5px;float:left;font-weight:400;color:#66666f}.selfile[data-v-6fa29fdf]{margin-left:10px!important}.upload-demo[data-v-6fa29fdf]{margin-left:58px;width:80%;padding-bottom:20px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-6fa29fdf\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/examineCreat.vue\n// module id = JP4Z\n// module chunks = 4","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-ctn\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"main-content clearfix\"},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"250px\",\"rules\":_vm.rules,\"model\":_vm.addDetail}},[_c('el-form-item',{attrs:{\"label\":\"考核人\",\"prop\":\"staffname\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"name\":\"createStaffId\",\"disabled\":true},model:{value:(_vm.addDetail.staffname),callback:function ($$v) {_vm.addDetail.staffname=$$v},expression:\"addDetail.staffname\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核分数\",\"prop\":\"grade\"}},[_c('el-input',{attrs:{\"placeholder\":\"考核分数\",\"name\":\"grade\"},model:{value:(_vm.addDetail.grade),callback:function ($$v) {_vm.addDetail.grade=_vm._n($$v)},expression:\"addDetail.grade\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"staffGroupType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.addDetail.staffGroupType),callback:function ($$v) {_vm.addDetail.staffGroupType=$$v},expression:\"addDetail.staffGroupType\"}},_vm._l((_vm.staffGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核时间\",\"prop\":\"visitCreateDate\"}},[[_c('el-date-picker',{attrs:{\"type\":\"date\",\"placeholder\":\"选择考核日期\",\"value-format\":\"yyyy-MM-dd\"},model:{value:(_vm.addDetail.visitCreateDate),callback:function ($$v) {_vm.addDetail.visitCreateDate=$$v},expression:\"addDetail.visitCreateDate\"}})]],2),_vm._v(\" \"),_c('el-form-item',{staticClass:\"collect\",attrs:{\"label\":\"新人考核评价\",\"prop\":\"collectRemark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.addDetail.collectRemark),callback:function ($$v) {_vm.addDetail.collectRemark=$$v},expression:\"addDetail.collectRemark\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"weekly-footer\",slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.adddetail(_vm.addDetail,'formName')}}},[_vm._v(\"新增\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cancel()}}},[_vm._v(\"取消\")])],1)],1)])])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6fa29fdf\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!../node_modules/vue-loader/lib/selector.js?type=template&index=0!./traineeExamineSys/views/examineCreat.vue\n// module id = ODjE\n// module chunks = 4","<template>\r\n  <div class=\"main-ctn\">\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <div class=\"grid-content bg-purple\">\r\n          <div class=\"main-content clearfix\">\r\n            <el-form :label-position=\"labelPosition\" :inline=\"true\" label-width=\"250px\" :rules=\"rules\" :model=\"addDetail\" ref=\"formName\">\r\n              <el-form-item label=\"考核人\"  prop=\"staffname\">\r\n                <el-input v-model=\"addDetail.staffname\" placeholder=\"\" name=\"createStaffId\" :disabled=\"true\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"考核分数\"  prop=\"grade\">\r\n                <el-input v-model.number=\"addDetail.grade\" placeholder=\"考核分数\" name=\"grade\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"归属组\" prop=\"staffGroupType\">\r\n              <template>\r\n                <el-select v-model=\"addDetail.staffGroupType\" placeholder=\"请选择您的归属组\"  >\r\n                   <el-option v-for=\"item in staffGroupType\" :key=\"item.typeId\" :label=\"item.typeValue\"  :value=\"item.typeId\"></el-option>\r\n                </el-select>\r\n              </template>\r\n              </el-form-item>\r\n              <el-form-item label=\"考核时间\" prop=\"visitCreateDate\" >\r\n               <template>\r\n                 <el-date-picker  v-model=\"addDetail.visitCreateDate\" type=\"date\"  placeholder=\"选择考核日期\" value-format=\"yyyy-MM-dd\">\r\n                 </el-date-picker>\r\n               </template>\r\n              </el-form-item>               \r\n              <el-form-item label=\"新人考核评价\" prop=\"collectRemark\" class=\"collect\">\r\n                <el-input type=\"textarea\" v-model=\"addDetail.collectRemark\"></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"weekly-footer\">\r\n              <el-button @click=\"adddetail(addDetail,'formName')\" >新增</el-button>\r\n              <el-button type=\"primary\" @click=\"cancel()\">取消</el-button>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport service from \"../scripts/service.js\";\r\nrequire(\"kindeditor\");\r\nrequire(\"kindeditor/themes/default/default.css\");\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      rules: {\r\n        grade: [\r\n          {\r\n            required: true,\r\n            message: \"请输入考核分数\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        staffGroupType: [\r\n          {\r\n            required: true,\r\n            message: \"请选择归属组\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        visitCreateDate: [\r\n          {\r\n            required: true,\r\n            message: \"请选择考核时间\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        collectRemark: [\r\n          {\r\n            required: true,\r\n            message: \"请输入考核评价\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      },\r\n      labelPosition: \"right\",\r\n      addDetail: {\r\n        staffGroupType: \"\"\r\n      },\r\n      Contents: \"\",\r\n      Contentss: \"\",\r\n      Contentsss: \"\",\r\n      subjectName: \"\",\r\n      staffname: \"\",\r\n      staffID: \"\",\r\n      editDetail: {},\r\n      weeklyType: [],\r\n      staffGroupType: [],\r\n      subjectClass: [],\r\n      staffType: [],\r\n      weeklyDetail: {}\r\n    };\r\n  },\r\n  mounted: function() {\r\n    this.getAauthor();\r\n    this.getselect();\r\n  },\r\n  methods: {\r\n    getselect() {\r\n      service\r\n        .getListGroupType()\r\n        .then(res => {\r\n          this.staffGroupType = res.data;\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    getAauthor() {\r\n      service\r\n        .getListSxByGType()\r\n        .then(res => {\r\n          console.log(res);\r\n          this.Aauthor = res.data[4];\r\n          console.log(this.Aauthor);\r\n          this.staffname = this.Aauthor.staffname;\r\n          this.staffID = this.Aauthor.staffId;\r\n          console.log(this.staffname);\r\n          this.addDetail = {\r\n            subjectName: this.subjectName,\r\n            staffname: this.staffname,\r\n            staffGroupType: \"\",\r\n            visitCreateDate: \"\",\r\n            collectRemark: \"\"\r\n          };\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    //取消\r\n    cancel() {\r\n      window.close();\r\n    },\r\n    //新增\r\n    adddetail(addDetail, formName) {\r\n      this.$refs[\"formName\"].validate(valid => {\r\n        if (valid) {\r\n          this.addDetail = {\r\n            checkStaffId: this.$route.query.checkStaffId,\r\n            staffId: this.staffID,\r\n            visitCreateDate: this.addDetail.visitCreateDate,\r\n            grade: this.addDetail.grade,\r\n            staffGroupType: this.addDetail.staffGroupType,\r\n            collectRemark: this.addDetail.collectRemark\r\n          };\r\n          console.log(this.addDetail);\r\n          let params = {\r\n            csc: this.addDetail\r\n          };\r\n          console.log(params);\r\n          service\r\n            .addCheckStaffComment(params)\r\n            .then(response => {\r\n              alert(\"添加成功\");\r\n              window.close();\r\n            })\r\n            .catch(error => {\r\n              console.log(error);\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.main-ctn {\r\n  background: #f8f8f8;\r\n}\r\n.bg-purple {\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n}\r\n.main-content {\r\n  padding-top: 30px;\r\n}\r\n.el-form-item {\r\n  margin-top: 5px;\r\n}\r\n.main-content .dialog-footer {\r\n  margin: 0 auto;\r\n}\r\n.weekly-footer {\r\n  float: left;\r\n  margin-left: 40% !important;\r\n  margin-bottom: 20px !important;\r\n}\r\n.knowledge-content-editor {\r\n  width: 110%;\r\n}\r\n.updateweekly {\r\n  margin-top: 5px;\r\n  float: left;\r\n  font-weight: 400;\r\n  color: #66666f;\r\n}\r\n.selfile {\r\n  margin-left: 10px !important;\r\n}\r\n.upload-demo {\r\n  margin-left: 58px;\r\n  width: 80%;\r\n  padding-bottom: 20px;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// traineeExamineSys/views/examineCreat.vue"],"sourceRoot":""}