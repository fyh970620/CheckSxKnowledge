{"version":3,"sources":["webpack:///resources/ffitm-trainee-Examine/static/js/3.2543d880.js","webpack:///./traineeExamineSys/views/examineModify.vue?bf54","webpack:///traineeExamineSys/views/examineModify.vue","webpack:///../node_modules/kindeditor/kindeditor-all.js","webpack:///./traineeExamineSys/views/examineModify.vue?8a45","webpack:///./traineeExamineSys/views/examineModify.vue","webpack:///./traineeExamineSys/views/examineModify.vue?b9a1"],"names":["webpackJsonp","+CSO","module","__webpack_exports__","__webpack_require__","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","span","ref","label-position","labelPosition","inline","label-width","rules","model","editDetail","label","prop","placeholder","name","disabled","value","callback","$$v","staffname","expression","_v","grade","_n","staffGroupType","_l","item","key","typeId","typeValue","type","value-format","visitCreateDate","collectRemark","slot","on","click","$event","update","cancel","staticRenderFns","esExports","/HRr","exports","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","_defineProperty2","_defineProperty3","_service","_service2","data","_ref","required","message","trigger","Contents","Contentss","Contentsss","subjectName","staffID","mounted","getAauthor","getselect","methods","_this","getListGroupType","then","res","catch","err","console","log","_this2","getListSxByGType","Aauthor","staffId","checkId","$route","query","checkStaffId","window","close","formName","_this3","$refs","validate","valid","params","csc","updateOneStaffComment","response","alert","error","4uE9","undefined","_isArray","val","prototype","toString","call","_isFunction","_inArray","arr","i","len","length","_each","fn","hasOwnProperty","_trim","str","replace","_inString","delimiter","indexOf","_addUnit","unit","test","_removeUnit","match","exec","parseInt","_escape","_unescape","_toCamel","split","charAt","toUpperCase","substr","_toHex","hex","d","s","$0","$1","$2","$3","_toMap","map","_toArray","offset","Array","slice","_undef","defaultVal","_invalidUrl","url","_addParam","param","_extend","child","parent","proto","childProto","constructor","_json","text","cx","lastIndex","a","charCodeAt","eval","_getBasePath","src","els","document","getElementsByTagName","substring","lastIndexOf","_bindEvent","el","addEventListener","_useCapture","attachEvent","_unbindEvent","removeEventListener","detachEvent","KEvent","event","init","_getId","_eventExpendo","_setId","_eventId","_removeId","e","removeAttribute","_bind","id","_eventData","events","kevent","push","_unbind","splice","count","_fire","_ctrl","ctrlKey","which","shiftKey","altKey","stop","_ready","readyFunc","loaded","KindEditor","_readyFinished","ieReadyFunc","documentElement","doScroll","setTimeout","ieReadyStateFunc","readyState","toplevel","frameElement","_getCssList","css","list","reg","toLowerCase","_getAttrList","tag","_addClassToTag","className","_formatCss","_formatUrl","mode","host","pathname","getRealPath","path","parts","paths","part","pop","join","getRelativePath","depth","prefix","location","protocol","m","_formatHtml","html","htmlTags","urlType","wellFormatted","indentChar","fontSizeList","htmlTagMap","script","style","re","tagStack","$4","$5","$6","full","startNewline","startSlash","tagName","attr","endSlash","endNewline","_SINGLE_TAG_MAP","_INLINE_TAG_MAP","_PRE_TAG_MAP","_BLOCK_TAG_MAP","attrMap","fontStyleMap","fontStyle","color","_FILL_ATTR_MAP","styleMap","k","v","_clearMsWord","_mediaType","_mediaClass","_mediaAttrs","srcTag","unescape","_mediaEmbed","_mediaImg","blankPath","width","height","escape","_tmpl","Function","_contains","nodeA","nodeB","nodeType","parentNode","_getAttr","_GET_SET_ATTRIBUTE","nodeName","getAttribute","div","ownerDocument","createElement","appendChild","cloneNode","innerHTML","_queryAll","expr","root","stripslashes","cmpTag","tagA","tagB","byId","doc","getElementById","byClass","getElementsByClassName","querySelectorAll","cls","byName","getElementsByName","byAttr","select","matches","exprList","mergedResults","results","subResults","j","l","isChild","lenth","_query","_get","K","_getDoc","node","_getWin","parentWindow","defaultView","_setHtml","temp","removeChild","empty","each","_hasClass","_setAttr","_IE","_V","setAttribute","_removeAttr","_getNodeName","_computedCss","win","camelKey","getComputedStyle","getPropertyValue","currentStyle","_hasVal","_VALUE_TAG_MAP","_docElement","_QUIRKS","body","_docHeight","Math","max","scrollHeight","clientHeight","_docWidth","scrollWidth","clientWidth","_getScrollPos","x","y","_NEWIE","_OPERA","scrollLeft","scrollTop","scrollX","scrollY","KNode","_updateCollapsed","range","collapsed","startContainer","endContainer","startOffset","endOffset","_copyAndDelete","isCopy","isDelete","splitTextNode","centerNode","nodeValue","splitText","center","setStart","right","setEnd","nodeList","extractNodes","frag","nextNode","firstChild","testRange","KRange","selectNode","start","compareBoundaryPoints","_START_TO_END","incStart","_START_TO_START","incEnd","_END_TO_END","end","_END_TO_START","nextSibling","childFlag","textNode","copyRange","cloneRange","down","ancestor","commonAncestor","createDocumentFragment","up","collapse","_moveToElementText","knode","moveToElementText","_getStartEnd","rng","isStart","parentElement","pointRange","duplicate","nodes","childNodes","index","startNode","startPos","cmp","compareEndPoints","dummy","nodeRange","newNode","isControl","after","setEndPoint","remove","moveStart","lastChild","prevNode","previousSibling","_getEndRange","createTextRange","children","kchild","before","_toRange","tr2td","cells","_IERANGE","_range","mixed","_nativeCommand","execCommand","_nativeCommandValue","queryCommandValue","_getSel","selection","getSelection","_getRng","sel","rangeCount","getRangeAt","createRange","_singleKeyMap","newMap","_hasAttrOrCss","_hasAttrOrCssByKey","mapKey","method","_removeAttrOrCss","_removeAttrOrCssByKey","allFlag","removeAttr","_getInnerNode","inner","first","_isEmptyNode","isSingle","_mergeWrapper","b","clone","lastA","childA","merged","_mergeAttrs","append","_wrapNode","wrapper","replaceWith","nodeWrapper","next","styles","_inPreElement","hasClass","KCmd","_cmd","selectNodeContents","_drag","options","moveEl","moveFn","clickEl","beforeDrag","iframeFix","docs","_iframeDoc","pos","mousedown","moveListener","preventDefault","kdoc","target","diffX","_round","pageX","diffY","pageY","selectListener","upListener","unbind","self","releaseCapture","stopPropagation","get","mousemove","mouseup","bind","setCapture","KWidget","_widget","iframe","contentDocument","contentWindow","_getInitHtml","themesPath","bodyClass","cssPath","cssData","_direction","_elementVal","hasVal","KEdit","_edit","_selectToolbar","KToolbar","_toolbar","KMenu","_menu","KColorPicker","_colorpicker","KUploadButton","_uploadbutton","_createButton","arg","btn","KDialog","_dialog","_tabs","afterSelect","liList","addClass","ul","add","tab","li","title","selectedIndex","panel","show","removeClass","mouseover","mouseout","hide","_loadScript","head","charset","onload","onreadystatechange","_chopQuery","_loadStyle","link","absoluteUrl","links","href","rel","_ajax","dataType","xhr","XMLHttpRequest","ActiveXObject","open","status","responseText","encodeURIComponent","setRequestHeader","send","_plugin","_plugins","_parseLangKey","ns","_lang","langType","_language","_getImageFromRange","sc","so","_WEBKIT","img","_bindContextmenuEvent","edit","contextmenu","menu","hideMenu","useContextmenu","_contextmenus","maxWidth","items","cond","shift","prevItem","clientX","clientY","visibility","shadowMode","addItem","docEl","menuHeight","_bindNewlineEvent","getAncestorTagName","isStyle","newlineTag","_GECKO","brSkipTagMap","pSkipTagMap","keydown","cmd","insertHtml","keyup","p","_bindTabEvent","afterTab","shrink","insertNode","_bindFocusEvent","textarea","focus","afterFocus","blur","afterBlur","_removeBookmarkTag","_removeTempTag","_addBookmarkToStack","stack","bookmark","prev","_undoToRedo","fromStack","toStack","designMode","createBookmark","moveToBookmark","KEditor","setOption","se","srcElement","minWidth","minHeight","_MOBILE","_IOS","initContent","plugin","isCreated","_handlers","_undoStack","_redoStack","_firstAddBookmark","dialogs","_editor","_create","create","editor","basePath","langPath","pluginsPath","loadStyleMode","themeType","_instances","DEBUG","_TIME","_VERSION","_eachEditor","_ua","navigator","userAgent","compatMode","_matches","Date","getTime","round","VERSION","IE","GECKO","WEBKIT","OPERA","V","TIME","isArray","isFunction","inArray","inString","trim","addUnit","removeUnit","toCamel","toHex","toMap","toArray","undef","invalidUrl","addParam","extend","json","_STYLE_TAG_MAP","_CONTROL_TAG_MAP","_NOSPLIT_TAG_MAP","_AUTOCLOSE_TAG_MAP","fullscreenMode","filterMode","wellFormatMode","resizeType","syncType","pasteType","dialogAlignType","fullscreenShortcut","minChangeSize","zIndex","noDisableItems","colorTable","fontSizeTable","font","table","td,th","embed","p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pre","hr","br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del","layout","_INPUT_KEY_MAP","_CURSORMOVE_KEY_MAP","_CHANGE_KEY_MAP","_EVENT_PROPS","relatedTarget","fromElement","toElement","clientLeft","clientTop","charCode","keyCode","metaKey","button","ev","returnValue","cancelBubble","ctrl","ready","formatUrl","formatHtml","getCssList","getAttrList","mediaType","mediaAttrs","mediaEmbed","mediaImg","clearMsWord","tmpl","_getSetAttrDiv","queryAll","fire","hasAttr","outer","eq","RegExp","innerText","textContent","offsetWidth","offsetHeight","opacity","filter","getBoundingClientRect","box","left","top","offsetLeft","offsetTop","offsetParent","bool","appendTo","insertBefore","replaceChild","keepChilds","_originDisplay","display","isInline","isBlock","contains","otherNode","last","sibling","scan","order","walk","n","_K","arguments","NodeClass","_BOOKMARK_ID","getParents","parents","parentA","parentB","parentsA","parentsB","lenA","lenB","setStartBefore","setStartAfter","setEndBefore","setEndAfter","toStart","how","rangeA","rangeB","nodeC","posA","posB","diff","cloneContents","deleteContents","extractContents","c","ec","eo","nodeCount","surroundContents","hasControlRange","createControlRange","addElement","downPos","upPos","enlarge","toBlock","enlargePos","serialize","endNode","dump","RangeClass","START_TO_START","START_TO_END","END_TO_END","END_TO_START","forceReset","hasDummy","hasU200b","ex","createTextNode","removeAllRanges","addRange","scrollTo","wrap","copyWrapper","tempRange","needSplit","dummyParent","ksc","kscp","sb","sa","startBefore","startDummy","endDummy","cmpStart","startAfter","endAfter","commonNode","find","cNode","state","queryCommandState","lc","h1,h2,h3,h4,h5,h6,p,div,pre,address","*","toggle","bold","strong","italic","em","underline","u","strikethrough","forecolor","hilitecolor","fontsize","fontname","fontfamily","removeformat","inserthtml","quickMode","outerHTML","pasteHTML","newRange","print","insertimage","border","align","createlink","setAttr","unlink","queryCommandSupported","CmdClass","z","_alignEl","alignEl","position","z-index","autoPos","autoScroll","scrollPos","updateProp","w","h","draggable","WidgetClass","widget","dir","isDocumentDomain","domain","write","afterChange","_mousedownHandler","contentEditable","afterCreate","beforeGetHtml","beforeSetHtml","afterSetHtml","srcScript","iframeSrc","tabIndex","isNaN","setWidth","setHeight","isFull","design","input","timeoutHandler","EditClass","iframeDoc","hover","disableMode","noDisableItemMap","_itemMap","unselect","enable","disable","disableAll","ToolbarClass","toolbar","centerLineMode","itemDiv","leftDiv","rightDiv","iconClass","centerDiv","checked","beforeRemove","MenuClass","colors","selectedColor","_cells","cellPadding","cellSpacing","row","insertRow","cell","insertCell","colSpan","_addAttr","noColor","ColorPickerClass","colorpicker","fieldName","extraParams","afterError","hiddenElements","form","fileBox","submit","tempForm","reset","afterUpload","UploadButtonClass","uploadbutton","previewBtn","yesBtn","noBtn","closeBtn","showMask","contentDiv","iframeMask","headerDiv","closeIcon","bodyDiv","footerDiv","mask","docWidth","docHeight","isLoading","setMaskIndex","showLoading","msg","loading","hideLoading","DialogClass","dialog","tabs","loadScript","loadStyle","ajax","lang","loadPlugin","handler","clickToolbar","updateState","addContextmenu","initResize","statusbar","resize","overflow","container","toolbarDiv","editDiv","_scrollPos","_fullscreenExecuted","htmlList","menuName","editHeight","_docMousedownFn","addBookmark","readonlyMode","readonly","_fullscreenResizeHandler","hideDialog","fullHtml","isEmpty","isDirty","selectedHtml","changeFlag","apply","appendHtml","sync","checkSize","abs","undo","redo","fullscreen","isReadonly","createMenu","hideContextmenu","createDialog","firstDialog","parentDialog","errorDialog","EditorClass","instances","shortcutKeys","selectall","hasForm","resetBtn","blocks","heights","h1","h2","h3","H4","curVal","getSelectedLink","getSelectedImage","getSelectedFlash","getSelectedMedia","getSelectedAnchor","uName","getSelectedTable","getSelectedRow","getSelectedCell","movePastedData","pasting","white-space","imgAttrs","code","source","preview","cut","copy","paste","plainpaste","wordpaste","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","formatblock","image","multiimage","flash","media","tablecell","emoticons","about","filemanager","baidumap","lineheight","clearhtml","pagebreak","quickformat","insertfile","template","anchor","yes","no","editImage","deleteImage","editFlash","deleteFlash","editMedia","deleteMedia","editLink","deleteLink","editAnchor","deleteAnchor","tableprop","tablecellprop","tableinsert","tabledelete","tablecolinsertleft","tablecolinsertright","tablerowinsertabove","tablerowinsertbelow","tablerowmerge","tablecolmerge","tablerowsplit","tablecolsplit","tablecoldelete","tablerowdelete","pleaseSelectFile","invalidImg","invalidMedia","invalidWidth","invalidHeight","invalidBorder","invalidRows","invalidCols","invalidPadding","invalidSpacing","invalidJson","uploadSuccess","cutError","copyError","pasteError","ajaxLoading","uploadLoading","uploadError","plainpaste.comment","wordpaste.comment","code.pleaseInput","link.url","link.linkType","link.newWindow","link.selfWindow","flash.url","flash.width","flash.height","flash.upload","flash.viewServer","media.url","media.width","media.height","media.autostart","media.upload","media.viewServer","image.remoteImage","image.localImage","image.remoteUrl","image.localUrl","image.size","image.width","image.height","image.resetSize","image.align","image.defaultAlign","image.leftAlign","image.rightAlign","image.imgTitle","image.upload","image.viewServer","multiimage.uploadDesc","multiimage.startUpload","multiimage.clearAll","multiimage.insertAll","multiimage.queueLimitExceeded","multiimage.fileExceedsSizeLimit","multiimage.zeroByteFile","multiimage.invalidFiletype","multiimage.unknownError","multiimage.pending","multiimage.uploadError","filemanager.emptyFolder","filemanager.moveup","filemanager.viewType","filemanager.viewImage","filemanager.listImage","filemanager.orderType","filemanager.fileName","filemanager.fileSize","filemanager.fileType","insertfile.url","insertfile.title","insertfile.upload","insertfile.viewServer","table.cells","table.rows","table.cols","table.size","table.width","table.height","table.percent","table.px","table.space","table.padding","table.spacing","table.align","table.textAlign","table.verticalAlign","table.alignDefault","table.alignLeft","table.alignCenter","table.alignRight","table.alignTop","table.alignMiddle","table.alignBottom","table.alignBaseline","table.border","table.borderWidth","table.borderColor","table.backgroundColor","map.address","map.search","baidumap.address","baidumap.search","baidumap.insertDynamicMap","anchor.name","formatblock.formatBlock","h4","fontname.fontName","SimSun","NSimSun","FangSong_GB2312","KaiTi_GB2312","SimHei","Microsoft YaHei","Arial","Arial Black","Times New Roman","Courier New","Tahoma","Verdana","lineheight.lineHeight","1","1.5","2","2.5","3","template.selectTemplate","template.replaceContent","template.fileList","1.html","2.html","3.html","nameBox","delete","hideScroll","scroll","overflowY","resetHeight","autoHeightMode","mapWidth","mapHeight","address","search","insertDynamicMap","centerObj","getCenter","lng","lat","zoom","getZoom","checkbox","searchBtn","addressBox","geocoder","maptype","getMapTypeId","div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pleaseInput","emoticonsPath","allowPreview","allowPreviewEmoticons","currentPageNum","bindCellEvent","num","previewDiv","colsHalf","previewImg","createEmoticonsTable","pageNum","parentDiv","elements","startNum","rows","cols","removeEvent","bindPageEvent","pageDiv","wrapperDiv","createPageTable","pages","ceil","floor","makeFileTitle","filename","filesize","datetime","bindTitle","is_dir","fileManagerJson","imgPath","filemanagerDialog","reloadPage","func","dirName","bindEvent","result","createFunc","fileUrl","current_url","dirPath","current_dir_path","orderTypeBox","is_photo","clickFn","elList","createCommon","changeFunc","viewTypeBox","createView","createList","moveupLink","moveup_dir_path","change","fileList","file_list","iconUrl","cell0","has_file","emptyFolder","photoDiv","viewType","moveup","viewImage","listImage","orderType","fileName","fileSize","fileType","allowFlashUpload","allowFileManager","formatUploadUrl","extraFileUploadParams","filePostName","uploadJson","upload","viewServer","urlBox","widthBox","heightBox","quality","viewServerBtn","afterSelectFile","allowImageUpload","allowImageRemote","imageTabIndex","fillDescAfterUploadImage","imageDialog","setSize","originalWidth","originalHeight","showRemote","imageUrl","imageWidth","imageHeight","imageTitle","imageAlign","showLocal","remoteUrl","size","resetSize","imgTitle","localUrl","dialogWidth","dialogHeight","localUrlBox","titleBox","alignBox","refreshBtn","remoteImage","localImage","tempImg","allowFileUpload","fileDialog","fileTitle","lineHeight","linkType","typeBox","Option","newWindow","selfWindow","allowMediaUpload","autostart","autostartBox","loop","KSWFUpload","showError","progressbars","uploadDesc","startButtonValue","settings","debug","upload_url","uploadUrl","flash_url","flashUrl","file_post_name","button_placeholder","button_image_url","buttonImageUrl","button_width","buttonWidth","button_height","buttonHeight","button_cursor","SWFUpload","CURSOR","HAND","file_types","fileTypes","file_types_description","fileTypesDesc","file_upload_limit","fileUploadLimit","file_size_limit","fileSizeLimit","post_params","postParams","file_queued_handler","file","fileIconUrl","appendFile","file_queue_error_handler","errorCode","errorName","QUEUE_ERROR","QUEUE_LIMIT_EXCEEDED","queueLimitExceeded","FILE_EXCEEDS_SIZE_LIMIT","fileExceedsSizeLimit","ZERO_BYTE_FILE","zeroByteFile","INVALID_FILETYPE","invalidFiletype","unknownError","upload_start_handler","upload_progress_handler","bytesLoaded","bytesTotal","percent","progressbar","bar","upload_error_handler","filestatus","FILE_STATUS","ERROR","errorMessage","upload_success_handler","serverData","swfu","startUpload","getUrlList","COMPLETE","removeFile","fileId","cancelUpload","removeFiles","statusDiv","pendingMessage","destroy","swfupload","element","imageSizeLimit","imageUploadLimit","imageFileTypes","multiImageDialog","uploadLimit","sizeLimit","insertAll","clearAll","pending","urlList","initSWFUpload","customSettings","eventQueue","movieName","movieCount","movieElement","initSettings","loadFlash","displayDebugInfo","version","UPLOAD_ERROR","HTTP_ERROR","MISSING_UPLOAD_URL","IO_ERROR","SECURITY_ERROR","UPLOAD_LIMIT_EXCEEDED","UPLOAD_FAILED","SPECIFIED_FILE_ID_NOT_FOUND","FILE_VALIDATION_FAILED","FILE_CANCELLED","UPLOAD_STOPPED","QUEUED","IN_PROGRESS","CANCELLED","BUTTON_ACTION","SELECT_FILE","SELECT_FILES","START_UPLOAD","ARROW","WINDOW_MODE","WINDOW","TRANSPARENT","OPAQUE","completeURL","indexSlash","hostname","port","ensureDefault","settingName","defaultValue","debug_enabled","return_upload_start_handler","returnUploadStart","debugMessage","custom_settings","prevent_swf_caching","preserve_relative_urls","targetElement","tempParent","button_placeholder_id","getFlashHTML","getMovieElement","classid","button_window_mode","getFlashVars","paramString","buildParamString","httpSuccessString","http_success","use_query_string","requeue_on_error","assume_success_timeout","file_queue_limit","button_text","button_text_top_padding","button_text_left_padding","button_text_style","button_action","button_disabled","paramStringPairs","ex1","ex2","swfupload_loaded_handler","file_dialog_start_handler","upload_complete_handler","debug_handler","addSetting","default_value","getSetting","callFlash","functionName","argumentArray","returnString","CallFunction","__flash__argumentsToXML","post","unescapeFilePostParams","selectFile","selectFiles","fileID","triggerErrorEvent","stopUpload","getStats","setStats","statsObject","getFile","addFileParam","removeFileParam","setUploadURL","setPostParams","paramsObject","addPostParam","removePostParam","setFileTypes","types","description","setFileSizeLimit","setFileUploadLimit","setFileQueueLimit","fileQueueLimit","setFilePostName","setUseQueryString","useQueryString","setRequeueOnError","requeueOnError","setHTTPSuccess","http_status_codes","setAssumeSuccessTimeout","timeout_seconds","setDebugEnabled","debugEnabled","setButtonImageURL","buttonImageURL","setButtonDimensions","movie","setButtonText","setButtonTextPadding","setButtonTextStyle","setButtonDisabled","isDisabled","setButtonAction","buttonAction","setButtonCursor","cursor","queueEvent","handlerName","executeNextEvent","f","uk","unescapedPost","String","fromCharCode","testExternalInterface","flashReady","cleanUp","instance","flashEx","fileDialogStart","fileQueued","fileQueueError","fileDialogComplete","numFilesSelected","numFilesQueued","numFilesInQueue","uploadStart","uploadProgress","bytesComplete","responseReceived","uploadComplete","exceptionMessage","exceptionValues","Console","writeLine","documentForm","fontFamily","margin","queue","oldInitSettings","queueSettings","queue_cancelled_flag","queue_upload_count","user_upload_complete_handler","user_upload_start_handler","uploadCompleteHandler","uploadStartHandler","queue_complete_handler","cancelQueue","stats","files_queued","pagebreakHtml","tail","comment","getFirstChild","blockMap","subList","_setColor","_initColorPicker","dialogDiv","colorBox","removePicker","pickerList","picker","_getCellIndex","rowSpanCount","rowSpan","cellIndex","isInsert","px","space","padding","spacing","alignDefault","alignLeft","alignCenter","alignRight","borderWidth","borderColor","backgroundColor","rowsBox","colsBox","widthType","widthTypeBox","heightType","heightTypeBox","paddingBox","spacingBox","borderBox","bgColor","tableWidth","tableHeight","cellprop","textAlign","verticalAlign","alignTop","alignMiddle","alignBottom","alignBaseline","textAlignBox","verticalAlignBox","background-color","text-align","vertical-align","border-width","border-style","border-color","cellWidth","cellHeight","insert","colinsert","newRow","newCell","colinsertleft","colinsertright","rowinsert","rowIndex","rowinsertabove","rowinsertbelow","rowmerge","nextRowIndex","nextRow","nextCell","deleteCell","colmerge","nextCellIndex","rowsplit","colsplit","coldelete","rowdelete","deleteRow","getFilePath","htmlPath","selectTemplate","replaceContent","selectBox","74Su","content","locals","Ser4","injectStyle","ssrContext","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue___default","__WEBPACK_IMPORT_KEY__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_1cd48d98_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_examineModify_vue__","normalizeComponent","__vue_styles__","Component","Txsa","iFdl"],"mappings":"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","file":"resources/ffitm-trainee-Examine/static/js/3.2543d880.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ \"+CSO\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-ctn\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"main-content clearfix\"},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"250px\",\"rules\":_vm.rules,\"model\":_vm.editDetail}},[_c('el-form-item',{attrs:{\"label\":\"考核人\",\"prop\":\"staffname\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"name\":\"createStaffId\",\"disabled\":true},model:{value:(_vm.editDetail.staffname),callback:function ($$v) {_vm.editDetail.staffname=$$v},expression:\"editDetail.staffname\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核分数\",\"prop\":\"grade\"}},[_c('el-input',{attrs:{\"placeholder\":\"考核分数\",\"name\":\"grade\"},model:{value:(_vm.editDetail.grade),callback:function ($$v) {_vm.editDetail.grade=_vm._n($$v)},expression:\"editDetail.grade\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"staffGroupType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.editDetail.staffGroupType),callback:function ($$v) {_vm.editDetail.staffGroupType=$$v},expression:\"editDetail.staffGroupType\"}},_vm._l((_vm.staffGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核时间\",\"prop\":\"visitCreateDate\"}},[[_c('el-date-picker',{attrs:{\"type\":\"date\",\"placeholder\":\"选择考核日期\",\"value-format\":\"yyyy-MM-dd\"},model:{value:(_vm.editDetail.visitCreateDate),callback:function ($$v) {_vm.editDetail.visitCreateDate=$$v},expression:\"editDetail.visitCreateDate\"}})]],2),_vm._v(\" \"),_c('el-form-item',{staticClass:\"collect\",attrs:{\"label\":\"新人考核评价\",\"prop\":\"collectRemark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.editDetail.collectRemark),callback:function ($$v) {_vm.editDetail.collectRemark=$$v},expression:\"editDetail.collectRemark\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"weekly-footer\",slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.update(_vm.editDetail,'formName')}}},[_vm._v(\"更新\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cancel()}}},[_vm._v(\"取消\")])],1)],1)])])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n\n/***/ \"/HRr\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _defineProperty2 = __webpack_require__(\"Xos8\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _service = __webpack_require__(\"CxL4\");\n\nvar _service2 = _interopRequireDefault(_service);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(\"4uE9\"); //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n__webpack_require__(\"iFdl\");\nexports.default = {\n  data: function data() {\n    var _ref;\n\n    return _ref = {\n      rules: {\n        grade: [{\n          required: true,\n          message: \"请输入考核分数\",\n          trigger: \"blur\"\n        }],\n        staffGroupType: [{\n          required: true,\n          message: \"请选择归属组\",\n          trigger: \"blur\"\n        }],\n        visitCreateDate: [{\n          required: true,\n          message: \"请选择考核时间\",\n          trigger: \"blur\"\n        }],\n        collectRemark: [{\n          required: true,\n          message: \"请输入考核评价\",\n          trigger: \"blur\"\n        }]\n      },\n      labelPosition: \"right\",\n      editDetail: {\n        staffGroupType: \"\"\n      },\n      Contents: \"\",\n      Contentss: \"\",\n      Contentsss: \"\",\n      subjectName: \"\",\n      staffname: \"\",\n      staffID: \"\"\n    }, (0, _defineProperty3.default)(_ref, \"editDetail\", {}), (0, _defineProperty3.default)(_ref, \"weeklyType\", []), (0, _defineProperty3.default)(_ref, \"staffGroupType\", []), (0, _defineProperty3.default)(_ref, \"subjectClass\", []), (0, _defineProperty3.default)(_ref, \"staffType\", []), (0, _defineProperty3.default)(_ref, \"weeklyDetail\", {}), _ref;\n  },\n  mounted: function mounted() {\n    this.getAauthor();\n    this.getselect();\n  },\n  methods: {\n    getselect: function getselect() {\n      var _this = this;\n\n      _service2.default.getListGroupType().then(function (res) {\n        _this.staffGroupType = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    getAauthor: function getAauthor() {\n      var _this2 = this;\n\n      _service2.default.getListSxByGType().then(function (res) {\n        console.log(res);\n        _this2.Aauthor = res.data[4];\n        console.log(_this2.Aauthor);\n        _this2.staffname = _this2.Aauthor.staffname;\n        _this2.staffID = _this2.Aauthor.staffId;\n        console.log(_this2.staffname);\n        _this2.editDetail = {\n          checkId: _this2.$route.query.checkId,\n          checkStaffId: _this2.$route.query.checkStaffId,\n          visitCreateDate: _this2.$route.query.visitCreateDate,\n          grade: _this2.$route.query.grade,\n          staffGroupType: _this2.$route.query.staffGroupType,\n          staffId: _this2.$route.query.staffId,\n          collectRemark: _this2.$route.query.collectRemark,\n          staffname: _this2.staffname\n        };\n        console.log(_this2.editDetail);\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n\n    //取消\n    cancel: function cancel() {\n      window.close();\n    },\n\n    //修改\n    update: function update(editDetail, formName) {\n      var _this3 = this;\n\n      this.$refs[\"formName\"].validate(function (valid) {\n        if (valid) {\n          _this3.editDetail = {\n            checkId: _this3.$route.query.checkId,\n            checkStaffId: _this3.$route.query.checkStaffId,\n            visitCreateDate: _this3.editDetail.visitCreateDate,\n            grade: _this3.editDetail.grade,\n            staffGroupType: _this3.editDetail.staffGroupType,\n            staffId: _this3.$route.query.staffId,\n            collectRemark: _this3.editDetail.collectRemark\n          };\n          console.log(_this3.editDetail);\n          var params = {\n            csc: _this3.editDetail\n          };\n          console.log(params);\n          _service2.default.updateOneStaffComment(params).then(function (response) {\n            alert(\"修改成功\");\n            window.close();\n          }).catch(function (error) {\n            console.log(error);\n          });\n        } else {\n          return false;\n        }\n      });\n    }\n  }\n};\n\n/***/ }),\n\n/***/ \"4uE9\":\n/***/ (function(module, exports) {\n\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n/***/ }),\n\n/***/ \"74Su\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"Txsa\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"X/Wc\")(\"613066de\", content, true, {});\n\n/***/ }),\n\n/***/ \"Ser4\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue__ = __webpack_require__(\"/HRr\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue__);\n/* harmony namespace reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue__[key]; }) }(__WEBPACK_IMPORT_KEY__));\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_1cd48d98_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_examineModify_vue__ = __webpack_require__(\"+CSO\");\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"74Su\")\n}\nvar normalizeComponent = __webpack_require__(\"/4AN\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1cd48d98\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_examineModify_vue___default.a,\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_1cd48d98_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_examineModify_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"Txsa\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"lcwS\")(false);\n// imports\n\n\n// module\nexports.push([module.i, \".main-ctn[data-v-1cd48d98]{background:#f8f8f8}.bg-purple[data-v-1cd48d98]{background:#fff;border-radius:8px}.main-content[data-v-1cd48d98]{padding-top:30px}.el-form-item[data-v-1cd48d98]{margin-top:5px}.main-content .dialog-footer[data-v-1cd48d98]{margin:0 auto}.weekly-footer[data-v-1cd48d98]{float:left;margin-left:40%!important;margin-bottom:20px!important}.knowledge-content-editor[data-v-1cd48d98]{width:110%}.updateweekly[data-v-1cd48d98]{margin-top:5px;float:left;font-weight:400;color:#66666f}.selfile[data-v-1cd48d98]{margin-left:10px!important}.upload-demo[data-v-1cd48d98]{margin-left:58px;width:80%;padding-bottom:20px}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"iFdl\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// resources/ffitm-trainee-Examine/static/js/3.2543d880.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-ctn\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"main-content clearfix\"},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"250px\",\"rules\":_vm.rules,\"model\":_vm.editDetail}},[_c('el-form-item',{attrs:{\"label\":\"考核人\",\"prop\":\"staffname\"}},[_c('el-input',{attrs:{\"placeholder\":\"\",\"name\":\"createStaffId\",\"disabled\":true},model:{value:(_vm.editDetail.staffname),callback:function ($$v) {_vm.editDetail.staffname=$$v},expression:\"editDetail.staffname\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核分数\",\"prop\":\"grade\"}},[_c('el-input',{attrs:{\"placeholder\":\"考核分数\",\"name\":\"grade\"},model:{value:(_vm.editDetail.grade),callback:function ($$v) {_vm.editDetail.grade=_vm._n($$v)},expression:\"editDetail.grade\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"staffGroupType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.editDetail.staffGroupType),callback:function ($$v) {_vm.editDetail.staffGroupType=$$v},expression:\"editDetail.staffGroupType\"}},_vm._l((_vm.staffGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"考核时间\",\"prop\":\"visitCreateDate\"}},[[_c('el-date-picker',{attrs:{\"type\":\"date\",\"placeholder\":\"选择考核日期\",\"value-format\":\"yyyy-MM-dd\"},model:{value:(_vm.editDetail.visitCreateDate),callback:function ($$v) {_vm.editDetail.visitCreateDate=$$v},expression:\"editDetail.visitCreateDate\"}})]],2),_vm._v(\" \"),_c('el-form-item',{staticClass:\"collect\",attrs:{\"label\":\"新人考核评价\",\"prop\":\"collectRemark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.editDetail.collectRemark),callback:function ($$v) {_vm.editDetail.collectRemark=$$v},expression:\"editDetail.collectRemark\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"weekly-footer\",slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.update(_vm.editDetail,'formName')}}},[_vm._v(\"更新\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cancel()}}},[_vm._v(\"取消\")])],1)],1)])])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1cd48d98\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!../node_modules/vue-loader/lib/selector.js?type=template&index=0!./traineeExamineSys/views/examineModify.vue\n// module id = +CSO\n// module chunks = 3","<template>\r\n  <div class=\"main-ctn\">\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <div class=\"grid-content bg-purple\">\r\n          <div class=\"main-content clearfix\">\r\n            <el-form :label-position=\"labelPosition\" :inline=\"true\" label-width=\"250px\" :rules=\"rules\" :model=\"editDetail\" ref=\"formName\">\r\n              <el-form-item label=\"考核人\"  prop=\"staffname\">\r\n                <el-input v-model=\"editDetail.staffname\" placeholder=\"\" name=\"createStaffId\" :disabled=\"true\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"考核分数\"  prop=\"grade\">\r\n                <el-input v-model.number=\"editDetail.grade\" placeholder=\"考核分数\" name=\"grade\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"归属组\" prop=\"staffGroupType\">\r\n              <template>\r\n                <el-select v-model=\"editDetail.staffGroupType\" placeholder=\"请选择您的归属组\"  >\r\n                   <el-option v-for=\"item in staffGroupType\" :key=\"item.typeId\" :label=\"item.typeValue\"  :value=\"item.typeId\"></el-option>\r\n                </el-select>\r\n              </template>\r\n              </el-form-item>\r\n              <el-form-item label=\"考核时间\" prop=\"visitCreateDate\" >\r\n               <template>\r\n                 <el-date-picker  v-model=\"editDetail.visitCreateDate\" type=\"date\"  placeholder=\"选择考核日期\" value-format=\"yyyy-MM-dd\">\r\n                 </el-date-picker>\r\n               </template>\r\n              </el-form-item>               \r\n              <el-form-item label=\"新人考核评价\" prop=\"collectRemark\"  class=\"collect\">\r\n                <el-input type=\"textarea\" v-model=\"editDetail.collectRemark\"></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"weekly-footer\">\r\n              <el-button @click=\"update(editDetail,'formName')\" >更新</el-button>\r\n              <el-button type=\"primary\" @click=\"cancel()\">取消</el-button>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport service from \"../scripts/service.js\";\r\nrequire(\"kindeditor\");\r\nrequire(\"kindeditor/themes/default/default.css\");\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      rules: {\r\n        grade: [\r\n          {\r\n            required: true,\r\n            message: \"请输入考核分数\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        staffGroupType: [\r\n          {\r\n            required: true,\r\n            message: \"请选择归属组\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        visitCreateDate: [\r\n          {\r\n            required: true,\r\n            message: \"请选择考核时间\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        collectRemark: [\r\n          {\r\n            required: true,\r\n            message: \"请输入考核评价\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      },\r\n      labelPosition: \"right\",\r\n      editDetail: {\r\n        staffGroupType: \"\"\r\n      },\r\n      Contents: \"\",\r\n      Contentss: \"\",\r\n      Contentsss: \"\",\r\n      subjectName: \"\",\r\n      staffname: \"\",\r\n      staffID: \"\",\r\n      editDetail: {},\r\n      weeklyType: [],\r\n      staffGroupType: [],\r\n      subjectClass: [],\r\n      staffType: [],\r\n      weeklyDetail: {}\r\n    };\r\n  },\r\n  mounted: function() {\r\n    this.getAauthor();\r\n    this.getselect();\r\n  },\r\n  methods: {\r\n    getselect() {\r\n      service\r\n        .getListGroupType()\r\n        .then(res => {\r\n          this.staffGroupType = res.data;\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    getAauthor() {\r\n      service\r\n        .getListSxByGType()\r\n        .then(res => {\r\n          console.log(res);\r\n          this.Aauthor = res.data[4];\r\n          console.log(this.Aauthor);\r\n          this.staffname = this.Aauthor.staffname;\r\n          this.staffID = this.Aauthor.staffId;\r\n          console.log(this.staffname);\r\n          this.editDetail = {\r\n            checkId: this.$route.query.checkId,\r\n            checkStaffId: this.$route.query.checkStaffId,\r\n            visitCreateDate: this.$route.query.visitCreateDate,\r\n            grade: this.$route.query.grade,\r\n            staffGroupType: this.$route.query.staffGroupType,\r\n            staffId: this.$route.query.staffId,\r\n            collectRemark: this.$route.query.collectRemark,\r\n            staffname: this.staffname\r\n          };\r\n          console.log(this.editDetail);\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    //取消\r\n    cancel() {\r\n      window.close();\r\n    },\r\n    //修改\r\n    update(editDetail, formName) {\r\n      this.$refs[\"formName\"].validate(valid => {\r\n        if (valid) {\r\n          this.editDetail = {\r\n            checkId: this.$route.query.checkId,\r\n            checkStaffId: this.$route.query.checkStaffId,\r\n            visitCreateDate: this.editDetail.visitCreateDate,\r\n            grade: this.editDetail.grade,\r\n            staffGroupType: this.editDetail.staffGroupType,\r\n            staffId: this.$route.query.staffId,\r\n            collectRemark: this.editDetail.collectRemark\r\n          };\r\n          console.log(this.editDetail);\r\n          let params = {\r\n            csc: this.editDetail\r\n          };\r\n          console.log(params);\r\n          service\r\n            .updateOneStaffComment(params)\r\n            .then(response => {\r\n              alert(\"修改成功\");\r\n              window.close();\r\n            })\r\n            .catch(error => {\r\n              console.log(error);\r\n            });\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.main-ctn {\r\n  background: #f8f8f8;\r\n}\r\n.bg-purple {\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n}\r\n.main-content {\r\n  padding-top: 30px;\r\n}\r\n.el-form-item {\r\n  margin-top: 5px;\r\n}\r\n.main-content .dialog-footer {\r\n  margin: 0 auto;\r\n}\r\n.weekly-footer {\r\n  float: left;\r\n  margin-left: 40% !important;\r\n  margin-bottom: 20px !important;\r\n}\r\n.knowledge-content-editor {\r\n  width: 110%;\r\n}\r\n.updateweekly {\r\n  margin-top: 5px;\r\n  float: left;\r\n  font-weight: 400;\r\n  color: #66666f;\r\n}\r\n.selfile {\r\n  margin-left: 10px !important;\r\n}\r\n.upload-demo {\r\n  margin-left: 58px;\r\n  width: 80%;\r\n  padding-bottom: 20px;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// traineeExamineSys/views/examineModify.vue","/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/kindeditor/kindeditor-all.js\n// module id = 4uE9\n// module chunks = 0 1 2 3 4","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1cd48d98\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./examineModify.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"613066de\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-style-loader!../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-1cd48d98\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/examineModify.vue\n// module id = 74Su\n// module chunks = 3","function injectStyle (ssrContext) {\n  require(\"!!vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1cd48d98\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./examineModify.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./examineModify.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./examineModify.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1cd48d98\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./examineModify.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1cd48d98\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./traineeExamineSys/views/examineModify.vue\n// module id = Ser4\n// module chunks = 3","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".main-ctn[data-v-1cd48d98]{background:#f8f8f8}.bg-purple[data-v-1cd48d98]{background:#fff;border-radius:8px}.main-content[data-v-1cd48d98]{padding-top:30px}.el-form-item[data-v-1cd48d98]{margin-top:5px}.main-content .dialog-footer[data-v-1cd48d98]{margin:0 auto}.weekly-footer[data-v-1cd48d98]{float:left;margin-left:40%!important;margin-bottom:20px!important}.knowledge-content-editor[data-v-1cd48d98]{width:110%}.updateweekly[data-v-1cd48d98]{margin-top:5px;float:left;font-weight:400;color:#66666f}.selfile[data-v-1cd48d98]{margin-left:10px!important}.upload-demo[data-v-1cd48d98]{margin-left:58px;width:80%;padding-bottom:20px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-1cd48d98\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/examineModify.vue\n// module id = Txsa\n// module chunks = 3"],"sourceRoot":""}