{"version":3,"sources":["webpack:///resources/ffitm-trainee-Examine/static/js/1.f28d655a.js","webpack:///./traineeExamineSys/views/weeklyModify.vue","webpack:///../node_modules/kindeditor/kindeditor-all.js","webpack:///./traineeExamineSys/views/weeklyModify.vue?afde","webpack:///./traineeExamineSys/views/weeklyModify.vue?aed0","webpack:///traineeExamineSys/views/weeklyModify.vue","webpack:///./traineeExamineSys/views/weeklyModify.vue?73c1","webpack:///../node_modules/kindeditor/themes/default/default.css"],"names":["webpackJsonp","/aZF","module","__webpack_exports__","__webpack_require__","injectStyle","ssrContext","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue___default","n","__WEBPACK_IMPORT_KEY__","key","d","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_b3b3d4de_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_weeklyModify_vue__","normalizeComponent","__vue_styles__","Component","a","4uE9","exports","window","undefined","_isArray","val","prototype","toString","call","_isFunction","_inArray","arr","i","len","length","_each","obj","fn","hasOwnProperty","_trim","str","replace","_inString","delimiter","indexOf","_addUnit","unit","test","_removeUnit","match","exec","parseInt","_escape","_unescape","_toCamel","split","charAt","toUpperCase","substr","_toHex","hex","s","$0","$1","$2","$3","_toMap","map","_toArray","offset","Array","slice","_undef","defaultVal","_invalidUrl","url","_addParam","param","_extend","child","parent","proto","childProto","constructor","_json","text","cx","lastIndex","charCodeAt","eval","_getBasePath","src","els","document","getElementsByTagName","substring","lastIndexOf","_bindEvent","el","type","addEventListener","_useCapture","attachEvent","_unbindEvent","removeEventListener","detachEvent","KEvent","event","this","init","_getId","_eventExpendo","_setId","_eventId","_removeId","e","removeAttribute","_bind","id","_eventData","events","kevent","push","_unbind","splice","count","_fire","_ctrl","ctrlKey","which","shiftKey","altKey","stop","_ready","readyFunc","loaded","KindEditor","_readyFinished","ieReadyFunc","documentElement","doScroll","setTimeout","ieReadyStateFunc","readyState","toplevel","frameElement","_getCssList","css","list","reg","toLowerCase","_getAttrList","tag","_addClassToTag","className","_formatCss","_formatUrl","mode","host","pathname","getRealPath","path","parts","paths","part","pop","join","getRelativePath","depth","prefix","location","protocol","m","_formatHtml","html","htmlTags","urlType","wellFormatted","indentChar","fontSizeList","htmlTagMap","script","style","re","tagStack","$4","$5","$6","full","startNewline","startSlash","tagName","attr","endSlash","endNewline","_SINGLE_TAG_MAP","_INLINE_TAG_MAP","_PRE_TAG_MAP","_BLOCK_TAG_MAP","attrMap","fontStyleMap","fontStyle","color","_FILL_ATTR_MAP","styleMap","k","v","_clearMsWord","_mediaType","_mediaClass","_mediaAttrs","srcTag","unescape","_mediaEmbed","attrs","_mediaImg","blankPath","width","height","escape","_tmpl","data","Function","_contains","nodeA","nodeB","nodeType","parentNode","_getAttr","_GET_SET_ATTRIBUTE","nodeName","getAttribute","div","ownerDocument","createElement","appendChild","cloneNode","innerHTML","_queryAll","expr","root","stripslashes","cmpTag","tagA","tagB","byId","doc","getElementById","byClass","getElementsByClassName","querySelectorAll","cls","byName","name","getElementsByName","byAttr","select","matches","exprList","mergedResults","results","subResults","j","l","isChild","lenth","_query","_get","K","_getDoc","node","_getWin","parentWindow","defaultView","_setHtml","temp","removeChild","empty","each","_hasClass","_setAttr","_IE","_V","setAttribute","_removeAttr","_getNodeName","_computedCss","win","camelKey","getComputedStyle","getPropertyValue","currentStyle","_hasVal","_VALUE_TAG_MAP","_docElement","_QUIRKS","body","_docHeight","Math","max","scrollHeight","clientHeight","_docWidth","scrollWidth","clientWidth","_getScrollPos","x","y","_NEWIE","_OPERA","scrollLeft","scrollTop","scrollX","scrollY","KNode","_updateCollapsed","range","collapsed","startContainer","endContainer","startOffset","endOffset","_copyAndDelete","isCopy","isDelete","splitTextNode","centerNode","nodeValue","splitText","center","setStart","right","setEnd","nodeList","extractNodes","frag","nextNode","firstChild","testRange","KRange","selectNode","start","compareBoundaryPoints","_START_TO_END","incStart","_START_TO_START","incEnd","_END_TO_END","end","_END_TO_START","nextSibling","childFlag","textNode","copyRange","cloneRange","down","ancestor","commonAncestor","createDocumentFragment","up","collapse","_moveToElementText","knode","moveToElementText","_getStartEnd","rng","isStart","parentElement","pointRange","duplicate","nodes","childNodes","index","startNode","startPos","cmp","compareEndPoints","dummy","nodeRange","newNode","isControl","after","setEndPoint","remove","moveStart","lastChild","prevNode","previousSibling","_getEndRange","createTextRange","children","span","kchild","before","_toRange","tr2td","cells","_IERANGE","item","_range","mixed","_nativeCommand","execCommand","_nativeCommandValue","queryCommandValue","_getSel","selection","getSelection","_getRng","sel","rangeCount","getRangeAt","createRange","_singleKeyMap","newMap","_hasAttrOrCss","_hasAttrOrCssByKey","mapKey","method","_removeAttrOrCss","_removeAttrOrCssByKey","allFlag","removeAttr","_getInnerNode","inner","first","_isEmptyNode","isSingle","_mergeWrapper","b","clone","lastA","childA","merged","_mergeAttrs","append","_wrapNode","wrapper","replaceWith","nodeWrapper","next","styles","_inPreElement","hasClass","KCmd","_cmd","selectNodeContents","_drag","options","moveEl","moveFn","clickEl","beforeDrag","iframeFix","docs","_iframeDoc","pos","mousedown","moveListener","preventDefault","kdoc","target","diffX","_round","pageX","diffY","pageY","selectListener","upListener","unbind","self","releaseCapture","stopPropagation","get","mousemove","mouseup","bind","setCapture","KWidget","_widget","iframe","contentDocument","contentWindow","_getInitHtml","themesPath","bodyClass","cssPath","cssData","_direction","_elementVal","hasVal","KEdit","_edit","_selectToolbar","KToolbar","_toolbar","KMenu","_menu","KColorPicker","_colorpicker","KUploadButton","_uploadbutton","_createButton","arg","btn","click","KDialog","_dialog","_tabs","afterSelect","liList","addClass","ul","add","tab","li","title","selectedIndex","panel","show","removeClass","mouseover","mouseout","hide","_loadScript","head","charset","onload","onreadystatechange","_chopQuery","_loadStyle","link","absoluteUrl","links","href","rel","_ajax","dataType","xhr","XMLHttpRequest","ActiveXObject","open","status","responseText","params","encodeURIComponent","setRequestHeader","send","_plugin","_plugins","_parseLangKey","ns","_lang","langType","_language","_getImageFromRange","sc","so","_WEBKIT","img","_bindContextmenuEvent","edit","contextmenu","menu","hideMenu","useContextmenu","_contextmenus","maxWidth","items","cond","shift","prevItem","clientX","clientY","visibility","shadowMode","addItem","docEl","menuHeight","_bindNewlineEvent","getAncestorTagName","isStyle","newlineTag","_GECKO","brSkipTagMap","pSkipTagMap","keydown","cmd","insertHtml","keyup","p","_bindTabEvent","afterTab","shrink","insertNode","_bindFocusEvent","textarea","focus","afterFocus","blur","afterBlur","_removeBookmarkTag","_removeTempTag","_addBookmarkToStack","stack","bookmark","prev","_undoToRedo","fromStack","toStack","designMode","createBookmark","moveToBookmark","KEditor","setOption","se","srcElement","minWidth","minHeight","_MOBILE","_IOS","initContent","plugin","isCreated","_handlers","_undoStack","_redoStack","_firstAddBookmark","dialogs","_editor","_create","create","editor","basePath","langPath","pluginsPath","loadStyleMode","themeType","_instances","DEBUG","_TIME","_VERSION","_eachEditor","console","log","_ua","navigator","userAgent","compatMode","_matches","Date","getTime","round","VERSION","IE","GECKO","WEBKIT","OPERA","V","TIME","isArray","isFunction","inArray","inString","trim","addUnit","removeUnit","toCamel","toHex","toMap","toArray","undef","invalidUrl","addParam","extend","json","_STYLE_TAG_MAP","_CONTROL_TAG_MAP","_NOSPLIT_TAG_MAP","_AUTOCLOSE_TAG_MAP","fullscreenMode","filterMode","wellFormatMode","resizeType","syncType","pasteType","dialogAlignType","fullscreenShortcut","minChangeSize","zIndex","noDisableItems","colorTable","fontSizeTable","font","table","td,th","embed","p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pre","hr","br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del","layout","_INPUT_KEY_MAP","_CURSORMOVE_KEY_MAP","_CHANGE_KEY_MAP","_EVENT_PROPS","relatedTarget","fromElement","toElement","clientLeft","clientTop","charCode","keyCode","metaKey","button","ev","returnValue","cancelBubble","ctrl","ready","formatUrl","formatHtml","getCssList","getAttrList","mediaType","mediaAttrs","mediaEmbed","mediaImg","clearMsWord","tmpl","_getSetAttrDiv","query","queryAll","fire","hasAttr","outer","eq","RegExp","innerText","textContent","offsetWidth","offsetHeight","opacity","filter","getBoundingClientRect","box","left","top","offsetLeft","offsetTop","offsetParent","bool","appendTo","insertBefore","replaceChild","keepChilds","_originDisplay","display","isInline","isBlock","contains","otherNode","last","sibling","scan","order","walk","_K","arguments","NodeClass","_BOOKMARK_ID","getParents","parents","parentA","parentB","parentsA","parentsB","lenA","lenB","setStartBefore","setStartAfter","setEndBefore","setEndAfter","toStart","how","rangeA","rangeB","nodeC","posA","posB","diff","cloneContents","deleteContents","extractContents","c","ec","eo","nodeCount","surroundContents","hasControlRange","createControlRange","addElement","downPos","upPos","enlarge","toBlock","enlargePos","serialize","endNode","dump","RangeClass","START_TO_START","START_TO_END","END_TO_END","END_TO_START","forceReset","hasDummy","hasU200b","ex","createTextNode","removeAllRanges","addRange","scrollTo","wrap","copyWrapper","tempRange","needSplit","dummyParent","ksc","kscp","sb","sa","startBefore","startDummy","endDummy","cmpStart","startAfter","endAfter","commonNode","find","cNode","state","queryCommandState","lc","h1,h2,h3,h4,h5,h6,p,div,pre,address","*","toggle","bold","strong","italic","em","underline","u","strikethrough","forecolor","hilitecolor","fontsize","fontname","fontfamily","removeformat","inserthtml","quickMode","outerHTML","pasteHTML","newRange","print","insertimage","border","align","createlink","setAttr","unlink","queryCommandSupported","CmdClass","z","_alignEl","alignEl","position","z-index","autoPos","autoScroll","scrollPos","updateProp","w","h","draggable","WidgetClass","widget","dir","isDocumentDomain","domain","write","close","afterChange","_mousedownHandler","disabled","contentEditable","afterCreate","beforeGetHtml","beforeSetHtml","afterSetHtml","srcScript","iframeSrc","tabIndex","isNaN","setWidth","setHeight","isFull","design","input","timeoutHandler","EditClass","iframeDoc","hover","disableMode","noDisableItemMap","_itemMap","unselect","enable","disable","disableAll","ToolbarClass","toolbar","centerLineMode","itemDiv","leftDiv","rightDiv","iconClass","centerDiv","checked","beforeRemove","MenuClass","colors","selectedColor","_cells","cellPadding","cellSpacing","row","insertRow","cell","insertCell","colSpan","_addAttr","noColor","ColorPickerClass","colorpicker","fieldName","extraParams","afterError","alert","hiddenElements","form","fileBox","submit","tempForm","reset","afterUpload","UploadButtonClass","uploadbutton","previewBtn","yesBtn","noBtn","closeBtn","showMask","contentDiv","iframeMask","headerDiv","closeIcon","bodyDiv","footerDiv","mask","docWidth","docHeight","isLoading","setMaskIndex","showLoading","msg","loading","hideLoading","DialogClass","dialog","tabs","loadScript","loadStyle","ajax","lang","loadPlugin","handler","clickToolbar","updateState","addContextmenu","initResize","statusbar","resize","overflow","container","toolbarDiv","editDiv","_scrollPos","_fullscreenExecuted","htmlList","menuName","editHeight","_docMousedownFn","addBookmark","readonlyMode","readonly","_fullscreenResizeHandler","hideDialog","fullHtml","isEmpty","isDirty","selectedHtml","changeFlag","apply","appendHtml","sync","checkSize","abs","undo","redo","fullscreen","isReadonly","createMenu","hideContextmenu","createDialog","firstDialog","parentDialog","errorDialog","EditorClass","instances","shortcutKeys","selectall","hasForm","resetBtn","blocks","heights","h1","h2","h3","H4","curVal","getSelectedLink","getSelectedImage","getSelectedFlash","getSelectedMedia","getSelectedAnchor","uName","getSelectedTable","getSelectedRow","getSelectedCell","movePastedData","pasting","white-space","imgAttrs","code","source","preview","cut","copy","paste","plainpaste","wordpaste","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","formatblock","image","multiimage","flash","media","tablecell","emoticons","about","filemanager","baidumap","lineheight","clearhtml","pagebreak","quickformat","insertfile","template","anchor","yes","no","editImage","deleteImage","editFlash","deleteFlash","editMedia","deleteMedia","editLink","deleteLink","editAnchor","deleteAnchor","tableprop","tablecellprop","tableinsert","tabledelete","tablecolinsertleft","tablecolinsertright","tablerowinsertabove","tablerowinsertbelow","tablerowmerge","tablecolmerge","tablerowsplit","tablecolsplit","tablecoldelete","tablerowdelete","pleaseSelectFile","invalidImg","invalidMedia","invalidWidth","invalidHeight","invalidBorder","invalidRows","invalidCols","invalidPadding","invalidSpacing","invalidJson","uploadSuccess","cutError","copyError","pasteError","ajaxLoading","uploadLoading","uploadError","plainpaste.comment","wordpaste.comment","code.pleaseInput","link.url","link.linkType","link.newWindow","link.selfWindow","flash.url","flash.width","flash.height","flash.upload","flash.viewServer","media.url","media.width","media.height","media.autostart","media.upload","media.viewServer","image.remoteImage","image.localImage","image.remoteUrl","image.localUrl","image.size","image.width","image.height","image.resetSize","image.align","image.defaultAlign","image.leftAlign","image.rightAlign","image.imgTitle","image.upload","image.viewServer","multiimage.uploadDesc","multiimage.startUpload","multiimage.clearAll","multiimage.insertAll","multiimage.queueLimitExceeded","multiimage.fileExceedsSizeLimit","multiimage.zeroByteFile","multiimage.invalidFiletype","multiimage.unknownError","multiimage.pending","multiimage.uploadError","filemanager.emptyFolder","filemanager.moveup","filemanager.viewType","filemanager.viewImage","filemanager.listImage","filemanager.orderType","filemanager.fileName","filemanager.fileSize","filemanager.fileType","insertfile.url","insertfile.title","insertfile.upload","insertfile.viewServer","table.cells","table.rows","table.cols","table.size","table.width","table.height","table.percent","table.px","table.space","table.padding","table.spacing","table.align","table.textAlign","table.verticalAlign","table.alignDefault","table.alignLeft","table.alignCenter","table.alignRight","table.alignTop","table.alignMiddle","table.alignBottom","table.alignBaseline","table.border","table.borderWidth","table.borderColor","table.backgroundColor","map.address","map.search","baidumap.address","baidumap.search","baidumap.insertDynamicMap","anchor.name","formatblock.formatBlock","h4","fontname.fontName","SimSun","NSimSun","FangSong_GB2312","KaiTi_GB2312","SimHei","Microsoft YaHei","Arial","Arial Black","Times New Roman","Courier New","Tahoma","Verdana","lineheight.lineHeight","1","1.5","2","2.5","3","template.selectTemplate","template.replaceContent","template.fileList","1.html","2.html","3.html","nameBox","delete","hideScroll","scroll","overflowY","resetHeight","autoHeightMode","mapWidth","mapHeight","address","search","insertDynamicMap","centerObj","getCenter","lng","lat","zoom","getZoom","checkbox","searchBtn","addressBox","geocoder","maptype","getMapTypeId","div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pleaseInput","emoticonsPath","allowPreview","allowPreviewEmoticons","currentPageNum","bindCellEvent","num","previewDiv","colsHalf","previewImg","createEmoticonsTable","pageNum","parentDiv","elements","startNum","rows","cols","removeEvent","bindPageEvent","pageDiv","wrapperDiv","createPageTable","pages","ceil","floor","makeFileTitle","filename","filesize","datetime","bindTitle","is_dir","fileManagerJson","imgPath","filemanagerDialog","reloadPage","func","dirName","bindEvent","result","createFunc","fileUrl","current_url","dirPath","current_dir_path","orderTypeBox","is_photo","clickFn","elList","createCommon","changeFunc","viewTypeBox","createView","createList","moveupLink","moveup_dir_path","change","fileList","file_list","iconUrl","cell0","has_file","emptyFolder","photoDiv","viewType","moveup","viewImage","listImage","orderType","fileName","fileSize","fileType","allowFlashUpload","allowFileManager","formatUploadUrl","extraFileUploadParams","filePostName","uploadJson","upload","viewServer","urlBox","widthBox","heightBox","quality","viewServerBtn","error","message","afterSelectFile","allowImageUpload","allowImageRemote","imageTabIndex","fillDescAfterUploadImage","imageDialog","setSize","originalWidth","originalHeight","showRemote","imageUrl","imageWidth","imageHeight","imageTitle","imageAlign","showLocal","remoteUrl","size","resetSize","imgTitle","localUrl","dialogWidth","dialogHeight","localUrlBox","titleBox","alignBox","refreshBtn","remoteImage","localImage","tempImg","allowFileUpload","fileDialog","fileTitle","lineHeight","linkType","typeBox","Option","newWindow","selfWindow","allowMediaUpload","autostart","autostartBox","loop","KSWFUpload","showError","progressbars","uploadDesc","startButtonValue","settings","debug","upload_url","uploadUrl","flash_url","flashUrl","file_post_name","button_placeholder","button_image_url","buttonImageUrl","button_width","buttonWidth","button_height","buttonHeight","button_cursor","SWFUpload","CURSOR","HAND","file_types","fileTypes","file_types_description","fileTypesDesc","file_upload_limit","fileUploadLimit","file_size_limit","fileSizeLimit","post_params","postParams","file_queued_handler","file","fileIconUrl","appendFile","file_queue_error_handler","errorCode","errorName","QUEUE_ERROR","QUEUE_LIMIT_EXCEEDED","queueLimitExceeded","FILE_EXCEEDS_SIZE_LIMIT","fileExceedsSizeLimit","ZERO_BYTE_FILE","zeroByteFile","INVALID_FILETYPE","invalidFiletype","unknownError","upload_start_handler","upload_progress_handler","bytesLoaded","bytesTotal","percent","progressbar","bar","upload_error_handler","filestatus","FILE_STATUS","ERROR","errorMessage","upload_success_handler","serverData","swfu","startUpload","getUrlList","COMPLETE","removeFile","fileId","cancelUpload","removeFiles","statusDiv","pendingMessage","destroy","swfupload","element","imageSizeLimit","imageUploadLimit","imageFileTypes","multiImageDialog","uploadLimit","sizeLimit","insertAll","clearAll","pending","urlList","initSWFUpload","customSettings","eventQueue","movieName","movieCount","movieElement","initSettings","loadFlash","displayDebugInfo","version","UPLOAD_ERROR","HTTP_ERROR","MISSING_UPLOAD_URL","IO_ERROR","SECURITY_ERROR","UPLOAD_LIMIT_EXCEEDED","UPLOAD_FAILED","SPECIFIED_FILE_ID_NOT_FOUND","FILE_VALIDATION_FAILED","FILE_CANCELLED","UPLOAD_STOPPED","QUEUED","IN_PROGRESS","CANCELLED","BUTTON_ACTION","SELECT_FILE","SELECT_FILES","START_UPLOAD","ARROW","WINDOW_MODE","WINDOW","TRANSPARENT","OPAQUE","completeURL","indexSlash","hostname","port","ensureDefault","settingName","defaultValue","debug_enabled","return_upload_start_handler","returnUploadStart","debugMessage","custom_settings","prevent_swf_caching","preserve_relative_urls","targetElement","tempParent","button_placeholder_id","getFlashHTML","getMovieElement","classid","button_window_mode","getFlashVars","paramString","buildParamString","httpSuccessString","http_success","use_query_string","requeue_on_error","assume_success_timeout","file_queue_limit","button_text","button_text_top_padding","button_text_left_padding","button_text_style","button_action","button_disabled","paramStringPairs","ex1","ex2","swfupload_loaded_handler","file_dialog_start_handler","upload_complete_handler","debug_handler","addSetting","default_value","getSetting","callFlash","functionName","argumentArray","returnString","CallFunction","__flash__argumentsToXML","post","unescapeFilePostParams","selectFile","selectFiles","fileID","triggerErrorEvent","stopUpload","getStats","setStats","statsObject","getFile","addFileParam","removeFileParam","setUploadURL","setPostParams","paramsObject","addPostParam","removePostParam","setFileTypes","types","description","setFileSizeLimit","setFileUploadLimit","setFileQueueLimit","fileQueueLimit","setFilePostName","setUseQueryString","useQueryString","setRequeueOnError","requeueOnError","setHTTPSuccess","http_status_codes","setAssumeSuccessTimeout","timeout_seconds","setDebugEnabled","debugEnabled","setButtonImageURL","buttonImageURL","setButtonDimensions","movie","setButtonText","setButtonTextPadding","setButtonTextStyle","setButtonDisabled","isDisabled","setButtonAction","buttonAction","setButtonCursor","cursor","queueEvent","handlerName","executeNextEvent","f","uk","unescapedPost","String","fromCharCode","testExternalInterface","flashReady","cleanUp","instance","flashEx","fileDialogStart","fileQueued","fileQueueError","fileDialogComplete","numFilesSelected","numFilesQueued","numFilesInQueue","uploadStart","uploadProgress","bytesComplete","responseReceived","uploadComplete","exceptionMessage","exceptionValues","Console","writeLine","documentForm","fontFamily","margin","queue","oldInitSettings","queueSettings","queue_cancelled_flag","queue_upload_count","user_upload_complete_handler","user_upload_start_handler","uploadCompleteHandler","uploadStartHandler","queue_complete_handler","cancelQueue","stats","files_queued","pagebreakHtml","tail","comment","getFirstChild","blockMap","subList","_setColor","_initColorPicker","dialogDiv","colorBox","removePicker","pickerList","picker","_getCellIndex","rowSpanCount","rowSpan","cellIndex","prop","isInsert","px","space","padding","spacing","alignDefault","alignLeft","alignCenter","alignRight","borderWidth","borderColor","backgroundColor","rowsBox","colsBox","widthType","widthTypeBox","heightType","heightTypeBox","paddingBox","spacingBox","borderBox","bgColor","tableWidth","tableHeight","cellprop","textAlign","verticalAlign","alignTop","alignMiddle","alignBottom","alignBaseline","textAlignBox","verticalAlignBox","background-color","text-align","vertical-align","border-width","border-style","border-color","cellWidth","cellHeight","insert","colinsert","newRow","newCell","colinsertleft","colinsertright","rowinsert","rowIndex","rowinsertabove","rowinsertbelow","rowmerge","nextRowIndex","nextRow","nextCell","deleteCell","colmerge","nextCellIndex","rowsplit","colsplit","coldelete","rowdelete","deleteRow","getFilePath","htmlPath","selectTemplate","replaceContent","selectBox","GHZM","render","_vm","_h","$createElement","_c","_self","staticClass","ref","label-position","labelPosition","inline","label-width","rules","model","editDetail","label","placeholder","callback","$$v","subjectName","expression","_v","staffname","keyWord","staffType","_l","typeId","typeValue","subjectGroupType","subjectClass","weeklyType","staticStyle","action","on-remove","handleRemove","file-list","auto-upload","slot","margin-left","on","$event","submitUpload","filesList","update","deldetail","staticRenderFns","esExports","UB8H","content","locals","W6IE","_interopRequireDefault","__esModule","default","_defineProperty2","_defineProperty3","_service","_service2","_ref","required","trigger","attachName","attachRemark","mounted","getselect","getList","methods","_this","getListGroupType","then","res","catch","err","getListType","getListStaffType","getSubjectClass","_this2","weeklyId","$route","getWeeklyDetailInfo","editdetail","staffID","createStaffId","subjectNote","weeklyDesc","nextWeeklyDesc","$refs","cwlas","addWeekLyAttachyInfo","response","handlePreview","formName","_this3","validate","valid","ckl","updateWeeklyInfo","YKL+","iFdl"],"mappings":"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","file":"resources/ffitm-trainee-Examine/static/js/1.f28d655a.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ \"/aZF\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue__ = __webpack_require__(\"W6IE\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue__);\n/* harmony namespace reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue__[key]; }) }(__WEBPACK_IMPORT_KEY__));\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_b3b3d4de_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_weeklyModify_vue__ = __webpack_require__(\"GHZM\");\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"UB8H\")\n}\nvar normalizeComponent = __webpack_require__(\"/4AN\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-b3b3d4de\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_weeklyModify_vue___default.a,\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_b3b3d4de_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_weeklyModify_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"4uE9\":\n/***/ (function(module, exports) {\n\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n/***/ }),\n\n/***/ \"GHZM\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-ctn\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"main-content clearfix\"},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"150px\",\"rules\":_vm.rules,\"model\":_vm.editDetail,\"size\":\"mini\"}},[_c('el-form-item',{attrs:{\"label\":\"周报名称\",\"prop\":\"subjectName\"}},[_c('el-input',{attrs:{\"placeholder\":\"周报名称\",\"name\":\"subjectName\",\"disabled\":true},model:{value:(_vm.editDetail.subjectName),callback:function ($$v) {_vm.editDetail.subjectName=$$v},expression:\"editDetail.subjectName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"报告人\",\"prop\":\"staffname\"}},[_c('el-input',{attrs:{\"placeholder\":\"报告人\",\"name\":\"staffname\",\"disabled\":true},model:{value:(_vm.editDetail.staffname),callback:function ($$v) {_vm.editDetail.staffname=$$v},expression:\"editDetail.staffname\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"关键字标签\",\"prop\":\"keyWord\"}},[_c('el-input',{attrs:{\"placeholder\":\"关键字标签\",\"name\":\"keyWord\"},model:{value:(_vm.editDetail.keyWord),callback:function ($$v) {_vm.editDetail.keyWord=$$v},expression:\"editDetail.keyWord\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"身份\",\"prop\":\"staffType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的身份\"},model:{value:(_vm.editDetail.staffType),callback:function ($$v) {_vm.editDetail.staffType=$$v},expression:\"editDetail.staffType\"}},_vm._l((_vm.staffType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"subjectGroupType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.editDetail.subjectGroupType),callback:function ($$v) {_vm.editDetail.subjectGroupType=$$v},expression:\"editDetail.subjectGroupType\"}},_vm._l((_vm.subjectGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"届数\",\"prop\":\"subjectClass\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的届数\"},model:{value:(_vm.editDetail.subjectClass),callback:function ($$v) {_vm.editDetail.subjectClass=$$v},expression:\"editDetail.subjectClass\"}},_vm._l((_vm.subjectClass),function(item){return _c('el-option',{key:item.key,attrs:{\"label\":item.value,\"value\":item.key}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"周报类型\",\"prop\":\"weeklyType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的周报类型\"},model:{value:(_vm.editDetail.weeklyType),callback:function ($$v) {_vm.editDetail.weeklyType=$$v},expression:\"editDetail.weeklyType\"}},_vm._l((_vm.weeklyType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"周报描述\",\"prop\":\"weeklyDesc\"}},[_c('div',{staticClass:\"knowledge-content-editor\",staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"edit\"}})])]),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"下周计划\",\"prop\":\"nextWeeklyDesc\"}},[_c('div',{staticClass:\"knowledge-content-editor\",staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"edito\"}})])]),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"周报笔记\",\"prop\":\"subjectNote\"}},[_c('div',{staticClass:\"knowledge-content-editor\",staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"editor\"}})])]),_vm._v(\" \"),_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo clearfix\",attrs:{\"action\":\"www.baidu.com\",\"on-remove\":_vm.handleRemove,\"file-list\":_vm.fileList,\"auto-upload\":false}},[_c('div',{staticClass:\"updateweekly\"},[_vm._v(\"上传周报附件\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"selfile\",attrs:{\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取文件\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":function($event){_vm.submitUpload(_vm.editDetail, _vm.filesList)}}},[_vm._v(\"上传到服务器\")])],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"weekly-footer\",slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.update(_vm.editDetail,'formName',_vm.filesList)}}},[_vm._v(\"更新\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.deldetail()}}},[_vm._v(\"取消\")])],1)],1)])])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n\n/***/ \"UB8H\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"YKL+\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"X/Wc\")(\"6a11d7d0\", content, true, {});\n\n/***/ }),\n\n/***/ \"W6IE\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _defineProperty2 = __webpack_require__(\"Xos8\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _service = __webpack_require__(\"CxL4\");\n\nvar _service2 = _interopRequireDefault(_service);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(\"4uE9\"); //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n__webpack_require__(\"iFdl\");\nexports.default = {\n  data: function data() {\n    var _ref;\n\n    return _ref = {\n      rules: {\n        keyWord: [{\n          required: true,\n          message: \"请输入关键字标签\",\n          trigger: \"blur\"\n        }],\n        staffType: [{\n          required: true,\n          message: \"请选择身份\",\n          trigger: \"blur\"\n        }],\n        subjectGroupType: [{\n          required: true,\n          message: \"请选择归属组\",\n          trigger: \"blur\"\n        }],\n        subjectClass: [{\n          required: true,\n          message: \"请选择届数\",\n          trigger: \"blur\"\n        }],\n        weeklyType: [{\n          required: true,\n          message: \"请选择周报类型\",\n          trigger: \"blur\"\n        }]\n\n        // weeklyDesc: [\n        //   {\n        //     required: true,\n        //     message: \"请输入周报描述\",\n        //     trigger: \"blur\"\n        //   }\n        // ],\n        // nextWeeklyDesc: [\n        //   {\n        //     required: true,\n        //     message: \"请输入下周计划\",\n        //     trigger: \"blur\"\n        //   }\n        // ],\n        // subjectNote: [\n        //   {\n        //     required: true,\n        //     message: \"请输入周报笔记\",\n        //     trigger: \"blur\"\n        //   }\n        // ]\n      },\n      filesList: [{\n        attachName: \"附件三\",\n        attachRemark: \"www.baidu.com\"\n      }, {\n        attachName: \"附件四\",\n        attachRemark: \"www.baidu.com\"\n      }],\n      weeklyType: [],\n      subjectGroupType: [],\n      subjectClass: [],\n      staffType: []\n    }, (0, _defineProperty3.default)(_ref, \"weeklyType\", []), (0, _defineProperty3.default)(_ref, \"staffname\", \"\"), (0, _defineProperty3.default)(_ref, \"subjectName\", \"\"), (0, _defineProperty3.default)(_ref, \"labelPosition\", \"right\"), (0, _defineProperty3.default)(_ref, \"weeklyList\", {}), (0, _defineProperty3.default)(_ref, \"Aauthor\", \"\"), (0, _defineProperty3.default)(_ref, \"staffID\", \"\"), (0, _defineProperty3.default)(_ref, \"editdetail\", \"\"), (0, _defineProperty3.default)(_ref, \"editDetail\", {\n      typeValue: \"\"\n    }), _ref;\n  },\n  mounted: function mounted() {\n    this.getselect();\n    this.getList();\n    var options = {\n      width: \"99.5%\",\n      height: \"200px\",\n      themeType: \"simple\",\n      items: [\"undo\", \"redo\", \"|\", \"selectall\", \"formatblock\", \"fontname\", \"fontsize\", \"|\", \"forecolor\", \"hilitecolor\", \"bold\", \"italic\", \"underline\", \"strikethrough\", \"lineheight\", \"removeformat\", \"|\", \"preview\", \"cut\", \"copy\", \"paste\", \"plainpaste\", \"|\", \"justifyleft\", \"justifycenter\", \"justifyright\", \"justifyfull\", \"insertorderedlist\", \"insertunorderedlist\", \"indent\", \"outdent\", \"subscript\", \"superscript\", \"|\", \"image\", \"hr\", \"code\"],\n\n      resizeType: 1,\n      newlineTag: \"br\",\n      imageTabIndex: 1,\n      uploadJson: \"/KnowledgesController/savePic\",\n      filePostName: \"file\",\n      allowImageUpload: true,\n      allowFileManager: false,\n      formatUploadUrl: true,\n      allowImageRemote: false,\n      afterUpload: function afterUpload(url) {\n        //console.log(url)\n      }\n    };\n    var editor = new Array();\n    KindEditor.ready(function (K) {\n      editor[0] = K.create(\"#editor\", options);\n      editor[1] = K.create(\"#edit\", options);\n      editor[2] = K.create(\"#edito\", options);\n    });\n  },\n\n  methods: {\n    getselect: function getselect() {\n      var _this = this;\n\n      _service2.default.getListGroupType().then(function (res) {\n        _this.subjectGroupType = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n      _service2.default.getListType().then(function (res) {\n        _this.weeklyType = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n      _service2.default.getListStaffType().then(function (res) {\n        _this.staffType = res.data;\n        console.log(_this.staffType);\n      }).catch(function (err) {\n        console.log(err);\n      });\n      _service2.default.getSubjectClass().then(function (res) {\n        _this.subjectClass = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    getList: function getList() {\n      var _this2 = this;\n\n      var params = {\n        weeklyId: this.$route.query.id\n      };\n      console.log(params);\n      _service2.default.getWeeklyDetailInfo(params).then(function (res) {\n        console.log(res);\n        // 将获取回来的数据赋值给list\n        _this2.editdetail = res.data;\n        console.log(_this2.editdetail);\n        _this2.subjectName = _this2.$route.query.subjectName, _this2.staffname = _this2.$route.query.staffname;\n        _this2.staffID = _this2.$route.query.staffID;\n        _this2.editDetail = {\n          subjectName: _this2.subjectName,\n          staffname: _this2.staffname,\n          createStaffId: _this2.staffID,\n          keyWord: _this2.editdetail.keyWord,\n          staffType: _this2.editdetail.staffType,\n          subjectClass: _this2.editdetail.subjectClass,\n          subjectGroupType: _this2.editdetail.subjectGroupType,\n          weeklyType: _this2.editdetail.weeklyType\n        };\n        KindEditor.instances[0].html(_this2.editdetail.subjectNote), KindEditor.instances[1].html(_this2.editdetail.weeklyDesc), KindEditor.instances[2].html(_this2.editdetail.nextWeeklyDesc);\n        console.log(_this2.editDetail);\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    submitUpload: function submitUpload(editDetail, filesList) {\n      this.$refs.upload.submit();\n      var params = {\n        weeklyId: this.$route.query.id,\n        cwlas: this.filesList\n      };\n      console.log(params);\n      _service2.default.addWeekLyAttachyInfo(params).then(function (response) {}).catch(function (error) {\n        console.log(error);\n      });\n    },\n    handleRemove: function handleRemove(file, fileList) {\n      console.log(file, fileList);\n    },\n    handlePreview: function handlePreview(file) {\n      console.log(file);\n    },\n\n    // 删除\n    deldetail: function deldetail() {\n      window.close();\n    },\n\n    //确认更新\n    update: function update(editDetail, formName) {\n      var _this3 = this;\n\n      var subjectNote = KindEditor.instances[0].html().split(\"\\n\").join(\"\");\n      console.log(subjectNote);\n      var weeklyDesc = KindEditor.instances[1].html().split(\"\\n\").join(\"\");\n      console.log(weeklyDesc);\n      var nextWeeklyDesc = KindEditor.instances[2].html().split(\"\\n\").join(\"\");\n      console.log(this.editDetail.subjectClass);\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          _this3.editDetail = {\n            weeklyId: _this3.$route.query.id,\n            subjectName: _this3.subjectName,\n            createStaffId: _this3.staffID,\n            subjectNote: subjectNote,\n            weeklyDesc: weeklyDesc,\n            nextWeeklyDesc: nextWeeklyDesc,\n            keyWord: _this3.editDetail.keyWord,\n            staffType: _this3.editDetail.staffType,\n            subjectClass: _this3.editDetail.subjectClass,\n            subjectGroupType: _this3.editDetail.subjectGroupType,\n            weeklyType: _this3.editDetail.weeklyType\n          };\n\n          var params = {\n            ckl: _this3.editDetail\n          };\n          console.log(params);\n          _service2.default.updateWeeklyInfo(params).then(function (response) {\n            alert(\"修改成功\");\n            window.close();\n            // window.close();\n          }).catch(function (error) {\n            console.log(error);\n          });\n          alert(\"submit!\");\n        } else {\n          return false;\n          _this3.$message(\"修改失败\");\n        }\n      });\n    }\n  }\n};\n\n/***/ }),\n\n/***/ \"YKL+\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"lcwS\")(false);\n// imports\n\n\n// module\nexports.push([module.i, \".main-ctn[data-v-b3b3d4de]{background:#f8f8f8}.bg-purple[data-v-b3b3d4de]{background:#fff;border-radius:8px}.main-content[data-v-b3b3d4de]{padding-top:30px}.el-form-item[data-v-b3b3d4de]{margin-top:5px}.main-content .dialog-footer[data-v-b3b3d4de]{margin:0 auto}.weekly-footer[data-v-b3b3d4de]{float:left;margin-left:40%!important;margin-bottom:20px!important}.knowledge-content-editor[data-v-b3b3d4de]{width:110%}.updateweekly[data-v-b3b3d4de]{margin-top:5px;float:left;font-weight:400;color:#66666f}.selfile[data-v-b3b3d4de]{margin-left:10px!important}.upload-demo[data-v-b3b3d4de]{margin-left:58px;width:80%;padding-bottom:20px}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"iFdl\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// resources/ffitm-trainee-Examine/static/js/1.f28d655a.js","function injectStyle (ssrContext) {\n  require(\"!!vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b3b3d4de\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./weeklyModify.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./weeklyModify.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./weeklyModify.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b3b3d4de\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./weeklyModify.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-b3b3d4de\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./traineeExamineSys/views/weeklyModify.vue\n// module id = /aZF\n// module chunks = 1","/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/kindeditor/kindeditor-all.js\n// module id = 4uE9\n// module chunks = 0 1 2 3 4","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-ctn\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"main-content clearfix\"},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"150px\",\"rules\":_vm.rules,\"model\":_vm.editDetail,\"size\":\"mini\"}},[_c('el-form-item',{attrs:{\"label\":\"周报名称\",\"prop\":\"subjectName\"}},[_c('el-input',{attrs:{\"placeholder\":\"周报名称\",\"name\":\"subjectName\",\"disabled\":true},model:{value:(_vm.editDetail.subjectName),callback:function ($$v) {_vm.editDetail.subjectName=$$v},expression:\"editDetail.subjectName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"报告人\",\"prop\":\"staffname\"}},[_c('el-input',{attrs:{\"placeholder\":\"报告人\",\"name\":\"staffname\",\"disabled\":true},model:{value:(_vm.editDetail.staffname),callback:function ($$v) {_vm.editDetail.staffname=$$v},expression:\"editDetail.staffname\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"关键字标签\",\"prop\":\"keyWord\"}},[_c('el-input',{attrs:{\"placeholder\":\"关键字标签\",\"name\":\"keyWord\"},model:{value:(_vm.editDetail.keyWord),callback:function ($$v) {_vm.editDetail.keyWord=$$v},expression:\"editDetail.keyWord\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"身份\",\"prop\":\"staffType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的身份\"},model:{value:(_vm.editDetail.staffType),callback:function ($$v) {_vm.editDetail.staffType=$$v},expression:\"editDetail.staffType\"}},_vm._l((_vm.staffType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"subjectGroupType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.editDetail.subjectGroupType),callback:function ($$v) {_vm.editDetail.subjectGroupType=$$v},expression:\"editDetail.subjectGroupType\"}},_vm._l((_vm.subjectGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"届数\",\"prop\":\"subjectClass\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的届数\"},model:{value:(_vm.editDetail.subjectClass),callback:function ($$v) {_vm.editDetail.subjectClass=$$v},expression:\"editDetail.subjectClass\"}},_vm._l((_vm.subjectClass),function(item){return _c('el-option',{key:item.key,attrs:{\"label\":item.value,\"value\":item.key}})}))]],2),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"周报类型\",\"prop\":\"weeklyType\"}},[[_c('el-select',{attrs:{\"placeholder\":\"请选择您的周报类型\"},model:{value:(_vm.editDetail.weeklyType),callback:function ($$v) {_vm.editDetail.weeklyType=$$v},expression:\"editDetail.weeklyType\"}},_vm._l((_vm.weeklyType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))]],2),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"周报描述\",\"prop\":\"weeklyDesc\"}},[_c('div',{staticClass:\"knowledge-content-editor\",staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"edit\"}})])]),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"下周计划\",\"prop\":\"nextWeeklyDesc\"}},[_c('div',{staticClass:\"knowledge-content-editor\",staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"edito\"}})])]),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"周报笔记\",\"prop\":\"subjectNote\"}},[_c('div',{staticClass:\"knowledge-content-editor\",staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"editor\"}})])]),_vm._v(\" \"),_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo clearfix\",attrs:{\"action\":\"www.baidu.com\",\"on-remove\":_vm.handleRemove,\"file-list\":_vm.fileList,\"auto-upload\":false}},[_c('div',{staticClass:\"updateweekly\"},[_vm._v(\"上传周报附件\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"selfile\",attrs:{\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取文件\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":function($event){_vm.submitUpload(_vm.editDetail, _vm.filesList)}}},[_vm._v(\"上传到服务器\")])],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"weekly-footer\",slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.update(_vm.editDetail,'formName',_vm.filesList)}}},[_vm._v(\"更新\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.deldetail()}}},[_vm._v(\"取消\")])],1)],1)])])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-b3b3d4de\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!../node_modules/vue-loader/lib/selector.js?type=template&index=0!./traineeExamineSys/views/weeklyModify.vue\n// module id = GHZM\n// module chunks = 1","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b3b3d4de\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./weeklyModify.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"6a11d7d0\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-style-loader!../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-b3b3d4de\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/weeklyModify.vue\n// module id = UB8H\n// module chunks = 1","<template>\r\n  <div class=\"main-ctn\">\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <div class=\"grid-content bg-purple\">\r\n          <div class=\"main-content clearfix\">\r\n            <el-form :label-position=\"labelPosition\" :inline=\"true\" label-width=\"150px\" :rules=\"rules\" :model=\"editDetail\" size=\"mini\" ref=\"formName\">\r\n              <el-form-item label=\"周报名称\" prop=\"subjectName\">\r\n                <el-input v-model=\"editDetail.subjectName\" placeholder=\"周报名称\" name=\"subjectName\" :disabled=\"true\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"报告人\"  prop=\"staffname\">\r\n                <el-input v-model=\"editDetail.staffname\" placeholder=\"报告人\" name=\"staffname\" :disabled=\"true\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"关键字标签\"  prop=\"keyWord\">\r\n                <el-input v-model=\"editDetail.keyWord\" placeholder=\"关键字标签\" name=\"keyWord\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"身份\" prop=\"staffType\">\r\n              <template>\r\n                <el-select v-model=\"editDetail.staffType\" placeholder=\"请选择您的身份\"  >\r\n                   <el-option v-for=\"item in staffType\" :key=\"item.typeId\" :label=\"item.typeValue\"  :value=\"item.typeId\"></el-option>\r\n                </el-select>\r\n              </template>\r\n              </el-form-item>\r\n              <el-form-item label=\"归属组\" prop=\"subjectGroupType\">\r\n              <template>\r\n                <el-select v-model=\"editDetail.subjectGroupType\" placeholder=\"请选择您的归属组\"  >\r\n                   <el-option v-for=\"item in subjectGroupType\" :key=\"item.typeId\" :label=\"item.typeValue\"  :value=\"item.typeId\"></el-option>\r\n                </el-select>\r\n              </template>\r\n              </el-form-item>\r\n              <el-form-item label=\"届数\" prop=\"subjectClass\">\r\n              <template>\r\n                <el-select v-model=\"editDetail.subjectClass\" placeholder=\"请选择您的届数\"  >\r\n                   <el-option v-for=\"item in subjectClass\" :key=\"item.key\" :label=\"item.value\"  :value=\"item.key\"></el-option>\r\n                </el-select>\r\n              </template>\r\n              </el-form-item>\r\n              <el-form-item label=\"周报类型\" prop=\"weeklyType\">\r\n              <template>\r\n                <el-select v-model=\"editDetail.weeklyType\" placeholder=\"请选择您的周报类型\">\r\n                   <el-option v-for=\"item in weeklyType\" :key=\"item.typeId\" :label=\"item.typeValue\"  :value=\"item.typeId\"></el-option>\r\n                </el-select>\r\n              </template>\r\n              </el-form-item>\r\n              <el-form-item label=\"周报描述\" prop=\"weeklyDesc\" style=\"height:calc(100% - 200px)\">\r\n                <div class=\"knowledge-content-editor\" style=\"height:100%\">\r\n                  <textarea name=\"editor\" id=\"edit\"></textarea>\r\n                </div>\r\n              </el-form-item>\r\n              <el-form-item label=\"下周计划\" prop=\"nextWeeklyDesc\" style=\"height:calc(100% - 200px)\">\r\n                <div class=\"knowledge-content-editor\" style=\"height:100%\">\r\n                  <textarea name=\"editor\" id=\"edito\"></textarea>\r\n                </div>\r\n              </el-form-item>\r\n              <el-form-item label=\"周报笔记\" prop=\"subjectNote\" style=\"height:calc(100% - 200px)\">\r\n                <div class=\"knowledge-content-editor\" style=\"height:100%\">\r\n                  <textarea name=\"editor\" id=\"editor\"></textarea>\r\n                </div>\r\n              </el-form-item>\r\n              <el-upload class=\"upload-demo clearfix\" ref=\"upload\" action=\"www.baidu.com\" :on-remove=\"handleRemove\" :file-list=\"fileList\" :auto-upload=\"false\">\r\n               <div class=\"updateweekly\">上传周报附件</div>\r\n               <el-button slot=\"trigger\" size=\"small\" type=\"primary\" class=\"selfile\">选取文件</el-button>\r\n               <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload(editDetail, filesList)\">上传到服务器</el-button>\r\n              </el-upload>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"weekly-footer\">     \r\n              <el-button  @click=\"update(editDetail,'formName',filesList)\">更新</el-button>\r\n              <el-button type=\"primary\" @click=\"deldetail()\">取消</el-button>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport service from \"../scripts/service.js\";\r\nrequire(\"kindeditor\");\r\nrequire(\"kindeditor/themes/default/default.css\");\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      rules: {\r\n        keyWord: [\r\n          {\r\n            required: true,\r\n            message: \"请输入关键字标签\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        staffType: [\r\n          {\r\n            required: true,\r\n            message: \"请选择身份\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        subjectGroupType: [\r\n          {\r\n            required: true,\r\n            message: \"请选择归属组\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        subjectClass: [\r\n          {\r\n            required: true,\r\n            message: \"请选择届数\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        weeklyType: [\r\n          {\r\n            required: true,\r\n            message: \"请选择周报类型\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n\r\n        // weeklyDesc: [\r\n        //   {\r\n        //     required: true,\r\n        //     message: \"请输入周报描述\",\r\n        //     trigger: \"blur\"\r\n        //   }\r\n        // ],\r\n        // nextWeeklyDesc: [\r\n        //   {\r\n        //     required: true,\r\n        //     message: \"请输入下周计划\",\r\n        //     trigger: \"blur\"\r\n        //   }\r\n        // ],\r\n        // subjectNote: [\r\n        //   {\r\n        //     required: true,\r\n        //     message: \"请输入周报笔记\",\r\n        //     trigger: \"blur\"\r\n        //   }\r\n        // ]\r\n      },\r\n      filesList: [\r\n        {\r\n          attachName: \"附件三\",\r\n          attachRemark: \"www.baidu.com\"\r\n        },\r\n        {\r\n          attachName: \"附件四\",\r\n          attachRemark: \"www.baidu.com\"\r\n        }\r\n      ],\r\n      weeklyType: [],\r\n      subjectGroupType: [],\r\n      subjectClass: [],\r\n      staffType: [],\r\n      weeklyType: [],\r\n      staffname: \"\",\r\n      subjectName: \"\",\r\n      labelPosition: \"right\",\r\n      weeklyList: {},\r\n      Aauthor: \"\",\r\n      staffID: \"\",\r\n      editdetail: \"\",\r\n      editDetail: {\r\n        typeValue: \"\"\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.getselect();\r\n    this.getList();\r\n    var options = {\r\n      width: \"99.5%\",\r\n      height: \"200px\",\r\n      themeType: \"simple\",\r\n      items: [\r\n        \"undo\",\r\n        \"redo\",\r\n        \"|\",\r\n        \"selectall\",\r\n        \"formatblock\",\r\n        \"fontname\",\r\n        \"fontsize\",\r\n        \"|\",\r\n        \"forecolor\",\r\n        \"hilitecolor\",\r\n        \"bold\",\r\n        \"italic\",\r\n        \"underline\",\r\n        \"strikethrough\",\r\n        \"lineheight\",\r\n        \"removeformat\",\r\n        \"|\",\r\n        \"preview\",\r\n        \"cut\",\r\n        \"copy\",\r\n        \"paste\",\r\n        \"plainpaste\",\r\n        \"|\",\r\n        \"justifyleft\",\r\n        \"justifycenter\",\r\n        \"justifyright\",\r\n        \"justifyfull\",\r\n        \"insertorderedlist\",\r\n        \"insertunorderedlist\",\r\n        \"indent\",\r\n        \"outdent\",\r\n        \"subscript\",\r\n        \"superscript\",\r\n        \"|\",\r\n        \"image\",\r\n        \"hr\",\r\n        \"code\"\r\n      ],\r\n\r\n      resizeType: 1,\r\n      newlineTag: \"br\",\r\n      imageTabIndex: 1,\r\n      uploadJson: \"/KnowledgesController/savePic\",\r\n      filePostName: \"file\",\r\n      allowImageUpload: true,\r\n      allowFileManager: false,\r\n      formatUploadUrl: true,\r\n      allowImageRemote: false,\r\n      afterUpload: function(url) {\r\n        //console.log(url)\r\n      }\r\n    };\r\n    var editor = new Array();\r\n    KindEditor.ready(function(K) {\r\n      editor[0] = K.create(\"#editor\", options);\r\n      editor[1] = K.create(\"#edit\", options);\r\n      editor[2] = K.create(\"#edito\", options);\r\n    });\r\n  },\r\n  methods: {\r\n    getselect() {\r\n      service\r\n        .getListGroupType()\r\n        .then(res => {\r\n          this.subjectGroupType = res.data;\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n      service\r\n        .getListType()\r\n        .then(res => {\r\n          this.weeklyType = res.data;\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n      service\r\n        .getListStaffType()\r\n        .then(res => {\r\n          this.staffType = res.data;\r\n          console.log(this.staffType);\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n      service\r\n        .getSubjectClass()\r\n        .then(res => {\r\n          this.subjectClass = res.data;\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    getList() {\r\n      let params = {\r\n        weeklyId: this.$route.query.id\r\n      };\r\n      console.log(params);\r\n      service\r\n        .getWeeklyDetailInfo(params)\r\n        .then(res => {\r\n          console.log(res);\r\n          // 将获取回来的数据赋值给list\r\n          this.editdetail = res.data;\r\n          console.log(this.editdetail);\r\n          (this.subjectName = this.$route.query.subjectName),\r\n            (this.staffname = this.$route.query.staffname);\r\n          this.staffID = this.$route.query.staffID;\r\n          this.editDetail = {\r\n            subjectName: this.subjectName,\r\n            staffname: this.staffname,\r\n            createStaffId: this.staffID,\r\n            keyWord: this.editdetail.keyWord,\r\n            staffType: this.editdetail.staffType,\r\n            subjectClass: this.editdetail.subjectClass,\r\n            subjectGroupType: this.editdetail.subjectGroupType,\r\n            weeklyType: this.editdetail.weeklyType\r\n          };\r\n          KindEditor.instances[0].html(this.editdetail.subjectNote),\r\n            KindEditor.instances[1].html(this.editdetail.weeklyDesc),\r\n            KindEditor.instances[2].html(this.editdetail.nextWeeklyDesc);\r\n          console.log(this.editDetail);\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    submitUpload(editDetail, filesList) {\r\n      this.$refs.upload.submit();\r\n      let params = {\r\n        weeklyId: this.$route.query.id,\r\n        cwlas: this.filesList\r\n      };\r\n      console.log(params);\r\n      service\r\n        .addWeekLyAttachyInfo(params)\r\n        .then(response => {})\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n    handleRemove(file, fileList) {\r\n      console.log(file, fileList);\r\n    },\r\n    handlePreview(file) {\r\n      console.log(file);\r\n    },\r\n    // 删除\r\n    deldetail() {\r\n      window.close();\r\n    },\r\n    //确认更新\r\n    update(editDetail, formName) {\r\n      let subjectNote = KindEditor.instances[0]\r\n        .html()\r\n        .split(\"\\n\")\r\n        .join(\"\");\r\n      console.log(subjectNote);\r\n      let weeklyDesc = KindEditor.instances[1]\r\n        .html()\r\n        .split(\"\\n\")\r\n        .join(\"\");\r\n      console.log(weeklyDesc);\r\n      let nextWeeklyDesc = KindEditor.instances[2]\r\n        .html()\r\n        .split(\"\\n\")\r\n        .join(\"\");\r\n      console.log(this.editDetail.subjectClass);\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          this.editDetail = {\r\n            weeklyId: this.$route.query.id,\r\n            subjectName: this.subjectName,\r\n            createStaffId: this.staffID,\r\n            subjectNote: subjectNote,\r\n            weeklyDesc: weeklyDesc,\r\n            nextWeeklyDesc: nextWeeklyDesc,\r\n            keyWord: this.editDetail.keyWord,\r\n            staffType: this.editDetail.staffType,\r\n            subjectClass: this.editDetail.subjectClass,\r\n            subjectGroupType: this.editDetail.subjectGroupType,\r\n            weeklyType: this.editDetail.weeklyType\r\n          };\r\n\r\n          let params = {\r\n            ckl: this.editDetail\r\n          };\r\n          console.log(params);\r\n          service\r\n            .updateWeeklyInfo(params)\r\n            .then(response => {\r\n              alert(\"修改成功\");\r\n              window.close();\r\n              // window.close();\r\n            })\r\n            .catch(error => {\r\n              console.log(error);\r\n            });\r\n          alert(\"submit!\");\r\n        } else {\r\n          return false;\r\n          this.$message(\"修改失败\");\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.main-ctn {\r\n  background: #f8f8f8;\r\n}\r\n.bg-purple {\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n}\r\n.main-content {\r\n  padding-top: 30px;\r\n}\r\n.el-form-item {\r\n  margin-top: 5px;\r\n}\r\n.main-content .dialog-footer {\r\n  margin: 0 auto;\r\n}\r\n.weekly-footer {\r\n  float: left;\r\n  margin-left: 40% !important;\r\n  margin-bottom: 20px !important;\r\n}\r\n.knowledge-content-editor {\r\n  width: 110%;\r\n}\r\n.updateweekly {\r\n  margin-top: 5px;\r\n  float: left;\r\n  font-weight: 400;\r\n  color: #66666f;\r\n}\r\n.selfile {\r\n  margin-left: 10px !important;\r\n}\r\n.upload-demo {\r\n  margin-left: 58px;\r\n  width: 80%;\r\n  padding-bottom: 20px;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// traineeExamineSys/views/weeklyModify.vue","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".main-ctn[data-v-b3b3d4de]{background:#f8f8f8}.bg-purple[data-v-b3b3d4de]{background:#fff;border-radius:8px}.main-content[data-v-b3b3d4de]{padding-top:30px}.el-form-item[data-v-b3b3d4de]{margin-top:5px}.main-content .dialog-footer[data-v-b3b3d4de]{margin:0 auto}.weekly-footer[data-v-b3b3d4de]{float:left;margin-left:40%!important;margin-bottom:20px!important}.knowledge-content-editor[data-v-b3b3d4de]{width:110%}.updateweekly[data-v-b3b3d4de]{margin-top:5px;float:left;font-weight:400;color:#66666f}.selfile[data-v-b3b3d4de]{margin-left:10px!important}.upload-demo[data-v-b3b3d4de]{margin-left:58px;width:80%;padding-bottom:20px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-b3b3d4de\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/weeklyModify.vue\n// module id = YKL+\n// module chunks = 1","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/kindeditor/themes/default/default.css\n// module id = iFdl\n// module chunks = 0 1 2 3 4"],"sourceRoot":""}