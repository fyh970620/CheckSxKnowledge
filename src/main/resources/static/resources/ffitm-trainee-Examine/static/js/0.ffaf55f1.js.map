{"version":3,"sources":["webpack:///resources/ffitm-trainee-Examine/static/js/0.ffaf55f1.js","webpack:///../node_modules/core-js/library/modules/es7.promise.try.js","webpack:///../node_modules/core-js/library/modules/_user-agent.js","webpack:///./traineeExamineSys/views/project.vue?44a9","webpack:///../node_modules/kindeditor/kindeditor-all.js","webpack:///../node_modules/core-js/library/modules/_promise-resolve.js","webpack:///../node_modules/core-js/library/modules/core.get-iterator-method.js","webpack:///../node_modules/core-js/library/modules/es6.promise.js","webpack:///../node_modules/core-js/library/fn/promise.js","webpack:///../node_modules/core-js/library/modules/_new-promise-capability.js","webpack:///../node_modules/core-js/library/modules/_species-constructor.js","webpack:///../node_modules/core-js/library/modules/_set-species.js","webpack:///../node_modules/core-js/library/modules/_microtask.js","webpack:///../node_modules/core-js/library/modules/_an-instance.js","webpack:///../node_modules/babel-runtime/core-js/promise.js","webpack:///../node_modules/core-js/library/modules/_iter-detect.js","webpack:///../node_modules/core-js/library/modules/_redefine-all.js","webpack:///traineeExamineSys/views/project.vue","webpack:///./traineeExamineSys/views/project.vue?62c2","webpack:///../node_modules/core-js/library/modules/_classof.js","webpack:///../node_modules/core-js/library/modules/_is-array-iter.js","webpack:///../node_modules/core-js/library/modules/_iter-call.js","webpack:///../node_modules/kindeditor/themes/default/default.css","webpack:///../node_modules/core-js/library/modules/_invoke.js","webpack:///../node_modules/core-js/library/modules/_perform.js","webpack:///../node_modules/core-js/library/modules/_for-of.js","webpack:///./traineeExamineSys/views/project.vue","webpack:///../node_modules/core-js/library/modules/_task.js","webpack:///../node_modules/core-js/library/modules/es7.promise.finally.js"],"names":["webpackJsonp","+CEt","module","exports","__webpack_require__","$export","newPromiseCapability","perform","S","try","callbackfn","promiseCapability","f","this","result","e","reject","resolve","v","promise","/cCi","global","navigator","userAgent","0Ot0","push","i","4uE9","window","undefined","_isArray","val","Object","prototype","toString","call","_isFunction","_inArray","arr","len","length","_each","obj","fn","key","hasOwnProperty","_trim","str","replace","_inString","delimiter","indexOf","_addUnit","unit","test","_removeUnit","match","exec","parseInt","_escape","_unescape","_toCamel","split","charAt","toUpperCase","substr","_toHex","hex","d","s","$0","$1","$2","$3","_toMap","map","_toArray","offset","Array","slice","_undef","defaultVal","_invalidUrl","url","_addParam","param","_extend","child","parent","proto","childProto","constructor","_json","text","cx","lastIndex","a","charCodeAt","eval","_getBasePath","src","els","document","getElementsByTagName","substring","lastIndexOf","_bindEvent","el","type","addEventListener","_useCapture","attachEvent","_unbindEvent","removeEventListener","detachEvent","KEvent","event","init","_getId","_eventExpendo","_setId","_eventId","_removeId","removeAttribute","_bind","id","_eventData","events","kevent","_unbind","splice","count","_fire","_ctrl","ctrlKey","which","shiftKey","altKey","stop","_ready","readyFunc","loaded","KindEditor","_readyFinished","ieReadyFunc","documentElement","doScroll","setTimeout","ieReadyStateFunc","readyState","toplevel","frameElement","_getCssList","css","list","reg","toLowerCase","_getAttrList","tag","_addClassToTag","className","_formatCss","_formatUrl","mode","host","pathname","getRealPath","path","parts","paths","part","pop","join","getRelativePath","depth","prefix","location","protocol","m","_formatHtml","html","htmlTags","urlType","wellFormatted","indentChar","fontSizeList","htmlTagMap","script","style","re","tagStack","$4","$5","$6","full","startNewline","startSlash","tagName","attr","endSlash","endNewline","_SINGLE_TAG_MAP","_INLINE_TAG_MAP","_PRE_TAG_MAP","_BLOCK_TAG_MAP","attrMap","fontStyleMap","fontStyle","color","_FILL_ATTR_MAP","styleMap","k","_clearMsWord","_mediaType","_mediaClass","_mediaAttrs","srcTag","unescape","_mediaEmbed","attrs","_mediaImg","blankPath","width","height","escape","_tmpl","data","Function","_contains","nodeA","nodeB","nodeType","parentNode","_getAttr","_GET_SET_ATTRIBUTE","nodeName","getAttribute","div","ownerDocument","createElement","appendChild","cloneNode","innerHTML","_queryAll","expr","root","stripslashes","cmpTag","tagA","tagB","byId","doc","getElementById","byClass","getElementsByClassName","querySelectorAll","cls","byName","name","getElementsByName","byAttr","select","matches","exprList","mergedResults","results","subResults","j","l","isChild","lenth","_query","_get","K","_getDoc","node","_getWin","parentWindow","defaultView","_setHtml","temp","removeChild","empty","each","_hasClass","_setAttr","_IE","_V","setAttribute","_removeAttr","_getNodeName","_computedCss","win","camelKey","getComputedStyle","getPropertyValue","currentStyle","_hasVal","_VALUE_TAG_MAP","_docElement","_QUIRKS","body","_docHeight","Math","max","scrollHeight","clientHeight","_docWidth","scrollWidth","clientWidth","_getScrollPos","x","y","_NEWIE","_OPERA","scrollLeft","scrollTop","scrollX","scrollY","KNode","_updateCollapsed","range","collapsed","startContainer","endContainer","startOffset","endOffset","_copyAndDelete","isCopy","isDelete","splitTextNode","centerNode","nodeValue","splitText","center","setStart","right","setEnd","nodeList","extractNodes","frag","nextNode","firstChild","testRange","KRange","selectNode","start","compareBoundaryPoints","_START_TO_END","incStart","_START_TO_START","incEnd","_END_TO_END","end","_END_TO_START","nextSibling","childFlag","textNode","copyRange","cloneRange","down","ancestor","commonAncestor","createDocumentFragment","up","collapse","_moveToElementText","knode","moveToElementText","_getStartEnd","rng","isStart","parentElement","pointRange","duplicate","nodes","childNodes","index","startNode","startPos","cmp","compareEndPoints","dummy","nodeRange","newNode","isControl","after","setEndPoint","remove","moveStart","lastChild","prevNode","previousSibling","_getEndRange","createTextRange","children","span","kchild","before","_toRange","tr2td","cells","_IERANGE","item","_range","mixed","_nativeCommand","execCommand","_nativeCommandValue","queryCommandValue","_getSel","selection","getSelection","_getRng","sel","rangeCount","getRangeAt","createRange","_singleKeyMap","newMap","_hasAttrOrCss","_hasAttrOrCssByKey","mapKey","method","_removeAttrOrCss","_removeAttrOrCssByKey","allFlag","removeAttr","_getInnerNode","inner","first","_isEmptyNode","isSingle","_mergeWrapper","b","clone","lastA","childA","merged","_mergeAttrs","append","_wrapNode","wrapper","replaceWith","nodeWrapper","next","styles","_inPreElement","hasClass","KCmd","_cmd","selectNodeContents","_drag","options","moveEl","moveFn","clickEl","beforeDrag","iframeFix","docs","_iframeDoc","pos","mousedown","moveListener","preventDefault","kdoc","target","diffX","_round","pageX","diffY","pageY","selectListener","upListener","unbind","self","releaseCapture","stopPropagation","get","mousemove","mouseup","bind","setCapture","KWidget","_widget","iframe","contentDocument","contentWindow","_getInitHtml","themesPath","bodyClass","cssPath","cssData","_direction","_elementVal","hasVal","KEdit","_edit","_selectToolbar","KToolbar","_toolbar","KMenu","_menu","KColorPicker","_colorpicker","KUploadButton","_uploadbutton","_createButton","arg","btn","click","KDialog","_dialog","_tabs","afterSelect","liList","addClass","ul","add","tab","li","title","selectedIndex","panel","show","removeClass","mouseover","mouseout","hide","_loadScript","head","charset","onload","onreadystatechange","_chopQuery","_loadStyle","link","absoluteUrl","links","href","rel","_ajax","dataType","xhr","XMLHttpRequest","ActiveXObject","open","status","responseText","params","encodeURIComponent","setRequestHeader","send","_plugin","_plugins","_parseLangKey","ns","_lang","langType","_language","_getImageFromRange","sc","so","_WEBKIT","img","_bindContextmenuEvent","edit","contextmenu","menu","hideMenu","useContextmenu","_contextmenus","maxWidth","items","cond","shift","prevItem","clientX","clientY","visibility","shadowMode","addItem","docEl","menuHeight","_bindNewlineEvent","getAncestorTagName","isStyle","newlineTag","_GECKO","brSkipTagMap","pSkipTagMap","keydown","cmd","insertHtml","keyup","p","_bindTabEvent","afterTab","shrink","insertNode","_bindFocusEvent","textarea","focus","afterFocus","blur","afterBlur","_removeBookmarkTag","_removeTempTag","_addBookmarkToStack","stack","bookmark","prev","_undoToRedo","fromStack","toStack","designMode","createBookmark","moveToBookmark","KEditor","setOption","se","srcElement","minWidth","minHeight","_MOBILE","_IOS","initContent","plugin","isCreated","_handlers","_undoStack","_redoStack","_firstAddBookmark","dialogs","_editor","_create","create","editor","basePath","langPath","pluginsPath","loadStyleMode","themeType","_instances","DEBUG","_TIME","_VERSION","_eachEditor","console","log","_ua","compatMode","_matches","Date","getTime","round","VERSION","IE","GECKO","WEBKIT","OPERA","V","TIME","isArray","isFunction","inArray","inString","trim","addUnit","removeUnit","toCamel","toHex","toMap","toArray","undef","invalidUrl","addParam","extend","json","_STYLE_TAG_MAP","_CONTROL_TAG_MAP","_NOSPLIT_TAG_MAP","_AUTOCLOSE_TAG_MAP","fullscreenMode","filterMode","wellFormatMode","resizeType","syncType","pasteType","dialogAlignType","fullscreenShortcut","minChangeSize","zIndex","noDisableItems","colorTable","fontSizeTable","font","table","td,th","embed","p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pre","hr","br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del","layout","_INPUT_KEY_MAP","_CURSORMOVE_KEY_MAP","_CHANGE_KEY_MAP","_EVENT_PROPS","relatedTarget","fromElement","toElement","clientLeft","clientTop","charCode","keyCode","metaKey","button","ev","returnValue","cancelBubble","ctrl","ready","formatUrl","formatHtml","getCssList","getAttrList","mediaType","mediaAttrs","mediaEmbed","mediaImg","clearMsWord","tmpl","_getSetAttrDiv","query","queryAll","fire","hasAttr","outer","eq","RegExp","innerText","textContent","value","offsetWidth","offsetHeight","opacity","filter","getBoundingClientRect","box","left","top","offsetLeft","offsetTop","offsetParent","bool","appendTo","insertBefore","replaceChild","keepChilds","_originDisplay","display","isInline","isBlock","contains","otherNode","last","sibling","scan","order","walk","n","_K","arguments","NodeClass","_BOOKMARK_ID","getParents","parents","parentA","parentB","parentsA","parentsB","lenA","lenB","setStartBefore","setStartAfter","setEndBefore","setEndAfter","toStart","how","rangeA","rangeB","nodeC","posA","posB","diff","cloneContents","deleteContents","extractContents","c","ec","eo","nodeCount","surroundContents","hasControlRange","createControlRange","addElement","downPos","upPos","enlarge","toBlock","enlargePos","serialize","endNode","dump","RangeClass","START_TO_START","START_TO_END","END_TO_END","END_TO_START","forceReset","hasDummy","hasU200b","ex","createTextNode","removeAllRanges","addRange","scrollTo","wrap","copyWrapper","tempRange","needSplit","dummyParent","ksc","kscp","sb","sa","startBefore","startDummy","endDummy","cmpStart","startAfter","endAfter","commonNode","find","cNode","state","queryCommandState","lc","h1,h2,h3,h4,h5,h6,p,div,pre,address","*","toggle","bold","strong","italic","em","underline","u","strikethrough","forecolor","hilitecolor","fontsize","fontname","fontfamily","removeformat","inserthtml","quickMode","outerHTML","pasteHTML","newRange","print","insertimage","border","align","createlink","setAttr","unlink","queryCommandSupported","CmdClass","z","_alignEl","alignEl","position","z-index","autoPos","autoScroll","scrollPos","updateProp","w","h","draggable","WidgetClass","widget","dir","isDocumentDomain","domain","write","close","afterChange","_mousedownHandler","disabled","contentEditable","afterCreate","beforeGetHtml","beforeSetHtml","afterSetHtml","srcScript","iframeSrc","tabIndex","isNaN","setWidth","setHeight","isFull","design","input","timeoutHandler","EditClass","iframeDoc","hover","disableMode","noDisableItemMap","_itemMap","unselect","enable","disable","disableAll","ToolbarClass","toolbar","centerLineMode","itemDiv","leftDiv","rightDiv","iconClass","centerDiv","checked","beforeRemove","MenuClass","colors","selectedColor","_cells","cellPadding","cellSpacing","row","insertRow","cell","insertCell","colSpan","_addAttr","noColor","ColorPickerClass","colorpicker","fieldName","extraParams","afterError","alert","hiddenElements","form","fileBox","submit","tempForm","reset","afterUpload","UploadButtonClass","uploadbutton","previewBtn","yesBtn","noBtn","closeBtn","showMask","contentDiv","iframeMask","headerDiv","closeIcon","bodyDiv","footerDiv","mask","docWidth","docHeight","isLoading","setMaskIndex","showLoading","msg","loading","hideLoading","DialogClass","dialog","tabs","loadScript","loadStyle","ajax","lang","loadPlugin","handler","clickToolbar","updateState","addContextmenu","initResize","statusbar","resize","overflow","container","toolbarDiv","editDiv","_scrollPos","_fullscreenExecuted","htmlList","menuName","editHeight","_docMousedownFn","addBookmark","readonlyMode","readonly","_fullscreenResizeHandler","hideDialog","fullHtml","isEmpty","isDirty","selectedHtml","changeFlag","apply","appendHtml","sync","checkSize","abs","undo","redo","fullscreen","isReadonly","createMenu","hideContextmenu","createDialog","firstDialog","parentDialog","errorDialog","EditorClass","instances","shortcutKeys","selectall","hasForm","resetBtn","blocks","heights","h1","h2","h3","H4","curVal","getSelectedLink","getSelectedImage","getSelectedFlash","getSelectedMedia","getSelectedAnchor","uName","getSelectedTable","getSelectedRow","getSelectedCell","movePastedData","pasting","white-space","imgAttrs","code","source","preview","cut","copy","paste","plainpaste","wordpaste","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","formatblock","image","multiimage","flash","media","tablecell","emoticons","about","filemanager","baidumap","lineheight","clearhtml","pagebreak","quickformat","insertfile","template","anchor","yes","no","editImage","deleteImage","editFlash","deleteFlash","editMedia","deleteMedia","editLink","deleteLink","editAnchor","deleteAnchor","tableprop","tablecellprop","tableinsert","tabledelete","tablecolinsertleft","tablecolinsertright","tablerowinsertabove","tablerowinsertbelow","tablerowmerge","tablecolmerge","tablerowsplit","tablecolsplit","tablecoldelete","tablerowdelete","pleaseSelectFile","invalidImg","invalidMedia","invalidWidth","invalidHeight","invalidBorder","invalidRows","invalidCols","invalidPadding","invalidSpacing","invalidJson","uploadSuccess","cutError","copyError","pasteError","ajaxLoading","uploadLoading","uploadError","plainpaste.comment","wordpaste.comment","code.pleaseInput","link.url","link.linkType","link.newWindow","link.selfWindow","flash.url","flash.width","flash.height","flash.upload","flash.viewServer","media.url","media.width","media.height","media.autostart","media.upload","media.viewServer","image.remoteImage","image.localImage","image.remoteUrl","image.localUrl","image.size","image.width","image.height","image.resetSize","image.align","image.defaultAlign","image.leftAlign","image.rightAlign","image.imgTitle","image.upload","image.viewServer","multiimage.uploadDesc","multiimage.startUpload","multiimage.clearAll","multiimage.insertAll","multiimage.queueLimitExceeded","multiimage.fileExceedsSizeLimit","multiimage.zeroByteFile","multiimage.invalidFiletype","multiimage.unknownError","multiimage.pending","multiimage.uploadError","filemanager.emptyFolder","filemanager.moveup","filemanager.viewType","filemanager.viewImage","filemanager.listImage","filemanager.orderType","filemanager.fileName","filemanager.fileSize","filemanager.fileType","insertfile.url","insertfile.title","insertfile.upload","insertfile.viewServer","table.cells","table.rows","table.cols","table.size","table.width","table.height","table.percent","table.px","table.space","table.padding","table.spacing","table.align","table.textAlign","table.verticalAlign","table.alignDefault","table.alignLeft","table.alignCenter","table.alignRight","table.alignTop","table.alignMiddle","table.alignBottom","table.alignBaseline","table.border","table.borderWidth","table.borderColor","table.backgroundColor","map.address","map.search","baidumap.address","baidumap.search","baidumap.insertDynamicMap","anchor.name","formatblock.formatBlock","h4","fontname.fontName","SimSun","NSimSun","FangSong_GB2312","KaiTi_GB2312","SimHei","Microsoft YaHei","Arial","Arial Black","Times New Roman","Courier New","Tahoma","Verdana","lineheight.lineHeight","1","1.5","2","2.5","3","template.selectTemplate","template.replaceContent","template.fileList","1.html","2.html","3.html","nameBox","delete","hideScroll","scroll","overflowY","resetHeight","autoHeightMode","mapWidth","mapHeight","address","search","insertDynamicMap","centerObj","getCenter","lng","lat","zoom","getZoom","checkbox","searchBtn","addressBox","geocoder","maptype","getMapTypeId","div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6","pleaseInput","emoticonsPath","allowPreview","allowPreviewEmoticons","currentPageNum","bindCellEvent","num","previewDiv","colsHalf","previewImg","createEmoticonsTable","pageNum","parentDiv","elements","startNum","rows","cols","removeEvent","bindPageEvent","pageDiv","wrapperDiv","createPageTable","pages","ceil","floor","makeFileTitle","filename","filesize","datetime","bindTitle","is_dir","fileManagerJson","imgPath","filemanagerDialog","reloadPage","func","dirName","bindEvent","createFunc","fileUrl","current_url","dirPath","current_dir_path","orderTypeBox","is_photo","clickFn","elList","createCommon","changeFunc","viewTypeBox","createView","createList","moveupLink","moveup_dir_path","change","fileList","file_list","iconUrl","cell0","has_file","emptyFolder","photoDiv","viewType","moveup","viewImage","listImage","orderType","fileName","fileSize","fileType","allowFlashUpload","allowFileManager","formatUploadUrl","extraFileUploadParams","filePostName","uploadJson","upload","viewServer","urlBox","widthBox","heightBox","quality","viewServerBtn","error","message","afterSelectFile","allowImageUpload","allowImageRemote","imageTabIndex","fillDescAfterUploadImage","imageDialog","setSize","originalWidth","originalHeight","showRemote","imageUrl","imageWidth","imageHeight","imageTitle","imageAlign","showLocal","remoteUrl","size","resetSize","imgTitle","localUrl","dialogWidth","dialogHeight","localUrlBox","titleBox","alignBox","refreshBtn","remoteImage","localImage","tempImg","allowFileUpload","fileDialog","fileTitle","lineHeight","linkType","typeBox","Option","newWindow","selfWindow","allowMediaUpload","autostart","autostartBox","loop","KSWFUpload","showError","progressbars","uploadDesc","startButtonValue","settings","debug","upload_url","uploadUrl","flash_url","flashUrl","file_post_name","button_placeholder","button_image_url","buttonImageUrl","button_width","buttonWidth","button_height","buttonHeight","button_cursor","SWFUpload","CURSOR","HAND","file_types","fileTypes","file_types_description","fileTypesDesc","file_upload_limit","fileUploadLimit","file_size_limit","fileSizeLimit","post_params","postParams","file_queued_handler","file","fileIconUrl","appendFile","file_queue_error_handler","errorCode","errorName","QUEUE_ERROR","QUEUE_LIMIT_EXCEEDED","queueLimitExceeded","FILE_EXCEEDS_SIZE_LIMIT","fileExceedsSizeLimit","ZERO_BYTE_FILE","zeroByteFile","INVALID_FILETYPE","invalidFiletype","unknownError","upload_start_handler","upload_progress_handler","bytesLoaded","bytesTotal","percent","progressbar","bar","upload_error_handler","filestatus","FILE_STATUS","ERROR","errorMessage","upload_success_handler","serverData","swfu","startUpload","getUrlList","COMPLETE","removeFile","fileId","cancelUpload","removeFiles","statusDiv","pendingMessage","destroy","swfupload","element","imageSizeLimit","imageUploadLimit","imageFileTypes","multiImageDialog","uploadLimit","sizeLimit","insertAll","clearAll","pending","urlList","initSWFUpload","customSettings","eventQueue","movieName","movieCount","movieElement","initSettings","loadFlash","displayDebugInfo","version","UPLOAD_ERROR","HTTP_ERROR","MISSING_UPLOAD_URL","IO_ERROR","SECURITY_ERROR","UPLOAD_LIMIT_EXCEEDED","UPLOAD_FAILED","SPECIFIED_FILE_ID_NOT_FOUND","FILE_VALIDATION_FAILED","FILE_CANCELLED","UPLOAD_STOPPED","QUEUED","IN_PROGRESS","CANCELLED","BUTTON_ACTION","SELECT_FILE","SELECT_FILES","START_UPLOAD","ARROW","WINDOW_MODE","WINDOW","TRANSPARENT","OPAQUE","completeURL","indexSlash","hostname","port","ensureDefault","settingName","defaultValue","debug_enabled","return_upload_start_handler","returnUploadStart","debugMessage","custom_settings","prevent_swf_caching","preserve_relative_urls","targetElement","tempParent","button_placeholder_id","getFlashHTML","getMovieElement","classid","button_window_mode","getFlashVars","paramString","buildParamString","httpSuccessString","http_success","use_query_string","requeue_on_error","assume_success_timeout","file_queue_limit","button_text","button_text_top_padding","button_text_left_padding","button_text_style","button_action","button_disabled","paramStringPairs","ex1","ex2","swfupload_loaded_handler","file_dialog_start_handler","upload_complete_handler","debug_handler","addSetting","default_value","getSetting","callFlash","functionName","argumentArray","returnString","CallFunction","__flash__argumentsToXML","post","unescapeFilePostParams","selectFile","selectFiles","fileID","triggerErrorEvent","stopUpload","getStats","setStats","statsObject","getFile","addFileParam","removeFileParam","setUploadURL","setPostParams","paramsObject","addPostParam","removePostParam","setFileTypes","types","description","setFileSizeLimit","setFileUploadLimit","setFileQueueLimit","fileQueueLimit","setFilePostName","setUseQueryString","useQueryString","setRequeueOnError","requeueOnError","setHTTPSuccess","http_status_codes","setAssumeSuccessTimeout","timeout_seconds","setDebugEnabled","debugEnabled","setButtonImageURL","buttonImageURL","setButtonDimensions","movie","setButtonText","setButtonTextPadding","setButtonTextStyle","setButtonDisabled","isDisabled","setButtonAction","buttonAction","setButtonCursor","cursor","queueEvent","handlerName","executeNextEvent","uk","unescapedPost","String","fromCharCode","testExternalInterface","flashReady","cleanUp","instance","flashEx","fileDialogStart","fileQueued","fileQueueError","fileDialogComplete","numFilesSelected","numFilesQueued","numFilesInQueue","uploadStart","uploadProgress","bytesComplete","responseReceived","uploadComplete","exceptionMessage","exceptionValues","Console","writeLine","documentForm","fontFamily","margin","queue","oldInitSettings","queueSettings","queue_cancelled_flag","queue_upload_count","user_upload_complete_handler","user_upload_start_handler","uploadCompleteHandler","uploadStartHandler","queue_complete_handler","cancelQueue","stats","files_queued","pagebreakHtml","tail","comment","getFirstChild","blockMap","subList","_setColor","_initColorPicker","dialogDiv","colorBox","removePicker","pickerList","picker","_getCellIndex","rowSpanCount","rowSpan","cellIndex","prop","isInsert","px","space","padding","spacing","alignDefault","alignLeft","alignCenter","alignRight","borderWidth","borderColor","backgroundColor","rowsBox","colsBox","widthType","widthTypeBox","heightType","heightTypeBox","paddingBox","spacingBox","borderBox","bgColor","tableWidth","tableHeight","cellprop","textAlign","verticalAlign","alignTop","alignMiddle","alignBottom","alignBaseline","textAlignBox","verticalAlignBox","background-color","text-align","vertical-align","border-width","border-style","border-color","cellWidth","cellHeight","insert","colinsert","newRow","newCell","colinsertleft","colinsertright","rowinsert","rowIndex","rowinsertabove","rowinsertbelow","rowmerge","nextRowIndex","nextRow","nextCell","deleteCell","colmerge","nextCellIndex","rowsplit","colsplit","coldelete","rowdelete","deleteRow","getFilePath","htmlPath","selectTemplate","replaceContent","selectBox","5Czc","anObject","isObject","C","7AqT","classof","ITERATOR","Iterators","getIteratorMethod","it","9kJF","Internal","newGenericPromiseCapability","OwnPromiseCapability","Wrapper","LIBRARY","ctx","aFunction","anInstance","forOf","speciesConstructor","task","set","microtask","newPromiseCapabilityModule","promiseResolve","TypeError","process","versions","v8","$Promise","isNode","USE_NATIVE","FakePromise","PromiseRejectionEvent","then","isThenable","notify","isReject","_n","chain","_c","_v","ok","_s","reaction","exited","fail","_h","onHandleUnhandled","enter","exit","onUnhandled","unhandled","isUnhandled","emit","onunhandledrejection","reason","_a","onrejectionhandled","$reject","_d","_w","$resolve","executor","err","onFulfilled","onRejected","catch","G","W","F","Promise","r","capability","$$reject","iter","all","iterable","values","remaining","$index","alreadyCalled","race","9u1Q","AIlg","PromiseCapability","$$resolve","B1ls","SPECIES","O","D","FGzK","core","dP","DESCRIPTORS","KEY","configurable","H109","macrotask","Observer","MutationObserver","WebKitMutationObserver","flush","nextTick","standalone","observe","characterData","KUik","Constructor","forbiddenField","L3Vt","default","__esModule","Lli7","SAFE_CLOSING","riter","from","skipClosing","safe","done","O6kh","TasP","_interopRequireDefault","defineProperty","_promise","_promise2","_service","_service2","activeIndex","subjectId","subjectName","addDetail","subjectType","subjectGroupType","editDetail","filesList","attachName","attachRemark","subjecttype","dialogVisible","dialogFormVisible","newsList","newsLists","multipleSelection","rules","required","trigger","subjectTime","subjectDest","mounted","getAllList","getselect","methods","dialogToggle","_this","initEdit","showdetail","_this2","getProjectDetail","res","editorHeight","_this3","getListGroupType","getListType","_this4","addProject","formName","_this5","subjectRemark","$refs","validate","valid","csl","cslas","addTogether","response","deleteProject","_this6","$confirm","_","delOneCheckSubject","_this7","update","_this8","subjectRemarks","getUpdate","submitUpload","csla","addAttachInfo","handleRemove","handlePreview","WcYe","content","locals","ZHvQ","cof","TAG","ARG","tryGet","T","B","callee","aee4","__webpack_exports__","render","_vm","$createElement","_self","staticClass","on","default-active","_l","$event","slot","gutter","knowGroupTypeValue","knowTypeValue","domProps","visible","update:visible","ref","label-position","labelPosition","inline","label-width","model","label","placeholder","callback","$$v","expression","typeId","typeValue","staticStyle","action","on-remove","file-list","auto-upload","margin-left","staticRenderFns","esExports","af0K","ArrayProto","hEIm","iterator","entries","ret","iFdl","kX4D","o4G5","args","that","un","ozpD","isArrayIter","toLength","getIterFn","BREAK","RETURN","step","iterFn","tleg","injectStyle","ssrContext","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue___default","__WEBPACK_IMPORT_KEY__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_f5af96ae_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_project_vue__","normalizeComponent","__vue_styles__","Component","uzcO","defer","channel","invoke","cel","setTask","setImmediate","clearTask","clearImmediate","MessageChannel","Dispatch","counter","run","listener","now","port2","port1","onmessage","postMessage","importScripts","clear","zaru","P","R","finally","onFinally"],"mappings":"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","file":"resources/ffitm-trainee-Examine/static/js/0.ffaf55f1.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ \"+CEt\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// https://github.com/tc39/proposal-promise-try\nvar $export = __webpack_require__(\"vSO4\");\nvar newPromiseCapability = __webpack_require__(\"AIlg\");\nvar perform = __webpack_require__(\"kX4D\");\n\n$export($export.S, 'Promise', { 'try': function (callbackfn) {\n  var promiseCapability = newPromiseCapability.f(this);\n  var result = perform(callbackfn);\n  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);\n  return promiseCapability.promise;\n} });\n\n\n/***/ }),\n\n/***/ \"/cCi\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(\"i1Q6\");\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n\n\n/***/ }),\n\n/***/ \"0Ot0\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"lcwS\")(false);\n// imports\n\n\n// module\nexports.push([module.i, \".project[data-v-f5af96ae]{position:absolute;top:0;bottom:0;left:0;right:0;min-width:1150px}.el-menu-item[data-v-f5af96ae],.el-submenu .el-menu-item[data-v-f5af96ae],.el-submenu__title[data-v-f5af96ae]{height:40px!important;line-height:40px!important;color:#666!important;font-size:14px}.el-aside>div>ul[data-v-f5af96ae],.el-aside>div[data-v-f5af96ae]{height:100%}.el-menu-item.is-active[data-v-f5af96ae]{color:#666!important;border-right:3px solid #1890ff;background-color:#e6f7ff}.select-project button[data-v-f5af96ae]{background:#008cd5;border:0;cursor:pointer;padding:9px 18px;border-radius:3px;color:#fff;margin:20px 44px}.del-project[data-v-f5af96ae]{color:red;cursor:pointer}.edit-project[data-v-f5af96ae]{color:#008cd5;cursor:pointer}.dialog-footer[data-v-f5af96ae]{margin-top:20px!important;margin-right:40%!important;margin-bottom:20px!important}.bg-purple[data-v-f5af96ae]{background:#fff}.grid-content[data-v-f5af96ae]{border-radius:4px;color:#333}.article-header[data-v-f5af96ae]{color:#333;padding:20px 40px 0 30px}.article-title[data-v-f5af96ae]{font-size:24px}.article-info[data-v-f5af96ae]{color:#a1a1a1;font-size:12px;margin:15px 0}.article-info span[data-v-f5af96ae]{margin-right:10px}.article-info-left[data-v-f5af96ae]{float:left}.article-info-right[data-v-f5af96ae]{float:right}.article-content[data-v-f5af96ae]{color:#666;padding:0 40px 14px 30px}.know-article[data-v-f5af96ae]{padding:15px 0;font-size:14px;margin-bottom:20px}.know-articles[data-v-f5af96ae]{padding-bottom:20px}.article-attachs[data-v-f5af96ae]{padding-top:15px;border-top:1px solid #eee}.updateweekly[data-v-f5af96ae]{margin-top:5px;float:left}.selfile[data-v-f5af96ae]{margin-left:10px!important}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"4uE9\":\n/***/ (function(module, exports) {\n\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n/***/ }),\n\n/***/ \"5Czc\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar anObject = __webpack_require__(\"zotD\");\nvar isObject = __webpack_require__(\"BxvP\");\nvar newPromiseCapability = __webpack_require__(\"AIlg\");\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n\n\n/***/ }),\n\n/***/ \"7AqT\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar classof = __webpack_require__(\"ZHvQ\");\nvar ITERATOR = __webpack_require__(\"Ug9I\")('iterator');\nvar Iterators = __webpack_require__(\"dhak\");\nmodule.exports = __webpack_require__(\"zKeE\").getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n\n\n/***/ }),\n\n/***/ \"9kJF\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar LIBRARY = __webpack_require__(\"1kq3\");\nvar global = __webpack_require__(\"i1Q6\");\nvar ctx = __webpack_require__(\"3zRh\");\nvar classof = __webpack_require__(\"ZHvQ\");\nvar $export = __webpack_require__(\"vSO4\");\nvar isObject = __webpack_require__(\"BxvP\");\nvar aFunction = __webpack_require__(\"g31e\");\nvar anInstance = __webpack_require__(\"KUik\");\nvar forOf = __webpack_require__(\"ozpD\");\nvar speciesConstructor = __webpack_require__(\"B1ls\");\nvar task = __webpack_require__(\"uzcO\").set;\nvar microtask = __webpack_require__(\"H109\")();\nvar newPromiseCapabilityModule = __webpack_require__(\"AIlg\");\nvar perform = __webpack_require__(\"kX4D\");\nvar userAgent = __webpack_require__(\"/cCi\");\nvar promiseResolve = __webpack_require__(\"5Czc\");\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[__webpack_require__(\"Ug9I\")('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = __webpack_require__(\"O6kh\")($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\n__webpack_require__(\"11Ut\")($Promise, PROMISE);\n__webpack_require__(\"FGzK\")(PROMISE);\nWrapper = __webpack_require__(\"zKeE\")[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && __webpack_require__(\"Lli7\")(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n\n\n/***/ }),\n\n/***/ \"9u1Q\":\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(\"tuDi\");\n__webpack_require__(\"i+u+\");\n__webpack_require__(\"COf8\");\n__webpack_require__(\"9kJF\");\n__webpack_require__(\"zaru\");\n__webpack_require__(\"+CEt\");\nmodule.exports = __webpack_require__(\"zKeE\").Promise;\n\n\n/***/ }),\n\n/***/ \"AIlg\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = __webpack_require__(\"g31e\");\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n\n\n/***/ }),\n\n/***/ \"B1ls\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = __webpack_require__(\"zotD\");\nvar aFunction = __webpack_require__(\"g31e\");\nvar SPECIES = __webpack_require__(\"Ug9I\")('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n\n\n/***/ }),\n\n/***/ \"FGzK\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar global = __webpack_require__(\"i1Q6\");\nvar core = __webpack_require__(\"zKeE\");\nvar dP = __webpack_require__(\"Gfzd\");\nvar DESCRIPTORS = __webpack_require__(\"6MLN\");\nvar SPECIES = __webpack_require__(\"Ug9I\")('species');\n\nmodule.exports = function (KEY) {\n  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n\n\n/***/ }),\n\n/***/ \"H109\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(\"i1Q6\");\nvar macrotask = __webpack_require__(\"uzcO\").set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = __webpack_require__(\"ShN9\")(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n\n\n/***/ }),\n\n/***/ \"KUik\":\n/***/ (function(module, exports) {\n\nmodule.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n\n\n/***/ }),\n\n/***/ \"L3Vt\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = { \"default\": __webpack_require__(\"9u1Q\"), __esModule: true };\n\n/***/ }),\n\n/***/ \"Lli7\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar ITERATOR = __webpack_require__(\"Ug9I\")('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n\n\n/***/ }),\n\n/***/ \"O6kh\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar hide = __webpack_require__(\"akPY\");\nmodule.exports = function (target, src, safe) {\n  for (var key in src) {\n    if (safe && target[key]) target[key] = src[key];\n    else hide(target, key, src[key]);\n  } return target;\n};\n\n\n/***/ }),\n\n/***/ \"TasP\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _promise = __webpack_require__(\"L3Vt\");\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _service = __webpack_require__(\"CxL4\");\n\nvar _service2 = _interopRequireDefault(_service);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(\"4uE9\"); //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n__webpack_require__(\"iFdl\");\nexports.default = {\n  name: \"table1\",\n  data: function data() {\n    return {\n      activeIndex: 8,\n      list: [{\n        subjectId: 1,\n        subjectName: \"课题一\"\n      }, {\n        subjectId: 2,\n        subjectName: \"课题二\"\n      }, {\n        subjectId: 3,\n        subjectName: \"课题三\"\n      }, {\n        subjectId: 4,\n        subjectName: \"课题四\"\n      }],\n      addDetail: {\n        subjectType: \"\",\n        subjectGroupType: \"\"\n      },\n      editDetail: {},\n      filesList: [{\n        attachName: \"附件三\",\n        attachRemark: \"www.baidu.com\"\n      }, {\n        attachName: \"附件四\",\n        attachRemark: \"www.baidu.com\"\n      }],\n      subjecttype: [],\n      index: 0,\n      dialogVisible: false,\n      dialogFormVisible: false,\n      newsList: {},\n      newsLists: {},\n      fileList: [{\n        attachName: \"\",\n        attachRemark: \"\"\n      }, {\n        attachName: \"\",\n        attachRemark: \"\"\n      }],\n      //多选值\n      multipleSelection: [],\n      rules: {\n        subjectGroupType: [{\n          required: true,\n          message: \"请选择归属组\",\n          trigger: \"blur\"\n        }],\n        subjectName: [{\n          required: true,\n          message: \"请输入课题名称\",\n          trigger: \"blur\"\n        }],\n        subjectTime: [{\n          required: true,\n          message: \"请输入学习天数\",\n          trigger: \"blur\"\n        }, {\n          type: \"number\",\n          message: \"学习天数必须为数字值\"\n        }],\n        subjectDest: [{\n          required: true,\n          message: \"请输入学习目标\",\n          trigger: \"blur\"\n        }],\n        subjectType: [{\n          required: true,\n          message: \"请选择技能类型\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n\n  mounted: function mounted() {\n    this.getAllList();\n    this.getselect();\n  },\n  methods: {\n    dialogToggle: function dialogToggle() {\n      var _this = this;\n\n      new _promise2.default(function (resolve, reject) {\n        _this.dialogFormVisible = true;\n        resolve(\"success\");\n      }).then(function () {\n        _this.initEdit();\n      });\n    },\n\n    //展示详情\n    showdetail: function showdetail(item) {\n      var _this2 = this;\n\n      var params = {\n        subjectId: item.subjectId\n      };\n      console.log(params);\n      _service2.default.getProjectDetail(params).then(function (res) {\n        console.log(res);\n        // 将获取回来的数据赋值给list\n        _this2.newsList = res.data;\n        console.log(_this2.newsList);\n        _this2.editDetail = {\n          subjectName: _this2.newsList.subjectName,\n          subjectTime: _this2.newsList.subjectTime,\n          subjectType: _this2.newsList.subjectType,\n          subjectGroupType: _this2.newsList.subjectGroupType,\n          subjectDest: _this2.newsList.subjectDest\n        };\n        console.log(_this2.editDetail);\n      }).catch(function (err) {\n        console.log(err);\n      });\n      console.log(item.subjectId);\n    },\n    initEdit: function initEdit() {\n      KindEditor.create(\"#editor\", {\n        width: \"90%\",\n        height: this.editorHeight + \"px\",\n        themeType: \"simple\",\n        items: [\"undo\", \"redo\", \"|\", \"selectall\", \"formatblock\", \"fontname\", \"fontsize\", \"|\", \"forecolor\", \"hilitecolor\", \"bold\", \"italic\", \"underline\", \"strikethrough\", \"lineheight\", \"removeformat\", \"|\", \"preview\", \"cut\", \"copy\", \"paste\", \"plainpaste\", \"|\", \"justifyleft\", \"justifycenter\", \"justifyright\", \"justifyfull\", \"insertorderedlist\", \"insertunorderedlist\", \"indent\", \"outdent\", \"subscript\", \"superscript\", \"|\", \"image\", \"hr\", \"code\"],\n        resizeType: \"\",\n        newlineTag: \"br\",\n        imageTabIndex: 1,\n        uploadJson: \"/KnowledgesController/savePic\",\n        filePostName: \"file\",\n        allowImageUpload: true,\n        allowFileManager: false,\n        formatUploadUrl: true,\n        allowImageRemote: false,\n        afterUpload: function afterUpload(url) {\n          //console.log(url)\n        }\n      });\n      KindEditor.create(\"#edit\", {\n        width: \"90%\",\n        height: this.editorHeight + \"px\",\n        themeType: \"simple\",\n        items: [\"undo\", \"redo\", \"|\", \"selectall\", \"formatblock\", \"fontname\", \"fontsize\", \"|\", \"forecolor\", \"hilitecolor\", \"bold\", \"italic\", \"underline\", \"strikethrough\", \"lineheight\", \"removeformat\", \"|\", \"preview\", \"cut\", \"copy\", \"paste\", \"plainpaste\", \"|\", \"justifyleft\", \"justifycenter\", \"justifyright\", \"justifyfull\", \"insertorderedlist\", \"insertunorderedlist\", \"indent\", \"outdent\", \"subscript\", \"superscript\", \"|\", \"image\", \"hr\", \"code\"],\n        resizeType: 1,\n        newlineTag: \"br\",\n        imageTabIndex: 1,\n        uploadJson: \"/KnowledgesController/savePic\",\n        filePostName: \"file\",\n        allowImageUpload: true,\n        allowFileManager: false,\n        formatUploadUrl: true,\n        allowImageRemote: false,\n        afterUpload: function afterUpload(url) {\n          //console.log(url)\n        }\n      });\n    },\n    getselect: function getselect() {\n      var _this3 = this;\n\n      _service2.default.getListGroupType().then(function (res) {\n        _this3.subjectGroupType = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n      _service2.default.getListType().then(function (res) {\n        _this3.subjectType = res.data;\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n\n    //课题名称\n    getAllList: function getAllList() {\n      var _this4 = this;\n\n      _service2.default.getAllList().then(function (res) {\n        console.log(res);\n        // 将获取回来的数据赋值给list\n        _this4.newsLists = res.data;\n        console.log(_this4.newsLists);\n        _this4.newsList = _this4.newsLists[0];\n        // (this.activeIndex = this.newsList.subjectId),\n        console.log(_this4.activeIndex);\n        _this4.editDetail = {\n          subjectName: _this4.newsList.subjectName,\n          subjectTime: _this4.newsList.subjectTime,\n          subjectType: _this4.newsList.subjectType,\n          subjectGroupType: _this4.newsList.subjectGroupType,\n          subjectDest: _this4.newsList.subjectDest\n        };\n        console.log(_this4.editDetail);\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n\n    //新增\n    addProject: function addProject(formName, fileList) {\n      var _this5 = this;\n\n      var subjectRemark = KindEditor.instances[0].html().split(\"\\n\").join(\"\");\n      console.log(subjectRemark);\n      this.$refs[\"formName\"].validate(function (valid) {\n        if (valid) {\n          _this5.addDetail = {\n            subjectRemark: subjectRemark,\n            subjectName: _this5.addDetail.subjectName,\n            subjectTime: _this5.addDetail.subjectTime,\n            subjectType: _this5.addDetail.subjectType,\n            subjectGroupType: _this5.addDetail.subjectGroupType,\n            subjectDest: _this5.addDetail.subjectDest\n          };\n          var params = {\n            csl: _this5.addDetail,\n            cslas: _this5.fileList\n          };\n          console.log(params);\n          _service2.default.addTogether(params).then(function (response) {\n            alert(\"submit!\");\n            _this5.getAllList();\n          }).catch(function (error) {\n            console.log(error);\n          });\n          _this5.dialogFormVisible = false;\n        } else {\n          return false;\n        }\n      });\n    },\n\n    //删除\n    deleteProject: function deleteProject() {\n      var _this6 = this;\n\n      this.$confirm(\"确认删除？\").then(function (_) {\n        var params = {\n          subjectId: _this6.newsList.subjectId\n        };\n        console.log(params);\n        _service2.default.delOneCheckSubject(params).then(function (response) {\n          console.log(response);\n          // 加载列表\n          _this6.getAllList();\n        }).catch(function (error) {\n          console.log(error);\n        });\n      }).catch(function (_) {});\n    },\n\n    //编辑\n    edit: function edit() {\n      var _this7 = this;\n\n      new _promise2.default(function (resolve, reject) {\n        _this7.dialogVisible = true;\n        resolve(\"success\");\n      }).then(function () {\n        _this7.initEdit();\n        KindEditor.instances[0].html(_this7.newsList.subjectRemark);\n        console.log(_this7.newsList.subjectRemark);\n      });\n    },\n\n    //确认更新\n    update: function update(subjectId, formName) {\n      var _this8 = this;\n\n      var subjectRemarks = KindEditor.instances[0].html().split(\"\\n\").join(\"\");\n      console.log(subjectRemarks);\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          _this8.editDetail = {\n            subjectId: _this8.newsList.subjectId,\n            subjectRemark: subjectRemarks,\n            subjectName: _this8.editDetail.subjectName,\n            subjectTime: _this8.editDetail.subjectTime,\n            subjectType: _this8.editDetail.subjectType,\n            subjectGroupType: _this8.editDetail.subjectGroupType,\n            subjectDest: _this8.editDetail.subjectDest\n          };\n          var params = {\n            csl: _this8.editDetail\n          };\n          console.log(params);\n          _service2.default.getUpdate(params).then(function (response) {\n            _this8.showdetail();\n          }).catch(function (error) {\n            console.log(error);\n          });\n          _this8.dialogVisible = false;\n          alert(\"submit!\");\n        } else {\n          return false;\n        }\n      });\n    },\n    submitUpload: function submitUpload(editDetail, filesList) {\n      this.$refs.upload.submit();\n      var params = {\n        subjectId: this.editDetail.subjectId,\n        csla: this.filesList\n      };\n      console.log(params);\n      _service2.default.addAttachInfo(params).then(function (response) {}).catch(function (error) {\n        console.log(error);\n      });\n    },\n    handleRemove: function handleRemove(file, fileList) {\n      console.log(file, fileList);\n    },\n    handlePreview: function handlePreview(file) {\n      console.log(file);\n    }\n  }\n};\n\n/***/ }),\n\n/***/ \"WcYe\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"0Ot0\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"X/Wc\")(\"2d9a7d22\", content, true, {});\n\n/***/ }),\n\n/***/ \"ZHvQ\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = __webpack_require__(\"ShN9\");\nvar TAG = __webpack_require__(\"Ug9I\")('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n/***/ }),\n\n/***/ \"aee4\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',{staticClass:\"project\"},[_c('el-aside',{staticClass:\"select-project\",attrs:{\"width\":\"200px\"}},[_c('button',{on:{\"click\":_vm.dialogToggle}},[_vm._v(\"新增课题\")]),_vm._v(\" \"),_c('el-menu',{attrs:{\"default-active\":0}},_vm._l((_vm.newsLists),function(item,index){return _c('el-menu-item',{key:index,attrs:{\"index\":index},on:{\"click\":function($event){_vm.showdetail(item)}}},[_c('span',{slot:\"title\"},[_vm._v(_vm._s(item.subjectName))])])}))],1),_vm._v(\" \"),_c('el-main',[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"grid-content bg-purple\"},[_c('div',{staticClass:\"article-header\"},[_c('div',{staticClass:\"article-title\"},[_vm._v(_vm._s(_vm.newsList.subjectName))]),_vm._v(\" \"),_c('div',{staticClass:\"article-info clearfix\"},[_c('div',{staticClass:\"article-info-left\"},[_c('span',[_vm._v(\"学习天数：\"+_vm._s(_vm.newsList.subjectTime)+\"天\")]),_c('span',[_vm._v(\"|\")]),_vm._v(\" \"),_c('span',[_vm._v(\"技能分类：\"+_vm._s(_vm.newsList.knowGroupTypeValue))]),_c('span',[_vm._v(\"|\")]),_vm._v(\" \"),_c('span',[_vm._v(\"技能类型：\"+_vm._s(_vm.newsList.knowTypeValue))])]),_vm._v(\" \"),_c('div',{staticClass:\"article-info-right\"},[_c('span',{staticClass:\"edit-project\",on:{\"click\":function($event){_vm.edit()}}},[_c('i',{staticClass:\"fa fa-edit\"}),_vm._v(\" 编辑\")]),_c('span',[_vm._v(\"|\")]),_vm._v(\" \"),_c('span',{staticClass:\"del-project\",on:{\"click\":function($event){_vm.deleteProject() }}},[_c('i',{staticClass:\"fa fa-trash-o\"}),_vm._v(\" 删除\")])])])]),_vm._v(\" \"),_c('div',{staticClass:\"article-content\"},[_c('div',{staticClass:\"know-article\"},[_c('div',{staticClass:\"know-articles\"},[_vm._v(\"学习目标：\"),_c('br'),_vm._v(\" \"),_c('p',[_vm._v(_vm._s(_vm.newsList.subjectDest))])]),_vm._v(\" \"),_c('div',{staticClass:\"know-articles\",domProps:{\"innerHTML\":_vm._s('技能描述：'+'<br>'+'<p>'+this.newsList.subjectRemark+'</p>')}})]),_vm._v(\" \"),_c('div',{staticClass:\"article-attachs\"},[_c('span',{staticClass:\"tag-name\"},[_vm._v(\"附件：无\")])])])])])],1)],1),_vm._v(\" \"),_c('el-dialog',{staticClass:\"main-content\",attrs:{\"title\":\"新增\",\"visible\":_vm.dialogFormVisible,\"size\":\"mini\",\"width\":\"70%\"},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"150px\",\"rules\":_vm.rules,\"model\":_vm.addDetail,\"size\":\"mini\"}},[_c('el-form-item',{attrs:{\"label\":\"课题名称\",\"prop\":\"subjectName\"}},[_c('el-input',{attrs:{\"placeholder\":\"课题名称\",\"name\":\"subjectName\"},model:{value:(_vm.addDetail.subjectName),callback:function ($$v) {_vm.addDetail.subjectName=$$v},expression:\"addDetail.subjectName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"学习天数\",\"prop\":\"subjectTime\"}},[_c('el-input',{attrs:{\"placeholder\":\"学习天数\",\"name\":\"subjectTime\"},model:{value:(_vm.addDetail.subjectTime),callback:function ($$v) {_vm.addDetail.subjectTime=_vm._n($$v)},expression:\"addDetail.subjectTime\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"学习目标\",\"prop\":\"subjectDest\"}},[_c('el-input',{attrs:{\"placeholder\":\"学习目标\",\"name\":\"subjectDest\"},model:{value:(_vm.addDetail.subjectDest),callback:function ($$v) {_vm.addDetail.subjectDest=$$v},expression:\"addDetail.subjectDest\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"技能类型\",\"prop\":\"subjectType\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择技能类型\"},model:{value:(_vm.addDetail.subjectType),callback:function ($$v) {_vm.addDetail.subjectType=$$v},expression:\"addDetail.subjectType\"}},_vm._l((_vm.subjectType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"subjectGroupType\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.addDetail.subjectGroupType),callback:function ($$v) {_vm.addDetail.subjectGroupType=$$v},expression:\"addDetail.subjectGroupType\"}},_vm._l((_vm.subjectGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))],1),_vm._v(\" \"),_c('el-form-item',{staticClass:\"subjectledge-content-editor\",staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"技能描述\",\"prop\":\"subjectRemark\"}},[_c('div',{staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"editor\"}})])]),_vm._v(\" \"),_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo clearfix\",attrs:{\"action\":\"www.baidu.com\",\"on-remove\":_vm.handleRemove,\"file-list\":_vm.fileList,\"auto-upload\":false}},[_c('div',{staticClass:\"updateweekly\"},[_vm._v(\"上传周报附件\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"selfile\",attrs:{\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取文件\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":_vm.submitUpload}},[_vm._v(\"上传到服务器\")])],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){_vm.addProject(_vm.addDetail,'formName',_vm.fileList)}}},[_vm._v(\"新增\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){_vm.dialogFormVisible= false}}},[_vm._v(\"取消\")])],1)],1),_vm._v(\" \"),_c('el-dialog',{staticClass:\"main-content\",attrs:{\"title\":\"编辑\",\"visible\":_vm.dialogVisible,\"width\":\"70%\",\"size\":\"mini\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"formName\",attrs:{\"label-position\":_vm.labelPosition,\"inline\":true,\"label-width\":\"130px\",\"rules\":_vm.rules,\"model\":_vm.editDetail,\"size\":\"mini\"}},[_c('el-form-item',{attrs:{\"label\":\"课题名称\",\"prop\":\"subjectName\"}},[_c('el-input',{attrs:{\"placeholder\":\"课题名称\",\"name\":\"subjectName\"},model:{value:(_vm.editDetail.subjectName),callback:function ($$v) {_vm.editDetail.subjectName=$$v},expression:\"editDetail.subjectName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"学习天数\",\"prop\":\"subjectTime\"}},[_c('el-input',{attrs:{\"placeholder\":\"学习天数\",\"name\":\"subjectTime\"},model:{value:(_vm.editDetail.subjectTime),callback:function ($$v) {_vm.editDetail.subjectTime=_vm._n($$v)},expression:\"editDetail.subjectTime\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"学习目标\",\"prop\":\"subjectDest\"}},[_c('el-input',{attrs:{\"placeholder\":\"学习目标\",\"name\":\"subjectDest\"},model:{value:(_vm.editDetail.subjectDest),callback:function ($$v) {_vm.editDetail.subjectDest=$$v},expression:\"editDetail.subjectDest\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"技能类型\",\"prop\":\"subjectType\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择技能类型\"},model:{value:(_vm.editDetail.subjectType),callback:function ($$v) {_vm.editDetail.subjectType=$$v},expression:\"editDetail.subjectType\"}},_vm._l((_vm.subjectType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"归属组\",\"prop\":\"subjectGroupType\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择您的归属组\"},model:{value:(_vm.editDetail.subjectGroupType),callback:function ($$v) {_vm.editDetail.subjectGroupType=$$v},expression:\"editDetail.subjectGroupType\"}},_vm._l((_vm.subjectGroupType),function(item){return _c('el-option',{key:item.typeId,attrs:{\"label\":item.typeValue,\"value\":item.typeId}})}))],1),_vm._v(\" \"),_c('el-form-item',{staticClass:\"subjectledge-content-editors\",staticStyle:{\"height\":\"calc(100% - 200px)\"},attrs:{\"label\":\"技能描述\",\"prop\":\"subjectRemarks\"}},[_c('div',{staticStyle:{\"height\":\"100%\"}},[_c('textarea',{attrs:{\"name\":\"editor\",\"id\":\"edit\"}})])]),_vm._v(\" \"),_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo clearfix\",attrs:{\"action\":\"www.baidu.com\",\"on-remove\":_vm.handleRemove,\"file-list\":_vm.fileList,\"auto-upload\":false}},[_c('div',{staticClass:\"updateweekly\"},[_vm._v(\"上传周报附件\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"selfile\",attrs:{\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取文件\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":function($event){_vm.submitUpload(_vm.editDetail, _vm.filesList)}}},[_vm._v(\"上传到服务器\")])],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){_vm.update(_vm.editDetail,'formName',_vm.filesList)}}},[_vm._v(\"更新\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取消\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n\n/***/ \"af0K\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// check on default Array iterator\nvar Iterators = __webpack_require__(\"dhak\");\nvar ITERATOR = __webpack_require__(\"Ug9I\")('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n\n\n/***/ }),\n\n/***/ \"hEIm\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// call something on iterator step with safe closing on error\nvar anObject = __webpack_require__(\"zotD\");\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n/***/ }),\n\n/***/ \"iFdl\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"kX4D\":\n/***/ (function(module, exports) {\n\nmodule.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n\n\n/***/ }),\n\n/***/ \"o4G5\":\n/***/ (function(module, exports) {\n\n// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n\n\n/***/ }),\n\n/***/ \"ozpD\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar ctx = __webpack_require__(\"3zRh\");\nvar call = __webpack_require__(\"hEIm\");\nvar isArrayIter = __webpack_require__(\"af0K\");\nvar anObject = __webpack_require__(\"zotD\");\nvar toLength = __webpack_require__(\"S7IM\");\nvar getIterFn = __webpack_require__(\"7AqT\");\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n\n\n/***/ }),\n\n/***/ \"tleg\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue__ = __webpack_require__(\"TasP\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue__);\n/* harmony namespace reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue__[key]; }) }(__WEBPACK_IMPORT_KEY__));\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_f5af96ae_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_project_vue__ = __webpack_require__(\"aee4\");\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"WcYe\")\n}\nvar normalizeComponent = __webpack_require__(\"/4AN\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-f5af96ae\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_project_vue___default.a,\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_f5af96ae_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_project_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"uzcO\":\n/***/ (function(module, exports, __webpack_require__) {\n\nvar ctx = __webpack_require__(\"3zRh\");\nvar invoke = __webpack_require__(\"o4G5\");\nvar html = __webpack_require__(\"ebIA\");\nvar cel = __webpack_require__(\"9kxq\");\nvar global = __webpack_require__(\"i1Q6\");\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (__webpack_require__(\"ShN9\")(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n\n\n/***/ }),\n\n/***/ \"zaru\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n// https://github.com/tc39/proposal-promise-finally\n\nvar $export = __webpack_require__(\"vSO4\");\nvar core = __webpack_require__(\"zKeE\");\nvar global = __webpack_require__(\"i1Q6\");\nvar speciesConstructor = __webpack_require__(\"B1ls\");\nvar promiseResolve = __webpack_require__(\"5Czc\");\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// resources/ffitm-trainee-Examine/static/js/0.ffaf55f1.js","'use strict';\n// https://github.com/tc39/proposal-promise-try\nvar $export = require('./_export');\nvar newPromiseCapability = require('./_new-promise-capability');\nvar perform = require('./_perform');\n\n$export($export.S, 'Promise', { 'try': function (callbackfn) {\n  var promiseCapability = newPromiseCapability.f(this);\n  var result = perform(callbackfn);\n  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);\n  return promiseCapability.promise;\n} });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/es7.promise.try.js\n// module id = +CEt\n// module chunks = 0","var global = require('./_global');\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_user-agent.js\n// module id = /cCi\n// module chunks = 0","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".project[data-v-f5af96ae]{position:absolute;top:0;bottom:0;left:0;right:0;min-width:1150px}.el-menu-item[data-v-f5af96ae],.el-submenu .el-menu-item[data-v-f5af96ae],.el-submenu__title[data-v-f5af96ae]{height:40px!important;line-height:40px!important;color:#666!important;font-size:14px}.el-aside>div>ul[data-v-f5af96ae],.el-aside>div[data-v-f5af96ae]{height:100%}.el-menu-item.is-active[data-v-f5af96ae]{color:#666!important;border-right:3px solid #1890ff;background-color:#e6f7ff}.select-project button[data-v-f5af96ae]{background:#008cd5;border:0;cursor:pointer;padding:9px 18px;border-radius:3px;color:#fff;margin:20px 44px}.del-project[data-v-f5af96ae]{color:red;cursor:pointer}.edit-project[data-v-f5af96ae]{color:#008cd5;cursor:pointer}.dialog-footer[data-v-f5af96ae]{margin-top:20px!important;margin-right:40%!important;margin-bottom:20px!important}.bg-purple[data-v-f5af96ae]{background:#fff}.grid-content[data-v-f5af96ae]{border-radius:4px;color:#333}.article-header[data-v-f5af96ae]{color:#333;padding:20px 40px 0 30px}.article-title[data-v-f5af96ae]{font-size:24px}.article-info[data-v-f5af96ae]{color:#a1a1a1;font-size:12px;margin:15px 0}.article-info span[data-v-f5af96ae]{margin-right:10px}.article-info-left[data-v-f5af96ae]{float:left}.article-info-right[data-v-f5af96ae]{float:right}.article-content[data-v-f5af96ae]{color:#666;padding:0 40px 14px 30px}.know-article[data-v-f5af96ae]{padding:15px 0;font-size:14px;margin-bottom:20px}.know-articles[data-v-f5af96ae]{padding-bottom:20px}.article-attachs[data-v-f5af96ae]{padding-top:15px;border-top:1px solid #eee}.updateweekly[data-v-f5af96ae]{margin-top:5px;float:left}.selfile[data-v-f5af96ae]{margin-left:10px!important}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-f5af96ae\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/project.vue\n// module id = 0Ot0\n// module chunks = 0","/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2014 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @website http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n* @version 4.1.10 (2014-06-10)\r\n*******************************************************************************/\r\n(function (window, undefined) {\r\n\tif (window.KindEditor) {\r\n\t\treturn;\r\n\t}\r\n\r\n\r\nif (!window.console) {\r\n\twindow.console = {};\r\n}\r\nif (!console.log) {\r\n\tconsole.log = function () {};\r\n}\r\nvar _VERSION = '4.1.10 (2014-06-10)',\r\n\t_ua = navigator.userAgent.toLowerCase(),\r\n\t_IE = _ua.indexOf('msie') > -1 && _ua.indexOf('opera') == -1,\r\n\t_NEWIE = _ua.indexOf('msie') == -1 && _ua.indexOf('trident') > -1,\r\n\t_GECKO = _ua.indexOf('gecko') > -1 && _ua.indexOf('khtml') == -1,\r\n\t_WEBKIT = _ua.indexOf('applewebkit') > -1,\r\n\t_OPERA = _ua.indexOf('opera') > -1,\r\n\t_MOBILE = _ua.indexOf('mobile') > -1,\r\n\t_IOS = /ipad|iphone|ipod/.test(_ua),\r\n\t_QUIRKS = document.compatMode != 'CSS1Compat',\r\n\t_IERANGE = !window.getSelection,\r\n\t_matches = /(?:msie|firefox|webkit|opera)[\\/:\\s](\\d+)/.exec(_ua),\r\n\t_V = _matches ? _matches[1] : '0',\r\n\t_TIME = new Date().getTime();\r\nfunction _isArray(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Array]';\r\n}\r\nfunction _isFunction(val) {\r\n\tif (!val) {\r\n\t\treturn false;\r\n\t}\r\n\treturn Object.prototype.toString.call(val) === '[object Function]';\r\n}\r\nfunction _inArray(val, arr) {\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tif (val === arr[i]) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\nfunction _each(obj, fn) {\r\n\tif (_isArray(obj)) {\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tif (fn.call(obj[i], i, obj[i]) === false) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tif (fn.call(obj[key], key, obj[key]) === false) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction _trim(str) {\r\n\treturn str.replace(/(?:^[ \\t\\n\\r]+)|(?:[ \\t\\n\\r]+$)/g, '');\r\n}\r\nfunction _inString(val, str, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\treturn (delimiter + str + delimiter).indexOf(delimiter + val + delimiter) >= 0;\r\n}\r\nfunction _addUnit(val, unit) {\r\n\tunit = unit || 'px';\r\n\treturn val && /^\\d+$/.test(val) ? val + unit : val;\r\n}\r\nfunction _removeUnit(val) {\r\n\tvar match;\r\n\treturn val && (match = /(\\d+)/.exec(val)) ? parseInt(match[1], 10) : 0;\r\n}\r\nfunction _escape(val) {\r\n\treturn val.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n}\r\nfunction _unescape(val) {\r\n\treturn val.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&amp;/g, '&');\r\n}\r\nfunction _toCamel(str) {\r\n\tvar arr = str.split('-');\r\n\tstr = '';\r\n\t_each(arr, function(key, val) {\r\n\t\tstr += (key > 0) ? val.charAt(0).toUpperCase() + val.substr(1) : val;\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _toHex(val) {\r\n\tfunction hex(d) {\r\n\t\tvar s = parseInt(d, 10).toString(16).toUpperCase();\r\n\t\treturn s.length > 1 ? s : '0' + s;\r\n\t}\r\n\treturn val.replace(/rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/ig,\r\n\t\tfunction($0, $1, $2, $3) {\r\n\t\t\treturn '#' + hex($1) + hex($2) + hex($3);\r\n\t\t}\r\n\t);\r\n}\r\nfunction _toMap(val, delimiter) {\r\n\tdelimiter = delimiter === undefined ? ',' : delimiter;\r\n\tvar map = {}, arr = _isArray(val) ? val : val.split(delimiter), match;\r\n\t_each(arr, function(key, val) {\r\n\t\tif ((match = /^(\\d+)\\.\\.(\\d+)$/.exec(val))) {\r\n\t\t\tfor (var i = parseInt(match[1], 10); i <= parseInt(match[2], 10); i++) {\r\n\t\t\t\tmap[i.toString()] = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmap[val] = true;\r\n\t\t}\r\n\t});\r\n\treturn map;\r\n}\r\nfunction _toArray(obj, offset) {\r\n\treturn Array.prototype.slice.call(obj, offset || 0);\r\n}\r\nfunction _undef(val, defaultVal) {\r\n\treturn val === undefined ? defaultVal : val;\r\n}\r\nfunction _invalidUrl(url) {\r\n\treturn !url || /[<>\"]/.test(url);\r\n}\r\nfunction _addParam(url, param) {\r\n\treturn url.indexOf('?') >= 0 ? url + '&' + param : url + '?' + param;\r\n}\r\nfunction _extend(child, parent, proto) {\r\n\tif (!proto) {\r\n\t\tproto = parent;\r\n\t\tparent = null;\r\n\t}\r\n\tvar childProto;\r\n\tif (parent) {\r\n\t\tvar fn = function () {};\r\n\t\tfn.prototype = parent.prototype;\r\n\t\tchildProto = new fn();\r\n\t\t_each(proto, function(key, val) {\r\n\t\t\tchildProto[key] = val;\r\n\t\t});\r\n\t} else {\r\n\t\tchildProto = proto;\r\n\t}\r\n\tchildProto.constructor = child;\r\n\tchild.prototype = childProto;\r\n\tchild.parent = parent ? parent.prototype : null;\r\n}\r\n\r\r\nfunction _json(text) {\r\n\tvar match;\r\n\tif ((match = /\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\]/.exec(text))) {\r\n\t\ttext = match[0];\r\n\t}\r\n\tvar cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\r\n\tcx.lastIndex = 0;\r\n\tif (cx.test(text)) {\r\n\t\ttext = text.replace(cx, function (a) {\r\n\t\t\treturn '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\r\n\t\t});\r\n\t}\r\n\tif (/^[\\],:{}\\s]*$/.\r\n\ttest(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').\r\n\treplace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\r\n\treplace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\r\n\t\treturn eval('(' + text + ')');\r\n\t}\r\n\tthrow 'JSON parse error';\r\n}\r\nvar _round = Math.round;\r\nvar K = {\r\n\tDEBUG : false,\r\n\tVERSION : _VERSION,\r\n\tIE : _IE,\r\n\tGECKO : _GECKO,\r\n\tWEBKIT : _WEBKIT,\r\n\tOPERA : _OPERA,\r\n\tV : _V,\r\n\tTIME : _TIME,\r\n\teach : _each,\r\n\tisArray : _isArray,\r\n\tisFunction : _isFunction,\r\n\tinArray : _inArray,\r\n\tinString : _inString,\r\n\ttrim : _trim,\r\n\taddUnit : _addUnit,\r\n\tremoveUnit : _removeUnit,\r\n\tescape : _escape,\r\n\tunescape : _unescape,\r\n\ttoCamel : _toCamel,\r\n\ttoHex : _toHex,\r\n\ttoMap : _toMap,\r\n\ttoArray : _toArray,\r\n\tundef : _undef,\r\n\tinvalidUrl : _invalidUrl,\r\n\taddParam : _addParam,\r\n\textend : _extend,\r\n\tjson : _json\r\n};\r\nvar _INLINE_TAG_MAP = _toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),\r\n\t_BLOCK_TAG_MAP = _toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),\r\n\t_SINGLE_TAG_MAP = _toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),\r\n\t_STYLE_TAG_MAP = _toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),\r\n\t_CONTROL_TAG_MAP = _toMap('img,table,input,textarea,button'),\r\n\t_PRE_TAG_MAP = _toMap('pre,style,script'),\r\n\t_NOSPLIT_TAG_MAP = _toMap('html,head,body,td,tr,table,ol,ul,li'),\r\n\t_AUTOCLOSE_TAG_MAP = _toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),\r\n\t_FILL_ATTR_MAP = _toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),\r\n\t_VALUE_TAG_MAP = _toMap('input,button,textarea,select');\r\n\r\n\r\nfunction _getBasePath() {\r\n\tvar els = document.getElementsByTagName('script'), src;\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tsrc = els[i].src || '';\r\n\t\tif (/kindeditor[\\w\\-\\.]*\\.js/.test(src)) {\r\n\t\t\treturn src.substring(0, src.lastIndexOf('/') + 1);\r\n\t\t}\r\n\t}\r\n\treturn '';\r\n}\r\nK.basePath = _getBasePath();\r\nK.options = {\r\n\tdesignMode : true,\r\n\tfullscreenMode : false,\r\n\tfilterMode : true,\r\n\twellFormatMode : true,\r\n\tshadowMode : true,\r\n\tloadStyleMode : true,\r\n\tbasePath : K.basePath,\r\n\tthemesPath : K.basePath + 'themes/',\r\n\tlangPath : K.basePath + 'lang/',\r\n\tpluginsPath : K.basePath + 'plugins/',\r\n\tthemeType : 'default',\r\n\tlangType : 'zh-CN',\r\n\turlType : '',\r\n\tnewlineTag : 'p',\r\n\tresizeType : 2,\r\n\tsyncType : 'form',\r\n\tpasteType : 2,\r\n\tdialogAlignType : 'page',\r\n\tuseContextmenu : true,\r\n\tfullscreenShortcut : false,\r\n\tbodyClass : 'ke-content',\r\n\tindentChar : '\\t',\r\n\tcssPath : '',\r\n\tcssData : '',\r\n\tminWidth : 650,\r\n\tminHeight : 100,\r\n\tminChangeSize : 50,\r\n\tzIndex : 811213,\r\n\titems : [\r\n\t\t'source', '|', 'undo', 'redo', '|', 'preview', 'print', 'template', 'code', 'cut', 'copy', 'paste',\r\n\t\t'plainpaste', 'wordpaste', '|', 'justifyleft', 'justifycenter', 'justifyright',\r\n\t\t'justifyfull', 'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent', 'subscript',\r\n\t\t'superscript', 'clearhtml', 'quickformat', 'selectall', '|', 'fullscreen', '/',\r\n\t\t'formatblock', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold',\r\n\t\t'italic', 'underline', 'strikethrough', 'lineheight', 'removeformat', '|', 'image', 'multiimage',\r\n\t\t'flash', 'media', 'insertfile', 'table', 'hr', 'emoticons', 'baidumap', 'pagebreak',\r\n\t\t'anchor', 'link', 'unlink', '|', 'about'\r\n\t],\r\n\tnoDisableItems : ['source', 'fullscreen'],\r\n\tcolorTable : [\r\n\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t],\r\n\tfontSizeTable : ['9px', '10px', '12px', '14px', '16px', '18px', '24px', '32px'],\r\n\thtmlTags : {\r\n\t\tfont : ['id', 'class', 'color', 'size', 'face', '.background-color'],\r\n\t\tspan : [\r\n\t\t\t'id', 'class', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.line-height'\r\n\t\t],\r\n\t\tdiv : [\r\n\t\t\t'id', 'class', 'align', '.border', '.margin', '.padding', '.text-align', '.color',\r\n\t\t\t'.background-color', '.font-size', '.font-family', '.font-weight', '.background',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.margin-left'\r\n\t\t],\r\n\t\ttable: [\r\n\t\t\t'id', 'class', 'border', 'cellspacing', 'cellpadding', 'width', 'height', 'align', 'bordercolor',\r\n\t\t\t'.padding', '.margin', '.border', 'bgcolor', '.text-align', '.color', '.background-color',\r\n\t\t\t'.font-size', '.font-family', '.font-weight', '.font-style', '.text-decoration', '.background',\r\n\t\t\t'.width', '.height', '.border-collapse'\r\n\t\t],\r\n\t\t'td,th': [\r\n\t\t\t'id', 'class', 'align', 'valign', 'width', 'height', 'colspan', 'rowspan', 'bgcolor',\r\n\t\t\t'.text-align', '.color', '.background-color', '.font-size', '.font-family', '.font-weight',\r\n\t\t\t'.font-style', '.text-decoration', '.vertical-align', '.background', '.border'\r\n\t\t],\r\n\t\ta : ['id', 'class', 'href', 'target', 'name'],\r\n\t\tembed : ['id', 'class', 'src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\timg : ['id', 'class', 'src', 'width', 'height', 'border', 'alt', 'title', 'align', '.width', '.height', '.border'],\r\n\t\t'p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : [\r\n\t\t\t'id', 'class', 'align', '.text-align', '.color', '.background-color', '.font-size', '.font-family', '.background',\r\n\t\t\t'.font-weight', '.font-style', '.text-decoration', '.vertical-align', '.text-indent', '.margin-left'\r\n\t\t],\r\n\t\tpre : ['id', 'class'],\r\n\t\thr : ['id', 'class', '.page-break-after'],\r\n\t\t'br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del' : ['id', 'class'],\r\n\t\tiframe : ['id', 'class', 'src', 'frameborder', 'width', 'height', '.width', '.height']\r\n\t},\r\n\tlayout : '<div class=\"container\"><div class=\"toolbar\"></div><div class=\"edit\"></div><div class=\"statusbar\"></div></div>'\r\n};\r\n\r\n\r\nvar _useCapture = false;\r\n\r\r\nvar _INPUT_KEY_MAP = _toMap('8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222');\r\r\nvar _CURSORMOVE_KEY_MAP = _toMap('33..40');\r\r\nvar _CHANGE_KEY_MAP = {};\r\n_each(_INPUT_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n_each(_CURSORMOVE_KEY_MAP, function(key, val) {\r\n\t_CHANGE_KEY_MAP[key] = val;\r\n});\r\n\r\r\nfunction _bindEvent(el, type, fn) {\r\n\tif (el.addEventListener){\r\n\t\tel.addEventListener(type, fn, _useCapture);\r\n\t} else if (el.attachEvent){\r\n\t\tel.attachEvent('on' + type, fn);\r\n\t}\r\n}\r\r\nfunction _unbindEvent(el, type, fn) {\r\n\tif (el.removeEventListener){\r\n\t\tel.removeEventListener(type, fn, _useCapture);\r\n\t} else if (el.detachEvent){\r\n\t\tel.detachEvent('on' + type, fn);\r\n\t}\r\n}\r\nvar _EVENT_PROPS = ('altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,' +\r\n\t'data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,' +\r\n\t'pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which').split(',');\r\n\r\r\nfunction KEvent(el, event) {\r\n\tthis.init(el, event);\r\n}\r\n_extend(KEvent, {\r\n\tinit : function(el, event) {\r\n\t\tvar self = this, doc = el.ownerDocument || el.document || el;\r\n\t\tself.event = event;\r\n\t\t_each(_EVENT_PROPS, function(key, val) {\r\n\t\t\tself[val] = event[val];\r\n\t\t});\r\n\t\tif (!self.target) {\r\n\t\t\tself.target = self.srcElement || doc;\r\n\t\t}\r\n\t\tif (self.target.nodeType === 3) {\r\n\t\t\tself.target = self.target.parentNode;\r\n\t\t}\r\n\t\tif (!self.relatedTarget && self.fromElement) {\r\n\t\t\tself.relatedTarget = self.fromElement === self.target ? self.toElement : self.fromElement;\r\n\t\t}\r\n\t\tif (self.pageX == null && self.clientX != null) {\r\n\t\t\tvar d = doc.documentElement, body = doc.body;\r\n\t\t\tself.pageX = self.clientX + (d && d.scrollLeft || body && body.scrollLeft || 0) - (d && d.clientLeft || body && body.clientLeft || 0);\r\n\t\t\tself.pageY = self.clientY + (d && d.scrollTop  || body && body.scrollTop  || 0) - (d && d.clientTop  || body && body.clientTop  || 0);\r\n\t\t}\r\n\t\tif (!self.which && ((self.charCode || self.charCode === 0) ? self.charCode : self.keyCode)) {\r\n\t\t\tself.which = self.charCode || self.keyCode;\r\n\t\t}\r\n\t\tif (!self.metaKey && self.ctrlKey) {\r\n\t\t\tself.metaKey = self.ctrlKey;\r\n\t\t}\r\n\t\tif (!self.which && self.button !== undefined) {\r\n\t\t\tself.which = (self.button & 1 ? 1 : (self.button & 2 ? 3 : (self.button & 4 ? 2 : 0)));\r\n\t\t}\r\n\t\tswitch (self.which) {\r\n\t\tcase 186 :\r\n\t\t\tself.which = 59;\r\n\t\t\tbreak;\r\n\t\tcase 187 :\r\n\t\tcase 107 :\r\n\t\tcase 43 :\r\n\t\t\tself.which = 61;\r\n\t\t\tbreak;\r\n\t\tcase 189 :\r\n\t\tcase 45 :\r\n\t\t\tself.which = 109;\r\n\t\t\tbreak;\r\n\t\tcase 42 :\r\n\t\t\tself.which = 106;\r\n\t\t\tbreak;\r\n\t\tcase 47 :\r\n\t\t\tself.which = 111;\r\n\t\t\tbreak;\r\n\t\tcase 78 :\r\n\t\t\tself.which = 110;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (self.which >= 96 && self.which <= 105) {\r\n\t\t\tself.which -= 48;\r\n\t\t}\r\n\t},\r\n\tpreventDefault : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.preventDefault) {\r\n\t\t\tev.preventDefault();\r\n\t\t} else {\r\n\t\t\tev.returnValue = false;\r\n\t\t}\r\n\t},\r\n\tstopPropagation : function() {\r\n\t\tvar ev = this.event;\r\n\t\tif (ev.stopPropagation) {\r\n\t\t\tev.stopPropagation();\r\n\t\t} else {\r\n\t\t\tev.cancelBubble = true;\r\n\t\t}\r\n\t},\r\n\tstop : function() {\r\n\t\tthis.preventDefault();\r\n\t\tthis.stopPropagation();\r\n\t}\r\n});\r\nvar _eventExpendo = 'kindeditor_' + _TIME, _eventId = 0, _eventData = {};\r\nfunction _getId(el) {\r\n\treturn el[_eventExpendo] || null;\r\n}\r\nfunction _setId(el) {\r\n\tel[_eventExpendo] = ++_eventId;\r\n\treturn _eventId;\r\n}\r\nfunction _removeId(el) {\r\n\ttry {\r\n\t\tdelete el[_eventExpendo];\r\n\t} catch(e) {\r\n\t\tif (el.removeAttribute) {\r\n\t\t\tel.removeAttribute(_eventExpendo);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _bind(el, type, fn) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_bind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\tid = _setId(el);\r\n\t}\r\n\tif (_eventData[id] === undefined) {\r\n\t\t_eventData[id] = {};\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\t_unbindEvent(el, type, events[0]);\r\n\t} else {\r\n\t\t_eventData[id][type] = [];\r\n\t\t_eventData[id].el = el;\r\n\t}\r\n\tevents = _eventData[id][type];\r\n\tif (events.length === 0) {\r\n\t\tevents[0] = function(e) {\r\n\t\t\tvar kevent = e ? new KEvent(el, e) : undefined;\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event) {\r\n\t\t\t\t\tevent.call(el, kevent);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\tif (_inArray(fn, events) < 0) {\r\n\t\tevents.push(fn);\r\n\t}\r\n\t_bindEvent(el, type, events[0]);\r\n}\r\nfunction _unbind(el, type, fn) {\r\n\tif (type && type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_unbind(el, this, fn);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tif (type === undefined) {\r\n\t\tif (id in _eventData) {\r\n\t\t\t_each(_eventData[id], function(key, events) {\r\n\t\t\t\tif (key != 'el' && events.length > 0) {\r\n\t\t\t\t\t_unbindEvent(el, key, events[0]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tif (!_eventData[id]) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (events && events.length > 0) {\r\n\t\tif (fn === undefined) {\r\n\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\tdelete _eventData[id][type];\r\n\t\t} else {\r\n\t\t\t_each(events, function(i, event) {\r\n\t\t\t\tif (i > 0 && event === fn) {\r\n\t\t\t\t\tevents.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (events.length == 1) {\r\n\t\t\t\t_unbindEvent(el, type, events[0]);\r\n\t\t\t\tdelete _eventData[id][type];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar count = 0;\r\n\t\t_each(_eventData[id], function() {\r\n\t\t\tcount++;\r\n\t\t});\r\n\t\tif (count < 2) {\r\n\t\t\tdelete _eventData[id];\r\n\t\t\t_removeId(el);\r\n\t\t}\r\n\t}\r\n}\r\nfunction _fire(el, type) {\r\n\tif (type.indexOf(',') >= 0) {\r\n\t\t_each(type.split(','), function() {\r\n\t\t\t_fire(el, this);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tvar id = _getId(el);\r\n\tif (!id) {\r\n\t\treturn;\r\n\t}\r\n\tvar events = _eventData[id][type];\r\n\tif (_eventData[id] && events && events.length > 0) {\r\n\t\tevents[0]();\r\n\t}\r\n}\r\nfunction _ctrl(el, key, fn) {\r\n\tvar self = this;\r\n\tkey = /^\\d{2,}$/.test(key) ? key : key.toUpperCase().charCodeAt(0);\r\n\t_bind(el, 'keydown', function(e) {\r\n\t\tif (e.ctrlKey && e.which == key && !e.shiftKey && !e.altKey) {\r\n\t\t\tfn.call(el);\r\n\t\t\te.stop();\r\n\t\t}\r\n\t});\r\n}\r\nvar _readyFinished = false;\r\nfunction _ready(fn) {\r\n\tif (_readyFinished) {\r\n\t\tfn(KindEditor);\r\n\t\treturn;\r\n\t}\r\n\tvar loaded = false;\r\n\tfunction readyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\tloaded = true;\r\n\t\t\tfn(KindEditor);\r\n\t\t\t_readyFinished = true;\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyFunc() {\r\n\t\tif (!loaded) {\r\n\t\t\ttry {\r\n\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t} catch(e) {\r\n\t\t\t\tsetTimeout(ieReadyFunc, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tfunction ieReadyStateFunc() {\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\treadyFunc();\r\n\t\t}\r\n\t}\r\n\tif (document.addEventListener) {\r\n\t\t_bind(document, 'DOMContentLoaded', readyFunc);\r\n\t} else if (document.attachEvent) {\r\n\t\t_bind(document, 'readystatechange', ieReadyStateFunc);\r\n\t\tvar toplevel = false;\r\n\t\ttry {\r\n\t\t\ttoplevel = window.frameElement == null;\r\n\t\t} catch(e) {}\r\n\t\tif (document.documentElement.doScroll && toplevel) {\r\n\t\t\tieReadyFunc();\r\n\t\t}\r\n\t}\r\n\t_bind(window, 'load', readyFunc);\r\n}\r\nif (window.attachEvent) {\r\n\twindow.attachEvent('onunload', function() {\r\n\t\t_each(_eventData, function(key, events) {\r\n\t\t\tif (events.el) {\r\n\t\t\t\t_unbind(events.el);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.ctrl = _ctrl;\r\nK.ready = _ready;\r\n\r\nfunction _getCssList(css) {\r\n\tvar list = {},\r\n\t\treg = /\\s*([\\w\\-]+)\\s*:([^;]*)(;|$)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(css))) {\r\n\t\tvar key = _trim(match[1].toLowerCase()),\r\n\t\t\tval = _trim(_toHex(match[2]));\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _getAttrList(tag) {\r\n\tvar list = {},\r\n\t\treg = /\\s+(?:([\\w\\-:]+)|(?:([\\w\\-:]+)=([^\\s\"'<>]+))|(?:([\\w\\-:\"]+)=\"([^\"]*)\")|(?:([\\w\\-:\"]+)='([^']*)'))(?=(?:\\s|\\/|>)+)/g,\r\n\t\tmatch;\r\n\twhile ((match = reg.exec(tag))) {\r\n\t\tvar key = (match[1] || match[2] || match[4] || match[6]).toLowerCase(),\r\n\t\t\tval = (match[2] ? match[3] : (match[4] ? match[5] : match[7])) || '';\r\n\t\tlist[key] = val;\r\n\t}\r\n\treturn list;\r\n}\r\nfunction _addClassToTag(tag, className) {\r\n\tif (/\\s+class\\s*=/.test(tag)) {\r\n\t\ttag = tag.replace(/(\\s+class=[\"']?)([^\"']*)([\"']?[\\s>])/, function($0, $1, $2, $3) {\r\n\t\t\tif ((' ' + $2 + ' ').indexOf(' ' + className + ' ') < 0) {\r\n\t\t\t\treturn $2 === '' ? $1 + className + $3 : $1 + $2 + ' ' + className + $3;\r\n\t\t\t} else {\r\n\t\t\t\treturn $0;\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\ttag = tag.substr(0, tag.length - 1) + ' class=\"' + className + '\">';\r\n\t}\r\n\treturn tag;\r\n}\r\nfunction _formatCss(css) {\r\n\tvar str = '';\r\n\t_each(_getCssList(css), function(key, val) {\r\n\t\tstr += key + ':' + val + ';';\r\n\t});\r\n\treturn str;\r\n}\r\nfunction _formatUrl(url, mode, host, pathname) {\r\n\tmode = _undef(mode, '').toLowerCase();\r\n\tif (url.substr(0, 5) != 'data:') {\r\n\t\turl = url.replace(/([^:])\\/\\//g, '$1/');\r\n\t}\r\n\tif (_inArray(mode, ['absolute', 'relative', 'domain']) < 0) {\r\n\t\treturn url;\r\n\t}\r\n\thost = host || location.protocol + '//' + location.host;\r\n\tif (pathname === undefined) {\r\n\t\tvar m = location.pathname.match(/^(\\/.*)\\//);\r\n\t\tpathname = m ? m[1] : '';\r\n\t}\r\n\tvar match;\r\n\tif ((match = /^(\\w+:\\/\\/[^\\/]*)/.exec(url))) {\r\n\t\tif (match[1] !== host) {\r\n\t\t\treturn url;\r\n\t\t}\r\n\t} else if (/^\\w+:/.test(url)) {\r\n\t\treturn url;\r\n\t}\r\n\tfunction getRealPath(path) {\r\n\t\tvar parts = path.split('/'), paths = [];\r\n\t\tfor (var i = 0, len = parts.length; i < len; i++) {\r\n\t\t\tvar part = parts[i];\r\n\t\t\tif (part == '..') {\r\n\t\t\t\tif (paths.length > 0) {\r\n\t\t\t\t\tpaths.pop();\r\n\t\t\t\t}\r\n\t\t\t} else if (part !== '' && part != '.') {\r\n\t\t\t\tpaths.push(part);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '/' + paths.join('/');\r\n\t}\r\n\tif (/^\\//.test(url)) {\r\n\t\turl = host + getRealPath(url.substr(1));\r\n\t} else if (!/^\\w+:\\/\\//.test(url)) {\r\n\t\turl = host + getRealPath(pathname + '/' + url);\r\n\t}\r\n\tfunction getRelativePath(path, depth) {\r\n\t\tif (url.substr(0, path.length) === path) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < depth; i++) {\r\n\t\t\t\tarr.push('..');\r\n\t\t\t}\r\n\t\t\tvar prefix = '.';\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tprefix += '/' + arr.join('/');\r\n\t\t\t}\r\n\t\t\tif (pathname == '/') {\r\n\t\t\t\tprefix += '/';\r\n\t\t\t}\r\n\t\t\treturn prefix + url.substr(path.length);\r\n\t\t} else {\r\n\t\t\tif ((match = /^(.*)\\//.exec(path))) {\r\n\t\t\t\treturn getRelativePath(match[1], ++depth);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (mode === 'relative') {\r\n\t\turl = getRelativePath(host + pathname, 0).substr(2);\r\n\t} else if (mode === 'absolute') {\r\n\t\tif (url.substr(0, host.length) === host) {\r\n\t\t\turl = url.substr(host.length);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\nfunction _formatHtml(html, htmlTags, urlType, wellFormatted, indentChar) {\r\n\tif (html == null) {\r\n\t\thtml = '';\r\n\t}\r\n\turlType = urlType || '';\r\n\twellFormatted = _undef(wellFormatted, false);\r\n\tindentChar = _undef(indentChar, '\\t');\r\n\tvar fontSizeList = 'xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/<(?:br|br\\s[^>]*)>/ig, '\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/<(?:br|br\\s[^>]*)\\s*\\/?>\\s*<\\/p>/ig, '</p>');\r\n\thtml = html.replace(/(<(?:p|p\\s[^>]*)>)\\s*(<\\/p>)/ig, '$1<br />$2');\r\n\thtml = html.replace(/\\u200B/g, '');\r\n\thtml = html.replace(/\\u00A9/g, '&copy;');\r\n\thtml = html.replace(/\\u00AE/g, '&reg;');\r\n\thtml = html.replace(/\\u2003/g, '&emsp;');\r\n\thtml = html.replace(/\\u3000/g, '&emsp;');\r\n\thtml = html.replace(/<[^>]+/g, function($0) {\r\n\t\treturn $0.replace(/\\s+/g, ' ');\r\n\t});\r\n\tvar htmlTagMap = {};\r\n\tif (htmlTags) {\r\n\t\t_each(htmlTags, function(key, val) {\r\n\t\t\tvar arr = key.split(',');\r\n\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\t\thtmlTagMap[arr[i]] = _toMap(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!htmlTagMap.script) {\r\n\t\t\thtml = html.replace(/(<(?:script|script\\s[^>]*)>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\t}\r\n\t\tif (!htmlTagMap.style) {\r\n\t\t\thtml = html.replace(/(<(?:style|style\\s[^>]*)>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\t}\r\n\t}\r\n\tvar re = /(\\s*)<(\\/)?([\\w\\-:]+)((?:\\s+|(?:\\s+[\\w\\-:]+)|(?:\\s+[\\w\\-:]+=[^\\s\"'<>]+)|(?:\\s+[\\w\\-:\"]+=\"[^\"]*\")|(?:\\s+[\\w\\-:\"]+='[^']*'))*)(\\/)?>(\\s*)/g;\r\n\tvar tagStack = [];\r\n\thtml = html.replace(re, function($0, $1, $2, $3, $4, $5, $6) {\r\n\t\tvar full = $0,\r\n\t\t\tstartNewline = $1 || '',\r\n\t\t\tstartSlash = $2 || '',\r\n\t\t\ttagName = $3.toLowerCase(),\r\n\t\t\tattr = $4 || '',\r\n\t\t\tendSlash = $5 ? ' ' + $5 : '',\r\n\t\t\tendNewline = $6 || '';\r\n\t\tif (htmlTags && !htmlTagMap[tagName]) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tif (endSlash === '' && _SINGLE_TAG_MAP[tagName]) {\r\n\t\t\tendSlash = ' /';\r\n\t\t}\r\n\t\tif (_INLINE_TAG_MAP[tagName]) {\r\n\t\t\tif (startNewline) {\r\n\t\t\t\tstartNewline = ' ';\r\n\t\t\t}\r\n\t\t\tif (endNewline) {\r\n\t\t\t\tendNewline = ' ';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (startSlash) {\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (wellFormatted && tagName == 'br') {\r\n\t\t\tendNewline = '\\n';\r\n\t\t}\r\n\t\tif (_BLOCK_TAG_MAP[tagName] && !_PRE_TAG_MAP[tagName]) {\r\n\t\t\tif (wellFormatted) {\r\n\t\t\t\tif (startSlash && tagStack.length > 0 && tagStack[tagStack.length - 1] === tagName) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttagStack.push(tagName);\r\n\t\t\t\t}\r\n\t\t\t\tstartNewline = '\\n';\r\n\t\t\t\tendNewline = '\\n';\r\n\t\t\t\tfor (var i = 0, len = startSlash ? tagStack.length : tagStack.length - 1; i < len; i++) {\r\n\t\t\t\t\tstartNewline += indentChar;\r\n\t\t\t\t\tif (!startSlash) {\r\n\t\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (endSlash) {\r\n\t\t\t\t\ttagStack.pop();\r\n\t\t\t\t} else if (!startSlash) {\r\n\t\t\t\t\tendNewline += indentChar;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartNewline = endNewline = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (attr !== '') {\r\n\t\t\tvar attrMap = _getAttrList(full);\r\n\t\t\tif (tagName === 'font') {\r\n\t\t\t\tvar fontStyleMap = {}, fontStyle = '';\r\n\t\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\t\tif (key === 'color') {\r\n\t\t\t\t\t\tfontStyleMap.color = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'size') {\r\n\t\t\t\t\t\tfontStyleMap['font-size'] = fontSizeList[parseInt(val, 10) - 1] || '';\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'face') {\r\n\t\t\t\t\t\tfontStyleMap['font-family'] = val;\r\n\t\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === 'style') {\r\n\t\t\t\t\t\tfontStyle = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (fontStyle && !/;$/.test(fontStyle)) {\r\n\t\t\t\t\tfontStyle += ';';\r\n\t\t\t\t}\r\n\t\t\t\t_each(fontStyleMap, function(key, val) {\r\n\t\t\t\t\tif (val === '') {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/\\s/.test(val)) {\r\n\t\t\t\t\t\tval = \"'\" + val + \"'\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfontStyle += key + ':' + val + ';';\r\n\t\t\t\t});\r\n\t\t\t\tattrMap.style = fontStyle;\r\n\t\t\t}\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (_FILL_ATTR_MAP[key]) {\r\n\t\t\t\t\tattrMap[key] = key;\r\n\t\t\t\t}\r\n\t\t\t\tif (_inArray(key, ['src', 'href']) >= 0) {\r\n\t\t\t\t\tattrMap[key] = _formatUrl(val, urlType);\r\n\t\t\t\t}\r\n\t\t\t\tif (htmlTags && key !== 'style' && !htmlTagMap[tagName]['*'] && !htmlTagMap[tagName][key] ||\r\n\t\t\t\t\ttagName === 'body' && key === 'contenteditable' ||\r\n\t\t\t\t\t/^kindeditor_\\d+$/.test(key)) {\r\n\t\t\t\t\tdelete attrMap[key];\r\n\t\t\t\t}\r\n\t\t\t\tif (key === 'style' && val !== '') {\r\n\t\t\t\t\tvar styleMap = _getCssList(val);\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tif (htmlTags && !htmlTagMap[tagName].style && !htmlTagMap[tagName]['.' + k]) {\r\n\t\t\t\t\t\t\tdelete styleMap[k];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t_each(styleMap, function(k, v) {\r\n\t\t\t\t\t\tstyle += k + ':' + v + ';';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tattrMap.style = style;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tattr = '';\r\n\t\t\t_each(attrMap, function(key, val) {\r\n\t\t\t\tif (key === 'style' && val === '') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tval = val.replace(/\"/g, '&quot;');\r\n\t\t\t\tattr += ' ' + key + '=\"' + val + '\"';\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (tagName === 'font') {\r\n\t\t\ttagName = 'span';\r\n\t\t}\r\n\t\treturn startNewline + '<' + startSlash + tagName + attr + endSlash + '>' + endNewline;\r\n\t});\r\n\thtml = html.replace(/(<(?:pre|pre\\s[^>]*)>)([\\s\\S]*?)(<\\/pre>)/ig, function($0, $1, $2, $3) {\r\n\t\treturn $1 + $2.replace(/\\n/g, '<span id=\"__kindeditor_pre_newline__\">\\n') + $3;\r\n\t});\r\n\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\thtml = html.replace(/<span id=\"__kindeditor_pre_newline__\">\\n/g, '\\n');\r\n\treturn _trim(html);\r\n}\r\r\nfunction _clearMsWord(html, htmlTags) {\r\n\thtml = html.replace(/<meta[\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<![\\s\\S]*?>/ig, '')\r\n\t\t.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/ig, '')\r\n\t\t.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/ig, '')\r\n\t\t.replace(/<w:[^>]+>[\\s\\S]*?<\\/w:[^>]+>/ig, '')\r\n\t\t.replace(/<o:[^>]+>[\\s\\S]*?<\\/o:[^>]+>/ig, '')\r\n\t\t.replace(/<xml>[\\s\\S]*?<\\/xml>/ig, '')\r\n\t\t.replace(/<(?:table|td)[^>]*>/ig, function(full) {\r\n\t\t\treturn full.replace(/border-bottom:([#\\w\\s]+)/ig, 'border:$1');\r\n\t\t});\r\n\treturn _formatHtml(html, htmlTags);\r\n}\r\r\nfunction _mediaType(src) {\r\n\tif (/\\.(rm|rmvb)(\\?|$)/i.test(src)) {\r\n\t\treturn 'audio/x-pn-realaudio-plugin';\r\n\t}\r\n\tif (/\\.(swf|flv)(\\?|$)/i.test(src)) {\r\n\t\treturn 'application/x-shockwave-flash';\r\n\t}\r\n\treturn 'video/x-ms-asf-plugin';\r\n}\r\r\nfunction _mediaClass(type) {\r\n\tif (/realaudio/i.test(type)) {\r\n\t\treturn 'ke-rm';\r\n\t}\r\n\tif (/flash/i.test(type)) {\r\n\t\treturn 'ke-flash';\r\n\t}\r\n\treturn 'ke-media';\r\n}\r\nfunction _mediaAttrs(srcTag) {\r\n\treturn _getAttrList(unescape(srcTag));\r\n}\r\nfunction _mediaEmbed(attrs) {\r\n\tvar html = '<embed ';\r\n\t_each(attrs, function(key, val) {\r\n\t\thtml += key + '=\"' + val + '\" ';\r\n\t});\r\n\thtml += '/>';\r\n\treturn html;\r\n}\r\nfunction _mediaImg(blankPath, attrs) {\r\n\tvar width = attrs.width,\r\n\t\theight = attrs.height,\r\n\t\ttype = attrs.type || _mediaType(attrs.src),\r\n\t\tsrcTag = _mediaEmbed(attrs),\r\n\t\tstyle = '';\r\n\tif (/\\D/.test(width)) {\r\n\t\tstyle += 'width:' + width + ';';\r\n\t} else if (width > 0) {\r\n\t\tstyle += 'width:' + width + 'px;';\r\n\t}\r\n\tif (/\\D/.test(height)) {\r\n\t\tstyle += 'height:' + height + ';';\r\n\t} else if (height > 0) {\r\n\t\tstyle += 'height:' + height + 'px;';\r\n\t}\r\n\tvar html = '<img class=\"' + _mediaClass(type) + '\" src=\"' + blankPath + '\" ';\r\n\tif (style !== '') {\r\n\t\thtml += 'style=\"' + style + '\" ';\r\n\t}\r\n\thtml += 'data-ke-tag=\"' + escape(srcTag) + '\" alt=\"\" />';\r\n\treturn html;\r\n}\r\n\r\r\r\r\nfunction _tmpl(str, data) {\r\n\tvar fn = new Function(\"obj\",\r\n\t\t\"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n\t\t\"with(obj){p.push('\" +\r\n\t\tstr.replace(/[\\r\\t\\n]/g, \" \")\r\n\t\t\t.split(\"<%\").join(\"\\t\")\r\n\t\t\t.replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n\t\t\t.replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n\t\t\t.split(\"\\t\").join(\"');\")\r\n\t\t\t.split(\"%>\").join(\"p.push('\")\r\n\t\t\t.split(\"\\r\").join(\"\\\\'\") + \"');}return p.join('');\");\r\n\treturn data ? fn(data) : fn;\r\n}\r\nK.formatUrl = _formatUrl;\r\nK.formatHtml = _formatHtml;\r\nK.getCssList = _getCssList;\r\nK.getAttrList = _getAttrList;\r\nK.mediaType = _mediaType;\r\nK.mediaAttrs = _mediaAttrs;\r\nK.mediaEmbed = _mediaEmbed;\r\nK.mediaImg = _mediaImg;\r\nK.clearMsWord = _clearMsWord;\r\nK.tmpl = _tmpl;\r\n\r\n\r\nfunction _contains(nodeA, nodeB) {\r\n\tif (nodeA.nodeType == 9 && nodeB.nodeType != 9) {\r\n\t\treturn true;\r\n\t}\r\n\twhile ((nodeB = nodeB.parentNode)) {\r\n\t\tif (nodeB == nodeA) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\nvar _getSetAttrDiv = document.createElement('div');\r\n_getSetAttrDiv.setAttribute('className', 't');\r\nvar _GET_SET_ATTRIBUTE = _getSetAttrDiv.className !== 't';\r\nfunction _getAttr(el, key) {\r\n\tkey = key.toLowerCase();\r\n\tvar val = null;\r\n\tif (!_GET_SET_ATTRIBUTE && el.nodeName.toLowerCase() != 'script') {\r\n\t\tvar div = el.ownerDocument.createElement('div');\r\n\t\tdiv.appendChild(el.cloneNode(false));\r\n\t\tvar list = _getAttrList(_unescape(div.innerHTML));\r\n\t\tif (key in list) {\r\n\t\t\tval = list[key];\r\n\t\t}\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tval = el.getAttribute(key, 2);\r\n\t\t} catch(e) {\r\n\t\t\tval = el.getAttribute(key, 1);\r\n\t\t}\r\n\t}\r\n\tif (key === 'style' && val !== null) {\r\n\t\tval = _formatCss(val);\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _queryAll(expr, root) {\r\n\tvar exprList = expr.split(',');\r\n\tif (exprList.length > 1) {\r\n\t\tvar mergedResults = [];\r\n\t\t_each(exprList, function() {\r\n\t\t\t_each(_queryAll(this, root), function() {\r\n\t\t\t\tif (_inArray(this, mergedResults) < 0) {\r\n\t\t\t\t\tmergedResults.push(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn mergedResults;\r\n\t}\r\n\troot = root || document;\r\n\tfunction escape(str) {\r\n\t\tif (typeof str != 'string') {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\treturn str.replace(/([^\\w\\-])/g, '\\\\$1');\r\n\t}\r\n\tfunction stripslashes(str) {\r\n\t\treturn str.replace(/\\\\/g, '');\r\n\t}\r\n\tfunction cmpTag(tagA, tagB) {\r\n\t\treturn tagA === '*' || tagA.toLowerCase() === escape(tagB.toLowerCase());\r\n\t}\r\n\tfunction byId(id, tag, root) {\r\n\t\tvar arr = [],\r\n\t\t\tdoc = root.ownerDocument || root,\r\n\t\t\tel = doc.getElementById(stripslashes(id));\r\n\t\tif (el) {\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tarr.push(el);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byClass(className, tag, root) {\r\n\t\tvar doc = root.ownerDocument || root, arr = [], els, i, len, el;\r\n\t\tif (root.getElementsByClassName) {\r\n\t\t\tels = root.getElementsByClassName(stripslashes(className));\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (cmpTag(tag, el.nodeName)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (doc.querySelectorAll) {\r\n\t\t\tels = doc.querySelectorAll((root.nodeName !== '#document' ? root.nodeName + ' ' : '') + tag + '.' + className);\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (_contains(root, el)) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tels = root.getElementsByTagName(tag);\r\n\t\t\tclassName = ' ' + className + ' ';\r\n\t\t\tfor (i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tvar cls = el.className;\r\n\t\t\t\t\tif (cls && (' ' + cls + ' ').indexOf(className) > -1) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byName(name, tag, root) {\r\n\t\tvar arr = [], doc = root.ownerDocument || root,\r\n\t\t\tels = doc.getElementsByName(stripslashes(name)), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (cmpTag(tag, el.nodeName) && _contains(root, el)) {\r\n\t\t\t\tif (el.getAttribute('name') !== null) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction byAttr(key, val, tag, root) {\r\n\t\tvar arr = [], els = root.getElementsByTagName(tag), el;\r\n\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\tel = els[i];\r\n\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\tif (val === null) {\r\n\t\t\t\t\tif (_getAttr(el, key) !== null) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (val === escape(_getAttr(el, key))) {\r\n\t\t\t\t\t\tarr.push(el);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tfunction select(expr, root) {\r\n\t\tvar arr = [], matches;\r\n\t\tmatches = /^((?:\\\\.|[^.#\\s\\[<>])+)/.exec(expr);\r\n\t\tvar tag = matches ? matches[1] : '*';\r\n\t\tif ((matches = /#((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byId(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\.((?:[\\w\\-]|\\\\.)+)$/.exec(expr))) {\r\n\t\t\tarr = byClass(matches[1], tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\]/.exec(expr))) {\r\n\t\t\tarr = byAttr(matches[1].toLowerCase(), null, tag, root);\r\n\t\t} else if ((matches = /\\[((?:[\\w\\-]|\\\\.)+)\\s*=\\s*['\"]?((?:\\\\.|[^'\"]+)+)['\"]?\\]/.exec(expr))) {\r\n\t\t\tvar key = matches[1].toLowerCase(), val = matches[2];\r\n\t\t\tif (key === 'id') {\r\n\t\t\t\tarr = byId(val, tag, root);\r\n\t\t\t} else if (key === 'class') {\r\n\t\t\t\tarr = byClass(val, tag, root);\r\n\t\t\t} else if (key === 'name') {\r\n\t\t\t\tarr = byName(val, tag, root);\r\n\t\t\t} else {\r\n\t\t\t\tarr = byAttr(key, val, tag, root);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar els = root.getElementsByTagName(tag), el;\r\n\t\t\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\t\t\tel = els[i];\r\n\t\t\t\tif (el.nodeType == 1) {\r\n\t\t\t\t\tarr.push(el);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\tvar parts = [], arr, re = /((?:\\\\.|[^\\s>])+|[\\s>])/g;\r\n\twhile ((arr = re.exec(expr))) {\r\n\t\tif (arr[1] !== ' ') {\r\n\t\t\tparts.push(arr[1]);\r\n\t\t}\r\n\t}\r\n\tvar results = [];\r\n\tif (parts.length == 1) {\r\n\t\treturn select(parts[0], root);\r\n\t}\r\n\tvar isChild = false, part, els, subResults, val, v, i, j, k, length, len, l;\r\n\tfor (i = 0, lenth = parts.length; i < lenth; i++) {\r\n\t\tpart = parts[i];\r\n\t\tif (part === '>') {\r\n\t\t\tisChild = true;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (i > 0) {\r\n\t\t\tels = [];\r\n\t\t\tfor (j = 0, len = results.length; j < len; j++) {\r\n\t\t\t\tval = results[j];\r\n\t\t\t\tsubResults = select(part, val);\r\n\t\t\t\tfor (k = 0, l = subResults.length; k < l; k++) {\r\n\t\t\t\t\tv = subResults[k];\r\n\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\tif (val === v.parentNode) {\r\n\t\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tels.push(v);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresults = els;\r\n\t\t} else {\r\n\t\t\tresults = select(part, root);\r\n\t\t}\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\treturn results;\r\n}\r\nfunction _query(expr, root) {\r\n\tvar arr = _queryAll(expr, root);\r\n\treturn arr.length > 0 ? arr[0] : null;\r\n}\r\nK.query = _query;\r\nK.queryAll = _queryAll;\r\n\r\n\r\nfunction _get(val) {\r\n\treturn K(val)[0];\r\n}\r\nfunction _getDoc(node) {\r\n\tif (!node) {\r\n\t\treturn document;\r\n\t}\r\n\treturn node.ownerDocument || node.document || node;\r\n}\r\nfunction _getWin(node) {\r\n\tif (!node) {\r\n\t\treturn window;\r\n\t}\r\n\tvar doc = _getDoc(node);\r\n\treturn doc.parentWindow || doc.defaultView;\r\n}\r\nfunction _setHtml(el, html) {\r\n\tif (el.nodeType != 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar doc = _getDoc(el);\r\n\ttry {\r\n\t\tel.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + html;\r\n\t\tvar temp = doc.getElementById('__kindeditor_temp_tag__');\r\n\t\ttemp.parentNode.removeChild(temp);\r\n\t} catch(e) {\r\n\t\tK(el).empty();\r\n\t\tK('@' + html, doc).each(function() {\r\n\t\t\tel.appendChild(this);\r\n\t\t});\r\n\t}\r\n}\r\nfunction _hasClass(el, cls) {\r\n\treturn _inString(cls, el.className, ' ');\r\n}\r\nfunction _setAttr(el, key, val) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\tel.setAttribute(key, '' + val);\r\n}\r\nfunction _removeAttr(el, key) {\r\n\tif (_IE && _V < 8 && key.toLowerCase() == 'class') {\r\n\t\tkey = 'className';\r\n\t}\r\n\t_setAttr(el, key, '');\r\n\tel.removeAttribute(key);\r\n}\r\nfunction _getNodeName(node) {\r\n\tif (!node || !node.nodeName) {\r\n\t\treturn '';\r\n\t}\r\n\treturn node.nodeName.toLowerCase();\r\n}\r\nfunction _computedCss(el, key) {\r\n\tvar self = this, win = _getWin(el), camelKey = _toCamel(key), val = '';\r\n\tif (win.getComputedStyle) {\r\n\t\tvar style = win.getComputedStyle(el, null);\r\n\t\tval = style[camelKey] || style.getPropertyValue(key) || el.style[camelKey];\r\n\t} else if (el.currentStyle) {\r\n\t\tval = el.currentStyle[camelKey] || el.style[camelKey];\r\n\t}\r\n\treturn val;\r\n}\r\nfunction _hasVal(node) {\r\n\treturn !!_VALUE_TAG_MAP[_getNodeName(node)];\r\n}\r\nfunction _docElement(doc) {\r\n\tdoc = doc || document;\r\n\treturn _QUIRKS ? doc.body : doc.documentElement;\r\n}\r\nfunction _docHeight(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollHeight, el.clientHeight);\r\n}\r\nfunction _docWidth(doc) {\r\n\tvar el = _docElement(doc);\r\n\treturn Math.max(el.scrollWidth, el.clientWidth);\r\n}\r\nfunction _getScrollPos(doc) {\r\n\tdoc = doc || document;\r\n\tvar x, y;\r\n\tif (_IE || _NEWIE || _OPERA) {\r\n\t\tx = _docElement(doc).scrollLeft;\r\n\t\ty = _docElement(doc).scrollTop;\r\n\t} else {\r\n\t\tx = _getWin(doc).scrollX;\r\n\t\ty = _getWin(doc).scrollY;\r\n\t}\r\n\treturn {x : x, y : y};\r\n}\r\n\r\r\nfunction KNode(node) {\r\n\tthis.init(node);\r\n}\r\n_extend(KNode, {\r\n\tinit : function(node) {\r\n\t\tvar self = this;\r\n\t\tnode = _isArray(node) ? node : [node];\r\n\t\tvar length = 0;\r\n\t\tfor (var i = 0, len = node.length; i < len; i++) {\r\n\t\t\tif (node[i]) {\r\n\t\t\t\tself[i] = node[i].constructor === KNode ? node[i][0] : node[i];\r\n\t\t\t\tlength++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.length = length;\r\n\t\tself.doc = _getDoc(self[0]);\r\n\t\tself.name = _getNodeName(self[0]);\r\n\t\tself.type = self.length > 0 ? self[0].nodeType : null;\r\n\t\tself.win = _getWin(self[0]);\r\n\t},\r\n\teach : function(fn) {\r\n\t\tvar self = this;\r\n\t\tfor (var i = 0; i < self.length; i++) {\r\n\t\t\tif (fn.call(self[i], i, self[i]) === false) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_bind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tunbind : function(type, fn) {\r\n\t\tthis.each(function() {\r\n\t\t\t_unbind(this, type, fn);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tfire : function(type) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t_fire(this[0], type);\r\n\t\treturn this;\r\n\t},\r\n\thasAttr : function(key) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!_getAttr(this[0], key);\r\n\t},\r\n\tattr : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getAttrList(self.outer());\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.attr(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self.length < 1 ? null : _getAttr(self[0], key);\r\n\t\t\treturn val === null ? '' : val;\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setAttr(this, key, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremoveAttr : function(key) {\r\n\t\tthis.each(function() {\r\n\t\t\t_removeAttr(this, key);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tget : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i || 0];\r\n\t},\r\n\teq : function(i) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this[i] ? new KNode(this[i]) : null;\r\n\t},\r\n\thasClass : function(cls) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasClass(this[0], cls);\r\n\t},\r\n\taddClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (!_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className + ' ' + cls);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tremoveClass : function(cls) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (_hasClass(this, cls)) {\r\n\t\t\t\tthis.className = _trim(this.className.replace(new RegExp('(^|\\\\s)' + cls + '(\\\\s|$)'), ' '));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1 || self.type != 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn _formatHtml(self[0].innerHTML);\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\t_setHtml(this, val);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\ttext : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn _IE ? self[0].innerText : self[0].textContent;\r\n\t},\r\n\thasVal : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _hasVal(this[0]);\r\n\t},\r\n\tval : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self.hasVal() ? self[0].value : self.attr('value');\r\n\t\t} else {\r\n\t\t\tself.each(function() {\r\n\t\t\t\tif (_hasVal(this)) {\r\n\t\t\t\t\tthis.value = val;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_setAttr(this, 'value' , val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t},\r\n\tcss : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tif (key === undefined) {\r\n\t\t\treturn _getCssList(self.attr('style'));\r\n\t\t}\r\n\t\tif (typeof key === 'object') {\r\n\t\t\t_each(key, function(k, v) {\r\n\t\t\t\tself.css(k, v);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn self[0].style[_toCamel(key)] || _computedCss(self[0], key) || '';\r\n\t\t}\r\n\t\tself.each(function() {\r\n\t\t\tthis.style[_toCamel(key)] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\twidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetWidth;\r\n\t\t}\r\n\t\treturn self.css('width', _addUnit(val));\r\n\t},\r\n\theight : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn self[0].offsetHeight;\r\n\t\t}\r\n\t\treturn self.css('height', _addUnit(val));\r\n\t},\r\n\topacity : function(val) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.style.opacity === undefined) {\r\n\t\t\t\tthis.style.filter = val == 1 ? '' : 'alpha(opacity=' + (val * 100) + ')';\r\n\t\t\t} else {\r\n\t\t\t\tthis.style.opacity = val == 1 ? '' : val;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tdata : function(key, val) {\r\n\t\tvar self = this;\r\n\t\tkey = 'kindeditor_data_' + key;\r\n\t\tif (val === undefined) {\r\n\t\t\tif (self.length < 1) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn self[0][key];\r\n\t\t}\r\n\t\tthis.each(function() {\r\n\t\t\tthis[key] = val;\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tpos : function() {\r\n\t\tvar self = this, node = self[0], x = 0, y = 0;\r\n\t\tif (node) {\r\n\t\t\tif (node.getBoundingClientRect) {\r\n\t\t\t\tvar box = node.getBoundingClientRect(),\r\n\t\t\t\t\tpos = _getScrollPos(self.doc);\r\n\t\t\t\tx = box.left + pos.x;\r\n\t\t\t\ty = box.top + pos.y;\r\n\t\t\t} else {\r\n\t\t\t\twhile (node) {\r\n\t\t\t\t\tx += node.offsetLeft;\r\n\t\t\t\t\ty += node.offsetTop;\r\n\t\t\t\t\tnode = node.offsetParent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {x : _round(x), y : _round(y)};\r\n\t},\r\n\tclone : function(bool) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\treturn new KNode(this[0].cloneNode(bool));\r\n\t},\r\n\tappend : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.appendChild) {\r\n\t\t\t\tthis.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tappendTo : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\t_get(expr).appendChild(this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tbefore : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tthis.parentNode.insertBefore(_get(expr), this);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tafter : function(expr) {\r\n\t\tthis.each(function() {\r\n\t\t\tif (this.nextSibling) {\r\n\t\t\t\tthis.parentNode.insertBefore(_get(expr), this.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parentNode.appendChild(_get(expr));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\treplaceWith : function(expr) {\r\n\t\tvar nodes = [];\r\n\t\tthis.each(function(i, node) {\r\n\t\t\t_unbind(node);\r\n\t\t\tvar newNode = _get(expr);\r\n\t\t\tnode.parentNode.replaceChild(newNode, node);\r\n\t\t\tnodes.push(newNode);\r\n\t\t});\r\n\t\treturn K(nodes);\r\n\t},\r\n\tempty : function() {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tchild.parentNode.removeChild(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tremove : function(keepChilds) {\r\n\t\tvar self = this;\r\n\t\tself.each(function(i, node) {\r\n\t\t\tif (!node.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_unbind(node);\r\n\t\t\tif (keepChilds) {\r\n\t\t\t\tvar child = node.firstChild;\r\n\t\t\t\twhile (child) {\r\n\t\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\t\tnode.parentNode.insertBefore(child, node);\r\n\t\t\t\t\tchild = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tdelete self[i];\r\n\t\t});\r\n\t\tself.length = 0;\r\n\t\treturn self;\r\n\t},\r\n\tshow : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\tval = self._originDisplay || '';\r\n\t\t}\r\n\t\tif (self.css('display') != 'none') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.css('display', val);\r\n\t},\r\n\thide : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself._originDisplay = self[0].style.display;\r\n\t\treturn self.css('display', 'none');\r\n\t},\r\n\touter : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.length < 1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tvar div = self.doc.createElement('div'), html;\r\n\t\tdiv.appendChild(self[0].cloneNode(true));\r\n\t\thtml = _formatHtml(div.innerHTML);\r\n\t\tdiv = null;\r\n\t\treturn html;\r\n\t},\r\n\tisSingle : function() {\r\n\t\treturn !!_SINGLE_TAG_MAP[this.name];\r\n\t},\r\n\tisInline : function() {\r\n\t\treturn !!_INLINE_TAG_MAP[this.name];\r\n\t},\r\n\tisBlock : function() {\r\n\t\treturn !!_BLOCK_TAG_MAP[this.name];\r\n\t},\r\n\tisStyle : function() {\r\n\t\treturn !!_STYLE_TAG_MAP[this.name];\r\n\t},\r\n\tisControl : function() {\r\n\t\treturn !!_CONTROL_TAG_MAP[this.name];\r\n\t},\r\n\tcontains : function(otherNode) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn _contains(this[0], _get(otherNode));\r\n\t},\r\n\tparent : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].parentNode;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tchildren : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn new KNode([]);\r\n\t\t}\r\n\t\tvar list = [], child = this[0].firstChild;\r\n\t\twhile (child) {\r\n\t\t\tif (child.nodeType != 3 || _trim(child.nodeValue) !== '') {\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\tchild = child.nextSibling;\r\n\t\t}\r\n\t\treturn new KNode(list);\r\n\t},\r\n\tfirst : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(0) : null;\r\n\t},\r\n\tlast : function() {\r\n\t\tvar list = this.children();\r\n\t\treturn list.length > 0 ? list.eq(list.length - 1) : null;\r\n\t},\r\n\tindex : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tvar i = -1, sibling = this[0];\r\n\t\twhile (sibling) {\r\n\t\t\ti++;\r\n\t\t\tsibling = sibling.previousSibling;\r\n\t\t}\r\n\t\treturn i;\r\n\t},\r\n\tprev : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].previousSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tnext : function() {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar node = this[0].nextSibling;\r\n\t\treturn node ? new KNode(node) : null;\r\n\t},\r\n\tscan : function(fn, order) {\r\n\t\tif (this.length < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\torder = (order === undefined) ? true : order;\r\n\t\tfunction walk(node) {\r\n\t\t\tvar n = order ? node.firstChild : node.lastChild;\r\n\t\t\twhile (n) {\r\n\t\t\t\tvar next = order ? n.nextSibling : n.previousSibling;\r\n\t\t\t\tif (fn(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (walk(n) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tn = next;\r\n\t\t\t}\r\n\t\t}\r\n\t\twalk(this[0]);\r\n\t\treturn this;\r\n\t}\r\n});\r\n_each(('blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,' +\r\n\t'mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,' +\r\n\t'change,select,submit,keydown,keypress,keyup,error,contextmenu').split(','), function(i, type) {\r\n\tKNode.prototype[type] = function(fn) {\r\n\t\treturn fn ? this.bind(type, fn) : this.fire(type);\r\n\t};\r\n});\r\nvar _K = K;\r\nK = function(expr, root) {\r\n\tif (expr === undefined || expr === null) {\r\n\t\treturn;\r\n\t}\r\n\tfunction newNode(node) {\r\n\t\tif (!node[0]) {\r\n\t\t\tnode = [];\r\n\t\t}\r\n\t\treturn new KNode(node);\r\n\t}\r\n\tif (typeof expr === 'string') {\r\n\t\tif (root) {\r\n\t\t\troot = _get(root);\r\n\t\t}\r\n\t\tvar length = expr.length;\r\n\t\tif (expr.charAt(0) === '@') {\r\n\t\t\texpr = expr.substr(1);\r\n\t\t}\r\n\t\tif (expr.length !== length || /<.+>/.test(expr)) {\r\n\t\t\tvar doc = root ? root.ownerDocument || root : document,\r\n\t\t\t\tdiv = doc.createElement('div'), list = [];\r\n\t\t\tdiv.innerHTML = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + expr;\r\n\t\t\tfor (var i = 0, len = div.childNodes.length; i < len; i++) {\r\n\t\t\t\tvar child = div.childNodes[i];\r\n\t\t\t\tif (child.id == '__kindeditor_temp_tag__') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(child);\r\n\t\t\t}\r\n\t\t\treturn newNode(list);\r\n\t\t}\r\n\t\treturn newNode(_queryAll(expr, root));\r\n\t}\r\n\tif (expr && expr.constructor === KNode) {\r\n\t\treturn expr;\r\n\t}\r\n\tif (expr.toArray) {\r\n\t\texpr = expr.toArray();\r\n\t}\r\n\tif (_isArray(expr)) {\r\n\t\treturn newNode(expr);\r\n\t}\r\n\treturn newNode(_toArray(arguments));\r\n};\r\n_each(_K, function(key, val) {\r\n\tK[key] = val;\r\n});\r\nK.NodeClass = KNode;\r\nwindow.KindEditor = K;\r\n\r\n\r\nvar _START_TO_START = 0,\r\n\t_START_TO_END = 1,\r\n\t_END_TO_END = 2,\r\n\t_END_TO_START = 3,\r\n\t_BOOKMARK_ID = 0;\r\nfunction _updateCollapsed(range) {\r\n\trange.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\r\n\treturn range;\r\n}\r\nfunction _copyAndDelete(range, isCopy, isDelete) {\r\n\tvar doc = range.doc, nodeList = [];\r\n\tfunction splitTextNode(node, startOffset, endOffset) {\r\n\t\tvar length = node.nodeValue.length, centerNode;\r\n\t\tif (isCopy) {\r\n\t\t\tvar cloneNode = node.cloneNode(true);\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenterNode = cloneNode.splitText(startOffset);\r\n\t\t\t} else {\r\n\t\t\t\tcenterNode = cloneNode;\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tcenterNode.splitText(endOffset - startOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDelete) {\r\n\t\t\tvar center = node;\r\n\t\t\tif (startOffset > 0) {\r\n\t\t\t\tcenter = node.splitText(startOffset);\r\n\t\t\t\trange.setStart(node, startOffset);\r\n\t\t\t}\r\n\t\t\tif (endOffset < length) {\r\n\t\t\t\tvar right = center.splitText(endOffset - startOffset);\r\n\t\t\t\trange.setEnd(right, 0);\r\n\t\t\t}\r\n\t\t\tnodeList.push(center);\r\n\t\t}\r\n\t\treturn centerNode;\r\n\t}\r\n\tfunction removeNodes() {\r\n\t\tif (isDelete) {\r\n\t\t\trange.up().collapse(true);\r\n\t\t}\r\n\t\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\t\tvar node = nodeList[i];\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar copyRange = range.cloneRange().down();\r\n\tvar start = -1, incStart = -1, incEnd = -1, end = -1,\r\n\t\tancestor = range.commonAncestor(), frag = doc.createDocumentFragment();\r\n\tif (ancestor.nodeType == 3) {\r\n\t\tvar textNode = splitTextNode(ancestor, range.startOffset, range.endOffset);\r\n\t\tif (isCopy) {\r\n\t\t\tfrag.appendChild(textNode);\r\n\t\t}\r\n\t\tremoveNodes();\r\n\t\treturn isCopy ? frag : range;\r\n\t}\r\n\tfunction extractNodes(parent, frag) {\r\n\t\tvar node = parent.firstChild, nextNode;\r\n\t\twhile (node) {\r\n\t\t\tvar testRange = new KRange(doc).selectNode(node);\r\n\t\t\tstart = testRange.compareBoundaryPoints(_START_TO_END, range);\r\n\t\t\tif (start >= 0 && incStart <= 0) {\r\n\t\t\t\tincStart = testRange.compareBoundaryPoints(_START_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\tincEnd = testRange.compareBoundaryPoints(_END_TO_END, range);\r\n\t\t\t}\r\n\t\t\tif (incEnd >= 0 && end <= 0) {\r\n\t\t\t\tend = testRange.compareBoundaryPoints(_END_TO_START, range);\r\n\t\t\t}\r\n\t\t\tif (end >= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tnextNode = node.nextSibling;\r\n\t\t\tif (start > 0) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (incStart >= 0 && incEnd <= 0) {\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tfrag.appendChild(node.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isDelete) {\r\n\t\t\t\t\t\t\tnodeList.push(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar childFlag;\r\n\t\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\t\tchildFlag = node.cloneNode(false);\r\n\t\t\t\t\t\t\tfrag.appendChild(childFlag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (extractNodes(node, childFlag) === false) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (node.nodeType == 3) {\r\n\t\t\t\t\tvar textNode;\r\n\t\t\t\t\tif (node == copyRange.startContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, copyRange.startOffset, node.nodeValue.length);\r\n\t\t\t\t\t} else if (node == copyRange.endContainer) {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, copyRange.endOffset);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttextNode = splitTextNode(node, 0, node.nodeValue.length);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (isCopy) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tfrag.appendChild(textNode);\r\n\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode = nextNode;\r\n\t\t}\r\n\t}\r\n\textractNodes(ancestor, frag);\r\n\tif (isDelete) {\r\n\t\trange.up().collapse(true);\r\n\t}\r\n\tfor (var i = 0, len = nodeList.length; i < len; i++) {\r\n\t\tvar node = nodeList[i];\r\n\t\tif (node.parentNode) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t}\r\n\treturn isCopy ? frag : range;\r\n}\r\r\nfunction _moveToElementText(range, el) {\r\n\tvar node = el;\r\n\twhile (node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.name == 'marquee' || knode.name == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = node.parentNode;\r\n\t}\r\n\ttry {\r\n\t\trange.moveToElementText(el);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _getStartEnd(rng, isStart) {\r\n\tvar doc = rng.parentElement().ownerDocument,\r\n\t\tpointRange = rng.duplicate();\r\n\tpointRange.collapse(isStart);\r\n\tvar parent = pointRange.parentElement(),\r\n\t\tnodes = parent.childNodes;\r\n\tif (nodes.length === 0) {\r\n\t\treturn {node: parent.parentNode, offset: K(parent).index()};\r\n\t}\r\n\tvar startNode = doc, startPos = 0, cmp = -1;\r\n\tvar testRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\tfor (var i = 0, len = nodes.length; i < len; i++) {\r\n\t\tvar node = nodes[i];\r\n\t\tcmp = testRange.compareEndPoints('StartToStart', pointRange);\r\n\t\tif (cmp === 0) {\r\n\t\t\treturn {node: node.parentNode, offset: i};\r\n\t\t}\r\n\t\tif (node.nodeType == 1) {\r\n\t\t\tvar nodeRange = rng.duplicate(), dummy, knode = K(node), newNode = node;\r\n\t\t\tif (knode.isControl()) {\r\n\t\t\t\tdummy = doc.createElement('span');\r\n\t\t\t\tknode.after(dummy);\r\n\t\t\t\tnewNode = dummy;\r\n\t\t\t\tstartPos += knode.text().replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(nodeRange, newNode);\r\n\t\t\ttestRange.setEndPoint('StartToEnd', nodeRange);\r\n\t\t\tif (cmp > 0) {\r\n\t\t\t\tstartPos += nodeRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t\t} else {\r\n\t\t\t\tstartPos = 0;\r\n\t\t\t}\r\n\t\t\tif (dummy) {\r\n\t\t\t\tK(dummy).remove();\r\n\t\t\t}\r\n\t\t} else if (node.nodeType == 3) {\r\n\t\t\ttestRange.moveStart('character', node.nodeValue.length);\r\n\t\t\tstartPos += node.nodeValue.length;\r\n\t\t}\r\n\t\tif (cmp < 0) {\r\n\t\t\tstartNode = node;\r\n\t\t}\r\n\t}\r\n\tif (cmp < 0 && startNode.nodeType == 1) {\r\n\t\treturn {node: parent, offset: K(parent.lastChild).index() + 1};\r\n\t}\r\n\tif (cmp > 0) {\r\n\t\twhile (startNode.nextSibling && startNode.nodeType == 1) {\r\n\t\t\tstartNode = startNode.nextSibling;\r\n\t\t}\r\n\t}\r\n\ttestRange = rng.duplicate();\r\n\t_moveToElementText(testRange, parent);\r\n\ttestRange.setEndPoint('StartToEnd', pointRange);\r\n\tstartPos -= testRange.text.replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\tif (cmp > 0 && startNode.nodeType == 3) {\r\n\t\tvar prevNode = startNode.previousSibling;\r\n\t\twhile (prevNode && prevNode.nodeType == 3) {\r\n\t\t\tstartPos -= prevNode.nodeValue.length;\r\n\t\t\tprevNode = prevNode.previousSibling;\r\n\t\t}\r\n\t}\r\n\treturn {node: startNode, offset: startPos};\r\n}\r\r\nfunction _getEndRange(node, offset) {\r\n\tvar doc = node.ownerDocument || node,\r\n\t\trange = doc.body.createTextRange();\r\n\tif (doc == node) {\r\n\t\trange.collapse(true);\r\n\t\treturn range;\r\n\t}\r\n\tif (node.nodeType == 1 && node.childNodes.length > 0) {\r\n\t\tvar children = node.childNodes, isStart, child;\r\n\t\tif (offset === 0) {\r\n\t\t\tchild = children[0];\r\n\t\t\tisStart = true;\r\n\t\t} else {\r\n\t\t\tchild = children[offset - 1];\r\n\t\t\tisStart = false;\r\n\t\t}\r\n\t\tif (!child) {\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (K(child).name === 'head') {\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t}\r\n\t\t\tif (offset === 2) {\r\n\t\t\t\tisStart = false;\r\n\t\t\t}\r\n\t\t\trange.collapse(isStart);\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tif (child.nodeType == 1) {\r\n\t\t\tvar kchild = K(child), span;\r\n\t\t\tif (kchild.isControl()) {\r\n\t\t\t\tspan = doc.createElement('span');\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tkchild.before(span);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tkchild.after(span);\r\n\t\t\t\t}\r\n\t\t\t\tchild = span;\r\n\t\t\t}\r\n\t\t\t_moveToElementText(range, child);\r\n\t\t\trange.collapse(isStart);\r\n\t\t\tif (span) {\r\n\t\t\t\tK(span).remove();\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tnode = child;\r\n\t\toffset = isStart ? 0 : child.nodeValue.length;\r\n\t}\r\n\tvar dummy = doc.createElement('span');\r\n\tK(node).before(dummy);\r\n\t_moveToElementText(range, dummy);\r\n\trange.moveStart('character', offset);\r\n\tK(dummy).remove();\r\n\treturn range;\r\n}\r\r\nfunction _toRange(rng) {\r\n\tvar doc, range;\r\n\tfunction tr2td(start) {\r\n\t\tif (K(start.node).name == 'tr') {\r\n\t\t\tstart.node = start.node.cells[start.offset];\r\n\t\t\tstart.offset = 0;\r\n\t\t}\r\n\t}\r\n\tif (_IERANGE) {\r\n\t\tif (rng.item) {\r\n\t\t\tdoc = _getDoc(rng.item(0));\r\n\t\t\trange = new KRange(doc);\r\n\t\t\trange.selectNode(rng.item(0));\r\n\t\t\treturn range;\r\n\t\t}\r\n\t\tdoc = rng.parentElement().ownerDocument;\r\n\t\tvar start = _getStartEnd(rng, true),\r\n\t\t\tend = _getStartEnd(rng, false);\r\n\t\ttr2td(start);\r\n\t\ttr2td(end);\r\n\t\trange = new KRange(doc);\r\n\t\trange.setStart(start.node, start.offset);\r\n\t\trange.setEnd(end.node, end.offset);\r\n\t\treturn range;\r\n\t}\r\n\tvar startContainer = rng.startContainer;\r\n\tdoc = startContainer.ownerDocument || startContainer;\r\n\trange = new KRange(doc);\r\n\trange.setStart(startContainer, rng.startOffset);\r\n\trange.setEnd(rng.endContainer, rng.endOffset);\r\n\treturn range;\r\n}\r\n\r\r\nfunction KRange(doc) {\r\n\tthis.init(doc);\r\n}\r\n_extend(KRange, {\r\n\tinit : function(doc) {\r\n\t\tvar self = this;\r\n\t\tself.startContainer = doc;\r\n\t\tself.startOffset = 0;\r\n\t\tself.endContainer = doc;\r\n\t\tself.endOffset = 0;\r\n\t\tself.collapsed = true;\r\n\t\tself.doc = doc;\r\n\t},\r\n\tcommonAncestor : function() {\r\n\t\tfunction getParents(node) {\r\n\t\t\tvar parents = [];\r\n\t\t\twhile (node) {\r\n\t\t\t\tparents.push(node);\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn parents;\r\n\t\t}\r\n\t\tvar parentsA = getParents(this.startContainer),\r\n\t\t\tparentsB = getParents(this.endContainer),\r\n\t\t\ti = 0, lenA = parentsA.length, lenB = parentsB.length, parentA, parentB;\r\n\t\twhile (++i) {\r\n\t\t\tparentA = parentsA[lenA - i];\r\n\t\t\tparentB = parentsB[lenB - i];\r\n\t\t\tif (!parentA || !parentB || parentA !== parentB) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parentsA[lenA - i + 1];\r\n\t},\r\n\tsetStart : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.startContainer = node;\r\n\t\tself.startOffset = offset;\r\n\t\tif (self.endContainer === doc) {\r\n\t\t\tself.endContainer = node;\r\n\t\t\tself.endOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetEnd : function(node, offset) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tself.endContainer = node;\r\n\t\tself.endOffset = offset;\r\n\t\tif (self.startContainer === doc) {\r\n\t\t\tself.startContainer = node;\r\n\t\t\tself.startOffset = offset;\r\n\t\t}\r\n\t\treturn _updateCollapsed(this);\r\n\t},\r\n\tsetStartBefore : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetStartAfter : function(node) {\r\n\t\treturn this.setStart(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tsetEndBefore : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index());\r\n\t},\r\n\tsetEndAfter : function(node) {\r\n\t\treturn this.setEnd(node.parentNode || this.doc, K(node).index() + 1);\r\n\t},\r\n\tselectNode : function(node) {\r\n\t\treturn this.setStartBefore(node).setEndAfter(node);\r\n\t},\r\n\tselectNodeContents : function(node) {\r\n\t\tvar knode = K(node);\r\n\t\tif (knode.type == 3 || knode.isSingle()) {\r\n\t\t\treturn this.selectNode(node);\r\n\t\t}\r\n\t\tvar children = knode.children();\r\n\t\tif (children.length > 0) {\r\n\t\t\treturn this.setStartBefore(children[0]).setEndAfter(children[children.length - 1]);\r\n\t\t}\r\n\t\treturn this.setStart(node, 0).setEnd(node, 0);\r\n\t},\r\n\tcollapse : function(toStart) {\r\n\t\tif (toStart) {\r\n\t\t\treturn this.setEnd(this.startContainer, this.startOffset);\r\n\t\t}\r\n\t\treturn this.setStart(this.endContainer, this.endOffset);\r\n\t},\r\n\tcompareBoundaryPoints : function(how, range) {\r\n\t\tvar rangeA = this.get(), rangeB = range.get();\r\n\t\tif (_IERANGE) {\r\n\t\t\tvar arr = {};\r\n\t\t\tarr[_START_TO_START] = 'StartToStart';\r\n\t\t\tarr[_START_TO_END] = 'EndToStart';\r\n\t\t\tarr[_END_TO_END] = 'EndToEnd';\r\n\t\t\tarr[_END_TO_START] = 'StartToEnd';\r\n\t\t\tvar cmp = rangeA.compareEndPoints(arr[how], rangeB);\r\n\t\t\tif (cmp !== 0) {\r\n\t\t\t\treturn cmp;\r\n\t\t\t}\r\n\t\t\tvar nodeA, nodeB, nodeC, posA, posB;\r\n\t\t\tif (how === _START_TO_START || how === _END_TO_START) {\r\n\t\t\t\tnodeA = this.startContainer;\r\n\t\t\t\tposA = this.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_END || how === _END_TO_END) {\r\n\t\t\t\tnodeA = this.endContainer;\r\n\t\t\t\tposA = this.endOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _START_TO_START || how === _START_TO_END) {\r\n\t\t\t\tnodeB = range.startContainer;\r\n\t\t\t\tposB = range.startOffset;\r\n\t\t\t}\r\n\t\t\tif (how === _END_TO_END || how === _END_TO_START) {\r\n\t\t\t\tnodeB = range.endContainer;\r\n\t\t\t\tposB = range.endOffset;\r\n\t\t\t}\r\n\t\t\tif (nodeA === nodeB) {\r\n\t\t\t\tvar diff = posA - posB;\r\n\t\t\t\treturn diff > 0 ? 1 : (diff < 0 ? -1 : 0);\r\n\t\t\t}\r\n\t\t\tnodeC = nodeB;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeA) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posA ? -1 : 1;\r\n\t\t\t}\r\n\t\t\tnodeC = nodeA;\r\n\t\t\twhile (nodeC && nodeC.parentNode !== nodeB) {\r\n\t\t\t\tnodeC = nodeC.parentNode;\r\n\t\t\t}\r\n\t\t\tif (nodeC) {\r\n\t\t\t\treturn K(nodeC).index() >= posB ? 1 : -1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeB).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeA)) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\tnodeC = K(nodeA).next();\r\n\t\t\tif (nodeC && nodeC.contains(nodeB)) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn rangeA.compareBoundaryPoints(how, rangeB);\r\n\t\t}\r\n\t},\r\n\tcloneRange : function() {\r\n\t\treturn new KRange(this.doc).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset);\r\n\t},\r\n\ttoString : function() {\r\n\t\tvar rng = this.get(), str = _IERANGE ? rng.text : rng.toString();\r\n\t\treturn str.replace(/\\r\\n|\\n|\\r/g, '');\r\n\t},\r\n\tcloneContents : function() {\r\n\t\treturn _copyAndDelete(this, true, false);\r\n\t},\r\n\tdeleteContents : function() {\r\n\t\treturn _copyAndDelete(this, false, true);\r\n\t},\r\n\textractContents : function() {\r\n\t\treturn _copyAndDelete(this, true, true);\r\n\t},\r\n\tinsertNode : function(node) {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset,\r\n\t\t\tfirstChild, lastChild, c, nodeCount = 1;\r\n\t\tif (node.nodeName.toLowerCase() === '#document-fragment') {\r\n\t\t\tfirstChild = node.firstChild;\r\n\t\t\tlastChild = node.lastChild;\r\n\t\t\tnodeCount = node.childNodes.length;\r\n\t\t}\r\n\t\tif (sc.nodeType == 1) {\r\n\t\t\tc = sc.childNodes[so];\r\n\t\t\tif (c) {\r\n\t\t\t\tsc.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsc.appendChild(node);\r\n\t\t\t}\r\n\t\t} else if (sc.nodeType == 3) {\r\n\t\t\tif (so === 0) {\r\n\t\t\t\tsc.parentNode.insertBefore(node, sc);\r\n\t\t\t\tif (sc.parentNode === ec) {\r\n\t\t\t\t\teo += nodeCount;\r\n\t\t\t\t}\r\n\t\t\t} else if (so >= sc.nodeValue.length) {\r\n\t\t\t\tif (sc.nextSibling) {\r\n\t\t\t\t\tsc.parentNode.insertBefore(node, sc.nextSibling);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsc.parentNode.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (so > 0) {\r\n\t\t\t\t\tc = sc.splitText(so);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tc = sc;\r\n\t\t\t\t}\r\n\t\t\t\tsc.parentNode.insertBefore(node, c);\r\n\t\t\t\tif (sc === ec) {\r\n\t\t\t\t\tec = c;\r\n\t\t\t\t\teo -= so;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (firstChild) {\r\n\t\t\tself.setStartBefore(firstChild).setEndAfter(lastChild);\r\n\t\t} else {\r\n\t\t\tself.selectNode(node);\r\n\t\t}\r\n\t\tif (self.compareBoundaryPoints(_END_TO_END, self.cloneRange().setEnd(ec, eo)) >= 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.setEnd(ec, eo);\r\n\t},\r\n\tsurroundContents : function(node) {\r\n\t\tnode.appendChild(this.extractContents());\r\n\t\treturn this.insertNode(node).selectNode(node);\r\n\t},\r\n\tisControl : function() {\r\n\t\tvar self = this,\r\n\t\t\tsc = self.startContainer, so = self.startOffset,\r\n\t\t\tec = self.endContainer, eo = self.endOffset, rng;\r\n\t\treturn sc.nodeType == 1 && sc === ec && so + 1 === eo && K(sc.childNodes[so]).isControl();\r\n\t},\r\n\tget : function(hasControlRange) {\r\n\t\tvar self = this, doc = self.doc, node, rng;\r\n\t\tif (!_IERANGE) {\r\n\t\t\trng = doc.createRange();\r\n\t\t\ttry {\r\n\t\t\t\trng.setStart(self.startContainer, self.startOffset);\r\n\t\t\t\trng.setEnd(self.endContainer, self.endOffset);\r\n\t\t\t} catch (e) {}\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tif (hasControlRange && self.isControl()) {\r\n\t\t\trng = doc.body.createControlRange();\r\n\t\t\trng.addElement(self.startContainer.childNodes[self.startOffset]);\r\n\t\t\treturn rng;\r\n\t\t}\r\n\t\tvar range = self.cloneRange().down();\r\n\t\trng = doc.body.createTextRange();\r\n\t\trng.setEndPoint('StartToStart', _getEndRange(range.startContainer, range.startOffset));\r\n\t\trng.setEndPoint('EndToStart', _getEndRange(range.endContainer, range.endOffset));\r\n\t\treturn rng;\r\n\t},\r\n\thtml : function() {\r\n\t\treturn K(this.cloneContents()).outer();\r\n\t},\r\n\tdown : function() {\r\n\t\tvar self = this;\r\n\t\tfunction downPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar children = K(node).children();\r\n\t\t\tif (children.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar left, right, child, offset;\r\n\t\t\tif (pos > 0) {\r\n\t\t\t\tleft = children.eq(pos - 1);\r\n\t\t\t}\r\n\t\t\tif (pos < children.length) {\r\n\t\t\t\tright = children.eq(pos);\r\n\t\t\t}\r\n\t\t\tif (left && left.type == 3) {\r\n\t\t\t\tchild = left[0];\r\n\t\t\t\toffset = child.nodeValue.length;\r\n\t\t\t}\r\n\t\t\tif (right && right.type == 3) {\r\n\t\t\t\tchild = right[0];\r\n\t\t\t\toffset = 0;\r\n\t\t\t}\r\n\t\t\tif (!child) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tself.setStart(child, offset);\r\n\t\t\t} else {\r\n\t\t\t\tself.setEnd(child, offset);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdownPos(self.startContainer, self.startOffset, true);\r\n\t\tdownPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tup : function() {\r\n\t\tvar self = this;\r\n\t\tfunction upPos(node, pos, isStart) {\r\n\t\t\tif (node.nodeType != 3) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(node);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == node.nodeValue.length) {\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tupPos(self.startContainer, self.startOffset, true);\r\n\t\tupPos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tenlarge : function(toBlock) {\r\n\t\tvar self = this;\r\n\t\tself.up();\r\n\t\tfunction enlargePos(node, pos, isStart) {\r\n\t\t\tvar knode = K(node), parent;\r\n\t\t\tif (knode.type == 3 || _NOSPLIT_TAG_MAP[knode.name] || !toBlock && knode.isBlock()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pos === 0) {\r\n\t\t\t\twhile (!knode.prev()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartBefore(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndBefore(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (pos == knode.children().length) {\r\n\t\t\t\twhile (!knode.next()) {\r\n\t\t\t\t\tparent = knode.parent();\r\n\t\t\t\t\tif (!parent || _NOSPLIT_TAG_MAP[parent.name] || !toBlock && parent.isBlock()) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tknode = parent;\r\n\t\t\t\t}\r\n\t\t\t\tif (isStart) {\r\n\t\t\t\t\tself.setStartAfter(knode[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.setEndAfter(knode[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tenlargePos(self.startContainer, self.startOffset, true);\r\n\t\tenlargePos(self.endContainer, self.endOffset, false);\r\n\t\treturn self;\r\n\t},\r\n\tshrink : function() {\r\n\t\tvar self = this, child, collapsed = self.collapsed;\r\n\t\twhile (self.startContainer.nodeType == 1 && (child = self.startContainer.childNodes[self.startOffset]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setStart(child, 0);\r\n\t\t}\r\n\t\tif (collapsed) {\r\n\t\t\treturn self.collapse(collapsed);\r\n\t\t}\r\n\t\twhile (self.endContainer.nodeType == 1 && self.endOffset > 0 && (child = self.endContainer.childNodes[self.endOffset - 1]) && child.nodeType == 1 && !K(child).isSingle()) {\r\n\t\t\tself.setEnd(child, child.childNodes.length);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tcreateBookmark : function(serialize) {\r\n\t\tvar self = this, doc = self.doc, endNode,\r\n\t\t\tstartNode = K('<span style=\"display:none;\"></span>', doc)[0];\r\n\t\tstartNode.id = '__kindeditor_bookmark_start_' + (_BOOKMARK_ID++) + '__';\r\n\t\tif (!self.collapsed) {\r\n\t\t\tendNode = startNode.cloneNode(true);\r\n\t\t\tendNode.id = '__kindeditor_bookmark_end_' + (_BOOKMARK_ID++) + '__';\r\n\t\t}\r\n\t\tif (endNode) {\r\n\t\t\tself.cloneRange().collapse(false).insertNode(endNode).setEndBefore(endNode);\r\n\t\t}\r\n\t\tself.insertNode(startNode).setStartAfter(startNode);\r\n\t\treturn {\r\n\t\t\tstart : serialize ? '#' + startNode.id : startNode,\r\n\t\t\tend : endNode ? (serialize ? '#' + endNode.id : endNode) : null\r\n\t\t};\r\n\t},\r\n\tmoveToBookmark : function(bookmark) {\r\n\t\tvar self = this, doc = self.doc,\r\n\t\t\tstart = K(bookmark.start, doc), end = bookmark.end ? K(bookmark.end, doc) : null;\r\n\t\tif (!start || start.length < 1) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.setStartBefore(start[0]);\r\n\t\tstart.remove();\r\n\t\tif (end && end.length > 0) {\r\n\t\t\tself.setEndBefore(end[0]);\r\n\t\t\tend.remove();\r\n\t\t} else {\r\n\t\t\tself.collapse(true);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdump : function() {\r\n\t\tconsole.log('--------------------');\r\n\t\tconsole.log(this.startContainer.nodeType == 3 ? this.startContainer.nodeValue : this.startContainer, this.startOffset);\r\n\t\tconsole.log(this.endContainer.nodeType == 3 ? this.endContainer.nodeValue : this.endContainer, this.endOffset);\r\n\t}\r\n});\r\nfunction _range(mixed) {\r\n\tif (!mixed.nodeName) {\r\n\t\treturn mixed.constructor === KRange ? mixed : _toRange(mixed);\r\n\t}\r\n\treturn new KRange(mixed);\r\n}\r\nK.RangeClass = KRange;\r\nK.range = _range;\r\nK.START_TO_START = _START_TO_START;\r\nK.START_TO_END = _START_TO_END;\r\nK.END_TO_END = _END_TO_END;\r\nK.END_TO_START = _END_TO_START;\r\n\r\n\r\r\nfunction _nativeCommand(doc, key, val) {\r\n\ttry {\r\n\t\tdoc.execCommand(key, false, val);\r\n\t} catch(e) {}\r\n}\r\r\nfunction _nativeCommandValue(doc, key) {\r\n\tvar val = '';\r\n\ttry {\r\n\t\tval = doc.queryCommandValue(key);\r\n\t} catch (e) {}\r\n\tif (typeof val !== 'string') {\r\n\t\tval = '';\r\n\t}\r\n\treturn val;\r\n}\r\r\nfunction _getSel(doc) {\r\n\tvar win = _getWin(doc);\r\n\treturn _IERANGE ? doc.selection : win.getSelection();\r\n}\r\r\nfunction _getRng(doc) {\r\n\tvar sel = _getSel(doc), rng;\r\n\ttry {\r\n\t\tif (sel.rangeCount > 0) {\r\n\t\t\trng = sel.getRangeAt(0);\r\n\t\t} else {\r\n\t\t\trng = sel.createRange();\r\n\t\t}\r\n\t} catch(e) {}\r\n\tif (_IERANGE && (!rng || (!rng.item && rng.parentElement().ownerDocument !== doc))) {\r\n\t\treturn null;\r\n\t}\r\n\treturn rng;\r\n}\r\r\nfunction _singleKeyMap(map) {\r\n\tvar newMap = {}, arr, v;\r\n\t_each(map, function(key, val) {\r\n\t\tarr = key.split(',');\r\n\t\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\t\tv = arr[i];\r\n\t\t\tnewMap[v] = val;\r\n\t\t}\r\n\t});\r\n\treturn newMap;\r\n}\r\r\nfunction _hasAttrOrCss(knode, map) {\r\n\treturn _hasAttrOrCssByKey(knode, map, '*') || _hasAttrOrCssByKey(knode, map);\r\n}\r\nfunction _hasAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn false;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(',');\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tvar method = match[1] ? 'css' : 'attr';\r\n\t\tkey = match[2];\r\n\t\tvar val = match[3] || '';\r\n\t\tif (val === '' && knode[method](key) !== '') {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (val !== '' && knode[method](key) === val) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction _removeAttrOrCss(knode, map) {\r\n\tif (knode.type != 1) {\r\n\t\treturn;\r\n\t}\r\n\t_removeAttrOrCssByKey(knode, map, '*');\r\n\t_removeAttrOrCssByKey(knode, map);\r\n}\r\nfunction _removeAttrOrCssByKey(knode, map, mapKey) {\r\n\tmapKey = mapKey || knode.name;\r\n\tif (knode.type !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tvar newMap = _singleKeyMap(map);\r\n\tif (!newMap[mapKey]) {\r\n\t\treturn;\r\n\t}\r\n\tvar arr = newMap[mapKey].split(','), allFlag = false;\r\n\tfor (var i = 0, len = arr.length; i < len; i++) {\r\n\t\tvar key = arr[i];\r\n\t\tif (key === '*') {\r\n\t\t\tallFlag = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tvar match = /^(\\.?)([^=]+)(?:=([^=]*))?$/.exec(key);\r\n\t\tkey = match[2];\r\n\t\tif (match[1]) {\r\n\t\t\tkey = _toCamel(key);\r\n\t\t\tif (knode[0].style[key]) {\r\n\t\t\t\tknode[0].style[key] = '';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tknode.removeAttr(key);\r\n\t\t}\r\n\t}\r\n\tif (allFlag) {\r\n\t\tknode.remove(true);\r\n\t}\r\n}\r\r\nfunction _getInnerNode(knode) {\r\n\tvar inner = knode;\r\n\twhile (inner.first()) {\r\n\t\tinner = inner.first();\r\n\t}\r\n\treturn inner;\r\n}\r\r\nfunction _isEmptyNode(knode) {\r\n\tif (knode.type != 1 || knode.isSingle()) {\r\n\t\treturn false;\r\n\t}\r\n\treturn knode.html().replace(/<[^>]+>/g, '') === '';\r\n}\r\r\r\r\r\nfunction _mergeWrapper(a, b) {\r\n\ta = a.clone(true);\r\n\tvar lastA = _getInnerNode(a), childA = a, merged = false;\r\n\twhile (b) {\r\n\t\twhile (childA) {\r\n\t\t\tif (childA.name === b.name) {\r\n\t\t\t\t_mergeAttrs(childA, b.attr(), b.css());\r\n\t\t\t\tmerged = true;\r\n\t\t\t}\r\n\t\t\tchildA = childA.first();\r\n\t\t}\r\n\t\tif (!merged) {\r\n\t\t\tlastA.append(b.clone(false));\r\n\t\t}\r\n\t\tmerged = false;\r\n\t\tb = b.first();\r\n\t}\r\n\treturn a;\r\n}\r\r\nfunction _wrapNode(knode, wrapper) {\r\n\twrapper = wrapper.clone(true);\r\n\tif (knode.type == 3) {\r\n\t\t_getInnerNode(wrapper).append(knode.clone(false));\r\n\t\tknode.replaceWith(wrapper);\r\n\t\treturn wrapper;\r\n\t}\r\n\tvar nodeWrapper = knode, child;\r\n\twhile ((child = knode.first()) && child.children().length == 1) {\r\n\t\tknode = child;\r\n\t}\r\n\tchild = knode.first();\r\n\tvar frag = knode.doc.createDocumentFragment();\r\n\twhile (child) {\r\n\t\tfrag.appendChild(child[0]);\r\n\t\tchild = child.next();\r\n\t}\r\n\twrapper = _mergeWrapper(nodeWrapper, wrapper);\r\n\tif (frag.firstChild) {\r\n\t\t_getInnerNode(wrapper).append(frag);\r\n\t}\r\n\tnodeWrapper.replaceWith(wrapper);\r\n\treturn wrapper;\r\n}\r\r\nfunction _mergeAttrs(knode, attrs, styles) {\r\n\t_each(attrs, function(key, val) {\r\n\t\tif (key !== 'style') {\r\n\t\t\tknode.attr(key, val);\r\n\t\t}\r\n\t});\r\n\t_each(styles, function(key, val) {\r\n\t\tknode.css(key, val);\r\n\t});\r\n}\r\r\nfunction _inPreElement(knode) {\r\n\twhile (knode && knode.name != 'body') {\r\n\t\tif (_PRE_TAG_MAP[knode.name] || knode.name == 'div' && knode.hasClass('ke-script')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tknode = knode.parent();\r\n\t}\r\n\treturn false;\r\n}\r\r\nfunction KCmd(range) {\r\n\tthis.init(range);\r\n}\r\n_extend(KCmd, {\r\n\tinit : function(range) {\r\n\t\tvar self = this, doc = range.doc;\r\n\t\tself.doc = doc;\r\n\t\tself.win = _getWin(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tself.range = range;\r\n\t},\r\n\tselection : function(forceReset) {\r\n\t\tvar self = this, doc = self.doc, rng = _getRng(doc);\r\n\t\tself.sel = _getSel(doc);\r\n\t\tif (rng) {\r\n\t\t\tself.range = _range(rng);\r\n\t\t\tif (K(self.range.startContainer).name == 'html') {\r\n\t\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (forceReset) {\r\n\t\t\tself.range.selectNodeContents(doc.body).collapse(false);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function(hasDummy) {\r\n\t\thasDummy = _undef(hasDummy, true);\r\n\t\tvar self = this, sel = self.sel, range = self.range.cloneRange().shrink(),\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tdoc = _getDoc(sc), win = self.win, rng, hasU200b = false;\r\n\t\tif (hasDummy && sc.nodeType == 1 && range.collapsed) {\r\n\t\t\tif (_IERANGE) {\r\n\t\t\t\tvar dummy = K('<span>&nbsp;</span>', doc);\r\n\t\t\t\trange.insertNode(dummy[0]);\r\n\t\t\t\trng = doc.body.createTextRange();\r\n\t\t\t\ttry {\r\n\t\t\t\t\trng.moveToElementText(dummy[0]);\r\n\t\t\t\t} catch(ex) {}\r\n\t\t\t\trng.collapse(false);\r\n\t\t\t\trng.select();\r\n\t\t\t\tdummy.remove();\r\n\t\t\t\twin.focus();\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tvar children = sc.childNodes;\r\n\t\t\t\tif (K(sc).isInline() || so > 0 && K(children[so - 1]).isInline() || children[so] && K(children[so]).isInline()) {\r\n\t\t\t\t\trange.insertNode(doc.createTextNode('\\u200B'));\r\n\t\t\t\t\thasU200b = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (_IERANGE) {\r\n\t\t\ttry {\r\n\t\t\t\trng = range.get(true);\r\n\t\t\t\trng.select();\r\n\t\t\t} catch(e) {}\r\n\t\t} else {\r\n\t\t\tif (hasU200b) {\r\n\t\t\t\trange.collapse(false);\r\n\t\t\t}\r\n\t\t\trng = range.get(true);\r\n\t\t\tsel.removeAllRanges();\r\n\t\t\tsel.addRange(rng);\r\n\t\t\tif (doc !== document) {\r\n\t\t\t\tvar pos = K(rng.endContainer).pos();\r\n\t\t\t\twin.scrollTo(pos.x, pos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\twin.focus();\r\n\t\treturn self;\r\n\t},\r\n\twrap : function(val) {\r\n\t\tvar self = this, doc = self.doc, range = self.range, wrapper;\r\n\t\twrapper = K(val, doc);\r\n\t\tif (range.collapsed) {\r\n\t\t\trange.shrink();\r\n\t\t\trange.insertNode(wrapper[0]).selectNodeContents(wrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (wrapper.isBlock()) {\r\n\t\t\tvar copyWrapper = wrapper.clone(true), child = copyWrapper;\r\n\t\t\twhile (child.first()) {\r\n\t\t\t\tchild = child.first();\r\n\t\t\t}\r\n\t\t\tchild.append(range.extractContents());\r\n\t\t\trange.insertNode(copyWrapper[0]).selectNode(copyWrapper[0]);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\trange.enlarge();\r\n\t\tvar bookmark = range.createBookmark(), ancestor = range.commonAncestor(), isStart = false;\r\n\t\tK(ancestor).scan(function(node) {\r\n\t\t\tif (!isStart && node == bookmark.start) {\r\n\t\t\t\tisStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isStart) {\r\n\t\t\t\tif (node == bookmark.end) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar knode = K(node);\r\n\t\t\t\tif (_inPreElement(knode)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.type == 3 && _trim(node.nodeValue).length > 0) {\r\n\t\t\t\t\tvar parent;\r\n\t\t\t\t\twhile ((parent = knode.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\t\t\tknode = parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_wrapNode(knode, wrapper);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tsplit : function(isStart, map) {\r\n\t\tvar range = this.range, doc = range.doc;\r\n\t\tvar tempRange = range.cloneRange().collapse(isStart);\r\n\t\tvar node = tempRange.startContainer, pos = tempRange.startOffset,\r\n\t\t\tparent = node.nodeType == 3 ? node.parentNode : node,\r\n\t\t\tneedSplit = false, knode;\r\n\t\twhile (parent && parent.parentNode) {\r\n\t\t\tknode = K(parent);\r\n\t\t\tif (map) {\r\n\t\t\t\tif (!knode.isStyle()) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (!_hasAttrOrCss(knode, map)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (_NOSPLIT_TAG_MAP[knode.name]) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tneedSplit = true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t\tif (needSplit) {\r\n\t\t\tvar dummy = doc.createElement('span');\r\n\t\t\trange.cloneRange().collapse(!isStart).insertNode(dummy);\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.setStartBefore(parent.firstChild).setEnd(node, pos);\r\n\t\t\t} else {\r\n\t\t\t\ttempRange.setStart(node, pos).setEndAfter(parent.lastChild);\r\n\t\t\t}\r\n\t\t\tvar frag = tempRange.extractContents(),\r\n\t\t\t\tfirst = frag.firstChild, last = frag.lastChild;\r\n\t\t\tif (isStart) {\r\n\t\t\t\ttempRange.insertNode(frag);\r\n\t\t\t\trange.setStartAfter(last).setEndBefore(dummy);\r\n\t\t\t} else {\r\n\t\t\t\tparent.appendChild(frag);\r\n\t\t\t\trange.setStartBefore(dummy).setEndBefore(first);\r\n\t\t\t}\r\n\t\t\tvar dummyParent = dummy.parentNode;\r\n\t\t\tif (dummyParent == range.endContainer) {\r\n\t\t\t\tvar prev = K(dummy).prev(), next = K(dummy).next();\r\n\t\t\t\tif (prev && next && prev.type == 3 && next.type == 3) {\r\n\t\t\t\t\trange.setEnd(prev[0], prev[0].nodeValue.length);\r\n\t\t\t\t} else if (!isStart) {\r\n\t\t\t\t\trange.setEnd(range.endContainer, range.endOffset - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdummyParent.removeChild(dummy);\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tremove : function(map) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\trange.enlarge();\r\n\t\tif (range.startOffset === 0) {\r\n\t\t\tvar ksc = K(range.startContainer), parent;\r\n\t\t\twhile ((parent = ksc.parent()) && parent.isStyle() && parent.children().length == 1) {\r\n\t\t\t\tksc = parent;\r\n\t\t\t}\r\n\t\t\trange.setStart(ksc[0], 0);\r\n\t\t\tksc = K(range.startContainer);\r\n\t\t\tif (ksc.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(ksc, map);\r\n\t\t\t}\r\n\t\t\tvar kscp = ksc.parent();\r\n\t\t\tif (kscp && kscp.isBlock()) {\r\n\t\t\t\t_removeAttrOrCss(kscp, map);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc, so;\r\n\t\tif (range.collapsed) {\r\n\t\t\tself.split(true, map);\r\n\t\t\tsc = range.startContainer;\r\n\t\t\tso = range.startOffset;\r\n\t\t\tif (so > 0) {\r\n\t\t\t\tvar sb = K(sc.childNodes[so - 1]);\r\n\t\t\t\tif (sb && _isEmptyNode(sb)) {\r\n\t\t\t\t\tsb.remove();\r\n\t\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sa = K(sc.childNodes[so]);\r\n\t\t\tif (sa && _isEmptyNode(sa)) {\r\n\t\t\t\tsa.remove();\r\n\t\t\t}\r\n\t\t\tif (_isEmptyNode(sc)) {\r\n\t\t\t\trange.startBefore(sc);\r\n\t\t\t\tsc.remove();\r\n\t\t\t}\r\n\t\t\trange.collapse(true);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.split(true, map);\r\n\t\tself.split(false, map);\r\n\t\tvar startDummy = doc.createElement('span'), endDummy = doc.createElement('span');\r\n\t\trange.cloneRange().collapse(false).insertNode(endDummy);\r\n\t\trange.cloneRange().collapse(true).insertNode(startDummy);\r\n\t\tvar nodeList = [], cmpStart = false;\r\n\t\tK(range.commonAncestor()).scan(function(node) {\r\n\t\t\tif (!cmpStart && node == startDummy) {\r\n\t\t\t\tcmpStart = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (node == endDummy) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (cmpStart) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(startDummy).remove();\r\n\t\tK(endDummy).remove();\r\n\t\tsc = range.startContainer;\r\n\t\tso = range.startOffset;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset;\r\n\t\tif (so > 0) {\r\n\t\t\tvar startBefore = K(sc.childNodes[so - 1]);\r\n\t\t\tif (startBefore && _isEmptyNode(startBefore)) {\r\n\t\t\t\tstartBefore.remove();\r\n\t\t\t\trange.setStart(sc, so - 1);\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar startAfter = K(sc.childNodes[so]);\r\n\t\t\tif (startAfter && _isEmptyNode(startAfter)) {\r\n\t\t\t\tstartAfter.remove();\r\n\t\t\t\tif (sc == ec) {\r\n\t\t\t\t\trange.setEnd(ec, eo - 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar endAfter = K(ec.childNodes[range.endOffset]);\r\n\t\tif (endAfter && _isEmptyNode(endAfter)) {\r\n\t\t\tendAfter.remove();\r\n\t\t}\r\n\t\tvar bookmark = range.createBookmark(true);\r\n\t\t_each(nodeList, function(i, node) {\r\n\t\t\t_removeAttrOrCss(K(node), map);\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tcommonNode : function(map) {\r\n\t\tvar range = this.range;\r\n\t\tvar ec = range.endContainer, eo = range.endOffset,\r\n\t\t\tnode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\tvar child = node, parent = node;\r\n\t\t\twhile (parent) {\r\n\t\t\t\tif (_hasAttrOrCss(K(parent), map)) {\r\n\t\t\t\t\treturn K(parent);\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t}\r\n\t\t\twhile (child && (child = child.lastChild)) {\r\n\t\t\t\tif (_hasAttrOrCss(K(child), map)) {\r\n\t\t\t\t\treturn K(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar cNode = find(node);\r\n\t\tif (cNode) {\r\n\t\t\treturn cNode;\r\n\t\t}\r\n\t\tif (node.nodeType == 1 || (ec.nodeType == 3 && eo === 0)) {\r\n\t\t\tvar prev = K(node).prev();\r\n\t\t\tif (prev) {\r\n\t\t\t\treturn find(prev);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tcommonAncestor : function(tagName) {\r\n\t\tvar range = this.range,\r\n\t\t\tsc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset,\r\n\t\t\tstartNode = (sc.nodeType == 3 || so === 0) ? sc : sc.childNodes[so - 1],\r\n\t\t\tendNode = (ec.nodeType == 3 || eo === 0) ? ec : ec.childNodes[eo - 1];\r\n\t\tfunction find(node) {\r\n\t\t\twhile (node) {\r\n\t\t\t\tif (node.nodeType == 1) {\r\n\t\t\t\t\tif (node.tagName.toLowerCase() === tagName) {\r\n\t\t\t\t\t\treturn node;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar start = find(startNode), end = find(endNode);\r\n\t\tif (start && end && start === end) {\r\n\t\t\treturn K(start);\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\tstate : function(key) {\r\n\t\tvar self = this, doc = self.doc, bool = false;\r\n\t\ttry {\r\n\t\t\tbool = doc.queryCommandState(key);\r\n\t\t} catch (e) {}\r\n\t\treturn bool;\r\n\t},\r\n\tval : function(key) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tfunction lc(val) {\r\n\t\t\treturn val.toLowerCase();\r\n\t\t}\r\n\t\tkey = lc(key);\r\n\t\tvar val = '', knode;\r\n\t\tif (key === 'fontfamily' || key === 'fontname') {\r\n\t\t\tval = _nativeCommandValue(doc, 'fontname');\r\n\t\t\tval = val.replace(/['\"]/g, '');\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'formatblock') {\r\n\t\t\tval = _nativeCommandValue(doc, key);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tknode = self.commonNode({'h1,h2,h3,h4,h5,h6,p,div,pre,address' : '*'});\r\n\t\t\t\tif (knode) {\r\n\t\t\t\t\tval = knode.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (val === 'Normal') {\r\n\t\t\t\tval = 'p';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'fontsize') {\r\n\t\t\tknode = self.commonNode({'*' : '.font-size'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('font-size');\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'forecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\tif (key === 'hilitecolor') {\r\n\t\t\tknode = self.commonNode({'*' : '.background-color'});\r\n\t\t\tif (knode) {\r\n\t\t\t\tval = knode.css('background-color');\r\n\t\t\t}\r\n\t\t\tval = _toHex(val);\r\n\t\t\tif (val === '') {\r\n\t\t\t\tval = 'default';\r\n\t\t\t}\r\n\t\t\treturn lc(val);\r\n\t\t}\r\n\t\treturn val;\r\n\t},\r\n\ttoggle : function(wrapper, map) {\r\n\t\tvar self = this;\r\n\t\tif (self.commonNode(map)) {\r\n\t\t\tself.remove(map);\r\n\t\t} else {\r\n\t\t\tself.wrap(wrapper);\r\n\t\t}\r\n\t\treturn self.select();\r\n\t},\r\n\tbold : function() {\r\n\t\treturn this.toggle('<strong></strong>', {\r\n\t\t\tspan : '.font-weight=bold',\r\n\t\t\tstrong : '*',\r\n\t\t\tb : '*'\r\n\t\t});\r\n\t},\r\n\titalic : function() {\r\n\t\treturn this.toggle('<em></em>', {\r\n\t\t\tspan : '.font-style=italic',\r\n\t\t\tem : '*',\r\n\t\t\ti : '*'\r\n\t\t});\r\n\t},\r\n\tunderline : function() {\r\n\t\treturn this.toggle('<u></u>', {\r\n\t\t\tspan : '.text-decoration=underline',\r\n\t\t\tu : '*'\r\n\t\t});\r\n\t},\r\n\tstrikethrough : function() {\r\n\t\treturn this.toggle('<s></s>', {\r\n\t\t\tspan : '.text-decoration=line-through',\r\n\t\t\ts : '*'\r\n\t\t});\r\n\t},\r\n\tforecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"color:' + val + ';\"></span>').select();\r\n\t},\r\n\thilitecolor : function(val) {\r\n\t\treturn this.wrap('<span style=\"background-color:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontsize : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-size:' + val + ';\"></span>').select();\r\n\t},\r\n\tfontname : function(val) {\r\n\t\treturn this.fontfamily(val);\r\n\t},\r\n\tfontfamily : function(val) {\r\n\t\treturn this.wrap('<span style=\"font-family:' + val + ';\"></span>').select();\r\n\t},\r\n\tremoveformat : function() {\r\n\t\tvar map = {\r\n\t\t\t'*' : '.font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent'\r\n\t\t},\r\n\t\ttags = _STYLE_TAG_MAP;\r\n\t\t_each(tags, function(key, val) {\r\n\t\t\tmap[key] = '*';\r\n\t\t});\r\n\t\tthis.remove(map);\r\n\t\treturn this.select();\r\n\t},\r\n\tinserthtml : function(val, quickMode) {\r\n\t\tvar self = this, range = self.range;\r\n\t\tif (val === '') {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tfunction pasteHtml(range, val) {\r\n\t\t\tval = '<img id=\"__kindeditor_temp_tag__\" width=\"0\" height=\"0\" style=\"display:none;\" />' + val;\r\n\t\t\tvar rng = range.get();\r\n\t\t\tif (rng.item) {\r\n\t\t\t\trng.item(0).outerHTML = val;\r\n\t\t\t} else {\r\n\t\t\t\trng.pasteHTML(val);\r\n\t\t\t}\r\n\t\t\tvar temp = range.doc.getElementById('__kindeditor_temp_tag__');\r\n\t\t\ttemp.parentNode.removeChild(temp);\r\n\t\t\tvar newRange = _toRange(rng);\r\n\t\t\trange.setEnd(newRange.endContainer, newRange.endOffset);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tfunction insertHtml(range, val) {\r\n\t\t\tvar doc = range.doc,\r\n\t\t\t\tfrag = doc.createDocumentFragment();\r\n\t\t\tK('@' + val, doc).each(function() {\r\n\t\t\t\tfrag.appendChild(this);\r\n\t\t\t});\r\n\t\t\trange.deleteContents();\r\n\t\t\trange.insertNode(frag);\r\n\t\t\trange.collapse(false);\r\n\t\t\tself.select(false);\r\n\t\t}\r\n\t\tif (_IERANGE && quickMode) {\r\n\t\t\ttry {\r\n\t\t\t\tpasteHtml(range, val);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tinsertHtml(range, val);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tinsertHtml(range, val);\r\n\t\treturn self;\r\n\t},\r\n\thr : function() {\r\n\t\treturn this.inserthtml('<hr />');\r\n\t},\r\n\tprint : function() {\r\n\t\tthis.win.print();\r\n\t\treturn this;\r\n\t},\r\n\tinsertimage : function(url, title, width, height, border, align) {\r\n\t\ttitle = _undef(title, '');\r\n\t\tborder = _undef(border, 0);\r\n\t\tvar html = '<img src=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (width) {\r\n\t\t\thtml += 'width=\"' + _escape(width) + '\" ';\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\thtml += 'height=\"' + _escape(height) + '\" ';\r\n\t\t}\r\n\t\tif (title) {\r\n\t\t\thtml += 'title=\"' + _escape(title) + '\" ';\r\n\t\t}\r\n\t\tif (align) {\r\n\t\t\thtml += 'align=\"' + _escape(align) + '\" ';\r\n\t\t}\r\n\t\thtml += 'alt=\"' + _escape(title) + '\" ';\r\n\t\thtml += '/>';\r\n\t\treturn this.inserthtml(html);\r\n\t},\r\n\tcreatelink : function(url, type) {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tvar a = self.commonNode({ a : '*' });\r\n\t\tif (a && !range.isControl()) {\r\n\t\t\trange.selectNode(a.get());\r\n\t\t\tself.select();\r\n\t\t}\r\n\t\tvar html = '<a href=\"' + _escape(url) + '\" data-ke-src=\"' + _escape(url) + '\" ';\r\n\t\tif (type) {\r\n\t\t\thtml += ' target=\"' + _escape(type) + '\"';\r\n\t\t}\r\n\t\tif (range.collapsed) {\r\n\t\t\thtml += '>' + _escape(url) + '</a>';\r\n\t\t\treturn self.inserthtml(html);\r\n\t\t}\r\n\t\tif (range.isControl()) {\r\n\t\t\tvar node = K(range.startContainer.childNodes[range.startOffset]);\r\n\t\t\thtml += '></a>';\r\n\t\t\tnode.after(K(html, doc));\r\n\t\t\tnode.next().append(node);\r\n\t\t\trange.selectNode(node[0]);\r\n\t\t\treturn self.select();\r\n\t\t}\r\n\t\tfunction setAttr(node, url, type) {\r\n\t\t\tK(node).attr('href', url).attr('data-ke-src', url);\r\n\t\t\tif (type) {\r\n\t\t\t\tK(node).attr('target', type);\r\n\t\t\t} else {\r\n\t\t\t\tK(node).removeAttr('target');\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sc = range.startContainer, so = range.startOffset,\r\n\t\t\tec = range.endContainer, eo = range.endOffset;\r\n\t\tif (sc.nodeType == 1 && sc === ec && so + 1 === eo) {\r\n\t\t\tvar child = sc.childNodes[so];\r\n\t\t\tif (child.nodeName.toLowerCase() == 'a') {\r\n\t\t\t\tsetAttr(child, url, type);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\t_nativeCommand(doc, 'createlink', '__kindeditor_temp_url__');\r\n\t\tK('a[href=\"__kindeditor_temp_url__\"]', doc).each(function() {\r\n\t\t\tsetAttr(this, url, type);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunlink : function() {\r\n\t\tvar self = this, doc = self.doc, range = self.range;\r\n\t\tself.select();\r\n\t\tif (range.collapsed) {\r\n\t\t\tvar a = self.commonNode({ a : '*' });\r\n\t\t\tif (a) {\r\n\t\t\t\trange.selectNode(a.get());\r\n\t\t\t\tself.select();\r\n\t\t\t}\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t\tif (_WEBKIT && K(range.startContainer).name === 'img') {\r\n\t\t\t\tvar parent = K(range.startContainer).parent();\r\n\t\t\t\tif (parent.name === 'a') {\r\n\t\t\t\t\tparent.remove(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t_nativeCommand(doc, 'unlink', null);\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\n_each(('formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t'insertunorderedlist,indent,outdent,subscript,superscript').split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function(val) {\r\n\t\tvar self = this;\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, val);\r\n\t\tif (_IERANGE && _inArray(name, 'justifyleft,justifycenter,justifyright,justifyfull'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\tif (!_IERANGE || _inArray(name, 'formatblock,selectall,insertorderedlist,insertunorderedlist'.split(',')) >= 0) {\r\n\t\t\tself.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t};\r\n});\r\n_each('cut,copy,paste'.split(','), function(i, name) {\r\n\tKCmd.prototype[name] = function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.doc.queryCommandSupported(name)) {\r\n\t\t\tthrow 'not supported';\r\n\t\t}\r\n\t\tself.select();\r\n\t\t_nativeCommand(self.doc, name, null);\r\n\t\treturn self;\r\n\t};\r\n});\r\nfunction _cmd(mixed) {\r\n\tif (mixed.nodeName) {\r\n\t\tvar doc = _getDoc(mixed);\r\n\t\tmixed = _range(doc).selectNodeContents(doc.body).collapse(false);\r\n\t}\r\n\treturn new KCmd(mixed);\r\n}\r\nK.CmdClass = KCmd;\r\nK.cmd = _cmd;\r\n\r\n\r\nfunction _drag(options) {\r\n\tvar moveEl = options.moveEl,\r\n\t\tmoveFn = options.moveFn,\r\n\t\tclickEl = options.clickEl || moveEl,\r\n\t\tbeforeDrag = options.beforeDrag,\r\n\t\tiframeFix = options.iframeFix === undefined ? true : options.iframeFix;\r\n\tvar docs = [document];\r\n\tif (iframeFix) {\r\n\t\tK('iframe').each(function() {\r\n\t\t\tvar src = _formatUrl(this.src || '', 'absolute');\r\n\t\t\tif (/^https?:\\/\\//.test(src)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar doc;\r\n\t\t\ttry {\r\n\t\t\t\tdoc = _iframeDoc(this);\r\n\t\t\t} catch(e) {}\r\n\t\t\tif (doc) {\r\n\t\t\t\tvar pos = K(this).pos();\r\n\t\t\t\tK(doc).data('pos-x', pos.x);\r\n\t\t\t\tK(doc).data('pos-y', pos.y);\r\n\t\t\t\tdocs.push(doc);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tclickEl.mousedown(function(e) {\r\n\t\te.stopPropagation();\r\n\t\tvar self = clickEl.get(),\r\n\t\t\tx = _removeUnit(moveEl.css('left')),\r\n\t\t\ty = _removeUnit(moveEl.css('top')),\r\n\t\t\twidth = moveEl.width(),\r\n\t\t\theight = moveEl.height(),\r\n\t\t\tpageX = e.pageX,\r\n\t\t\tpageY = e.pageY;\r\n\t\tif (beforeDrag) {\r\n\t\t\tbeforeDrag();\r\n\t\t}\r\n\t\tfunction moveListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar kdoc = K(_getDoc(e.target));\r\n\t\t\tvar diffX = _round((kdoc.data('pos-x') || 0) + e.pageX - pageX);\r\n\t\t\tvar diffY = _round((kdoc.data('pos-y') || 0) + e.pageY - pageY);\r\n\t\t\tmoveFn.call(clickEl, x, y, width, height, diffX, diffY);\r\n\t\t}\r\n\t\tfunction selectListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\tfunction upListener(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\tK(docs).unbind('mousemove', moveListener)\r\n\t\t\t\t.unbind('mouseup', upListener)\r\n\t\t\t\t.unbind('selectstart', selectListener);\r\n\t\t\tif (self.releaseCapture) {\r\n\t\t\t\tself.releaseCapture();\r\n\t\t\t}\r\n\t\t}\r\n\t\tK(docs).mousemove(moveListener)\r\n\t\t\t.mouseup(upListener)\r\n\t\t\t.bind('selectstart', selectListener);\r\n\t\tif (self.setCapture) {\r\n\t\t\tself.setCapture();\r\n\t\t}\r\n\t});\r\n}\r\n\r\r\nfunction KWidget(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tself.name = options.name || '';\r\n\t\tself.doc = options.doc || document;\r\n\t\tself.win = _getWin(self.doc);\r\n\t\tself.x = _addUnit(options.x);\r\n\t\tself.y = _addUnit(options.y);\r\n\t\tself.z = options.z;\r\n\t\tself.width = _addUnit(options.width);\r\n\t\tself.height = _addUnit(options.height);\r\n\t\tself.div = K('<div style=\"display:block;\"></div>');\r\n\t\tself.options = options;\r\n\t\tself._alignEl = options.alignEl;\r\n\t\tif (self.width) {\r\n\t\t\tself.div.css('width', self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.div.css('height', self.height);\r\n\t\t}\r\n\t\tif (self.z) {\r\n\t\t\tself.div.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : self.x,\r\n\t\t\t\ttop : self.y,\r\n\t\t\t\t'z-index' : self.z\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (self.z && (self.x === undefined || self.y === undefined)) {\r\n\t\t\tself.autoPos(self.width, self.height);\r\n\t\t}\r\n\t\tif (options.cls) {\r\n\t\t\tself.div.addClass(options.cls);\r\n\t\t}\r\n\t\tif (options.shadowMode) {\r\n\t\t\tself.div.addClass('ke-shadow');\r\n\t\t}\r\n\t\tif (options.css) {\r\n\t\t\tself.div.css(options.css);\r\n\t\t}\r\n\t\tif (options.src) {\r\n\t\t\tK(options.src).replaceWith(self.div);\r\n\t\t} else {\r\n\t\t\tK(self.doc.body).append(self.div);\r\n\t\t}\r\n\t\tif (options.html) {\r\n\t\t\tself.div.html(options.html);\r\n\t\t}\r\n\t\tif (options.autoScroll) {\r\n\t\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\t\tvar scrollPos = _getScrollPos();\r\n\t\t\t\tK(self.win).bind('scroll', function(e) {\r\n\t\t\t\t\tvar pos = _getScrollPos(),\r\n\t\t\t\t\t\tdiffX = pos.x - scrollPos.x,\r\n\t\t\t\t\t\tdiffY = pos.y - scrollPos.y;\r\n\t\t\t\t\tself.pos(_removeUnit(self.x) + diffX, _removeUnit(self.y) + diffY, false);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself.div.css('position', 'fixed');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tpos : function(x, y, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (x !== null) {\r\n\t\t\tx = x < 0 ? 0 : _addUnit(x);\r\n\t\t\tself.div.css('left', x);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.x = x;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (y !== null) {\r\n\t\t\ty = y < 0 ? 0 : _addUnit(y);\r\n\t\t\tself.div.css('top', y);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.y = y;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tautoPos : function(width, height) {\r\n\t\tvar self = this,\r\n\t\t\tw = _removeUnit(width) || 0,\r\n\t\t\th = _removeUnit(height) || 0,\r\n\t\t\tscrollPos = _getScrollPos();\r\n\t\tif (self._alignEl) {\r\n\t\t\tvar knode = K(self._alignEl),\r\n\t\t\t\tpos = knode.pos(),\r\n\t\t\t\tdiffX = _round(knode[0].clientWidth / 2 - w / 2),\r\n\t\t\t\tdiffY = _round(knode[0].clientHeight / 2 - h / 2);\r\n\t\t\tx = diffX < 0 ? pos.x : pos.x + diffX;\r\n\t\t\ty = diffY < 0 ? pos.y : pos.y + diffY;\r\n\t\t} else {\r\n\t\t\tvar docEl = _docElement(self.doc);\r\n\t\t\tx = _round(scrollPos.x + (docEl.clientWidth - w) / 2);\r\n\t\t\ty = _round(scrollPos.y + (docEl.clientHeight - h) / 2);\r\n\t\t}\r\n\t\tif (!(_IE && _V < 7 || _QUIRKS)) {\r\n\t\t\tx -= scrollPos.x;\r\n\t\t\ty -= scrollPos.y;\r\n\t\t}\r\n\t\treturn self.pos(x, y);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE && _V < 7 || _QUIRKS) {\r\n\t\t\tK(self.win).unbind('scroll');\r\n\t\t}\r\n\t\tself.div.remove();\r\n\t\t_each(self, function(i) {\r\n\t\t\tself[i] = null;\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\tshow : function() {\r\n\t\tthis.div.show();\r\n\t\treturn this;\r\n\t},\r\n\thide : function() {\r\n\t\tthis.div.hide();\r\n\t\treturn this;\r\n\t},\r\n\tdraggable : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions = options || {};\r\n\t\toptions.moveEl = self.div;\r\n\t\toptions.moveFn = function(x, y, width, height, diffX, diffY) {\r\n\t\t\tif ((x = x + diffX) < 0) {\r\n\t\t\t\tx = 0;\r\n\t\t\t}\r\n\t\t\tif ((y = y + diffY) < 0) {\r\n\t\t\t\ty = 0;\r\n\t\t\t}\r\n\t\t\tself.pos(x, y);\r\n\t\t};\r\n\t\t_drag(options);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _widget(options) {\r\n\treturn new KWidget(options);\r\n}\r\nK.WidgetClass = KWidget;\r\nK.widget = _widget;\r\n\r\n\r\nfunction _iframeDoc(iframe) {\r\n\tiframe = _get(iframe);\r\n\treturn iframe.contentDocument || iframe.contentWindow.document;\r\n}\r\nvar html, _direction = '';\r\nif ((html = document.getElementsByTagName('html'))) {\r\n\t_direction = html[0].dir;\r\n}\r\nfunction _getInitHtml(themesPath, bodyClass, cssPath, cssData) {\r\n\tvar arr = [\r\n\t\t(_direction === '' ? '<html>' : '<html dir=\"' + _direction + '\">'),\r\n\t\t'<head><meta charset=\"utf-8\" /><title></title>',\r\n\t\t'<style>',\r\n\t\t'html {margin:0;padding:0;}',\r\n\t\t'body {margin:0;padding:5px;}',\r\n\t\t'body, td {font:12px/1.5 \"sans serif\",tahoma,verdana,helvetica;}',\r\n\t\t'body, p, div {word-wrap: break-word;}',\r\n\t\t'p {margin:5px 0;}',\r\n\t\t'table {border-collapse:collapse;}',\r\n\t\t'img {border:0;}',\r\n\t\t'noscript {display:none;}',\r\n\t\t'table.ke-zeroborder td {border:1px dotted #AAA;}',\r\n\t\t'img.ke-flash {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/flash.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-rm {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/rm.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-media {',\r\n\t\t'\tborder:1px solid #AAA;',\r\n\t\t'\tbackground-image:url(' + themesPath + 'common/media.gif);',\r\n\t\t'\tbackground-position:center center;',\r\n\t\t'\tbackground-repeat:no-repeat;',\r\n\t\t'\twidth:100px;',\r\n\t\t'\theight:100px;',\r\n\t\t'}',\r\n\t\t'img.ke-anchor {',\r\n\t\t'\tborder:1px dashed #666;',\r\n\t\t'\twidth:16px;',\r\n\t\t'\theight:16px;',\r\n\t\t'}',\r\n\t\t'.ke-script, .ke-noscript, .ke-display-none {',\r\n\t\t'\tdisplay:none;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\twidth:0;',\r\n\t\t'\theight:0;',\r\n\t\t'}',\r\n\t\t'.ke-pagebreak {',\r\n\t\t'\tborder:1px dotted #AAA;',\r\n\t\t'\tfont-size:0;',\r\n\t\t'\theight:2px;',\r\n\t\t'}',\r\n\t\t'</style>'\r\n\t];\r\n\tif (!_isArray(cssPath)) {\r\n\t\tcssPath = [cssPath];\r\n\t}\r\n\t_each(cssPath, function(i, path) {\r\n\t\tif (path) {\r\n\t\t\tarr.push('<link href=\"' + path + '\" rel=\"stylesheet\" />');\r\n\t\t}\r\n\t});\r\n\tif (cssData) {\r\n\t\tarr.push('<style>' + cssData + '</style>');\r\n\t}\r\n\tarr.push('</head><body ' + (bodyClass ? 'class=\"' + bodyClass + '\"' : '') + '></body></html>');\r\n\treturn arr.join('\\n');\r\n}\r\nfunction _elementVal(knode, val) {\r\n\tif (knode.hasVal()) {\r\n\t\tif (val === undefined) {\r\n\t\t\tvar html = knode.val();\r\n\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\treturn html;\r\n\t\t}\r\n\t\treturn knode.val(val);\r\n\t}\r\n\treturn knode.html(val);\r\n}\r\n\r\r\nfunction KEdit(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KEdit, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKEdit.parent.init.call(self, options);\r\n\t\tself.srcElement = K(options.srcElement);\r\n\t\tself.div.addClass('ke-edit');\r\n\t\tself.designMode = _undef(options.designMode, true);\r\n\t\tself.beforeGetHtml = options.beforeGetHtml;\r\n\t\tself.beforeSetHtml = options.beforeSetHtml;\r\n\t\tself.afterSetHtml = options.afterSetHtml;\r\n\t\tvar themesPath = _undef(options.themesPath, ''),\r\n\t\t\tbodyClass = options.bodyClass,\r\n\t\t\tcssPath = options.cssPath,\r\n\t\t\tcssData = options.cssData,\r\n\t\t\tisDocumentDomain = location.protocol != 'res:' && location.host.replace(/:\\d+/, '') !== document.domain,\r\n\t\t\tsrcScript = ('document.open();' +\r\n\t\t\t\t(isDocumentDomain ? 'document.domain=\"' + document.domain + '\";' : '') +\r\n\t\t\t\t'document.close();'),\r\n\t\t\tiframeSrc = _IE ? ' src=\"javascript:void(function(){' + encodeURIComponent(srcScript) + '}())\"' : '';\r\n\t\tself.iframe = K('<iframe class=\"ke-edit-iframe\" hidefocus=\"true\" frameborder=\"0\"' + iframeSrc + '></iframe>').css('width', '100%');\r\n\t\tself.textarea = K('<textarea class=\"ke-edit-textarea\" hidefocus=\"true\"></textarea>').css('width', '100%');\r\n\t\tself.tabIndex = isNaN(parseInt(options.tabIndex, 10)) ? self.srcElement.attr('tabindex') : parseInt(options.tabIndex, 10);\r\n\t\tself.iframe.attr('tabindex', self.tabIndex);\r\n\t\tself.textarea.attr('tabindex', self.tabIndex);\r\n\t\tif (self.width) {\r\n\t\t\tself.setWidth(self.width);\r\n\t\t}\r\n\t\tif (self.height) {\r\n\t\t\tself.setHeight(self.height);\r\n\t\t}\r\n\t\tif (self.designMode) {\r\n\t\t\tself.textarea.hide();\r\n\t\t} else {\r\n\t\t\tself.iframe.hide();\r\n\t\t}\r\n\t\tfunction ready() {\r\n\t\t\tvar doc = _iframeDoc(self.iframe);\r\n\t\t\tdoc.open();\r\n\t\t\tif (isDocumentDomain) {\r\n\t\t\t\tdoc.domain = document.domain;\r\n\t\t\t}\r\n\t\t\tdoc.write(_getInitHtml(themesPath, bodyClass, cssPath, cssData));\r\n\t\t\tdoc.close();\r\n\t\t\tself.win = self.iframe[0].contentWindow;\r\n\t\t\tself.doc = doc;\r\n\t\t\tvar cmd = _cmd(doc);\r\n\t\t\tself.afterChange(function(e) {\r\n\t\t\t\tcmd.selection();\r\n\t\t\t});\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK(doc).click(function(e) {\r\n\t\t\t\t\tif (K(e.target).name === 'img') {\r\n\t\t\t\t\t\tcmd.selection(true);\r\n\t\t\t\t\t\tcmd.range.selectNode(e.target);\r\n\t\t\t\t\t\tcmd.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (_IE) {\r\n\t\t\t\tself._mousedownHandler = function() {\r\n\t\t\t\t\tvar newRange = cmd.range.cloneRange();\r\n\t\t\t\t\tnewRange.shrink();\r\n\t\t\t\t\tif (newRange.isControl()) {\r\n\t\t\t\t\t\tself.blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(document).mousedown(self._mousedownHandler);\r\n\t\t\t\tK(doc).keydown(function(e) {\r\n\t\t\t\t\tif (e.which == 8) {\r\n\t\t\t\t\t\tcmd.selection();\r\n\t\t\t\t\t\tvar rng = cmd.range;\r\n\t\t\t\t\t\tif (rng.isControl()) {\r\n\t\t\t\t\t\t\trng.collapse(true);\r\n\t\t\t\t\t\t\tK(rng.startContainer.childNodes[rng.startOffset]).remove();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tself.cmd = cmd;\r\n\t\t\tself.html(_elementVal(self.srcElement));\r\n\t\t\tif (_IE) {\r\n\t\t\t\tdoc.body.disabled = true;\r\n\t\t\t\tdoc.body.contentEditable = true;\r\n\t\t\t\tdoc.body.removeAttribute('disabled');\r\n\t\t\t} else {\r\n\t\t\t\tdoc.designMode = 'on';\r\n\t\t\t}\r\n\t\t\tif (options.afterCreate) {\r\n\t\t\t\toptions.afterCreate.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (isDocumentDomain) {\r\n\t\t\tself.iframe.bind('load', function(e) {\r\n\t\t\t\tself.iframe.unbind('load');\r\n\t\t\t\tif (_IE) {\r\n\t\t\t\t\tready();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.div.append(self.iframe);\r\n\t\tself.div.append(self.textarea);\r\n\t\tself.srcElement.hide();\r\n\t\t!isDocumentDomain && ready();\r\n\t},\r\n\tsetWidth : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.width = val;\r\n\t\tself.div.css('width', val);\r\n\t\treturn self;\r\n\t},\r\n\tsetHeight : function(val) {\r\n\t\tvar self = this;\r\n\t\tval = _addUnit(val);\r\n\t\tself.height = val;\r\n\t\tself.div.css('height', val);\r\n\t\tself.iframe.css('height', val);\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\tval = _addUnit(_removeUnit(val) - 2);\r\n\t\t}\r\n\t\tself.textarea.css('height', val);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tK(doc.body).unbind();\r\n\t\tK(doc).unbind();\r\n\t\tK(self.win).unbind();\r\n\t\tif (self._mousedownHandler) {\r\n\t\t\tK(document).unbind('mousedown', self._mousedownHandler);\r\n\t\t}\r\n\t\t_elementVal(self.srcElement, self.html());\r\n\t\tself.srcElement.show();\r\n\t\tself.iframe.unbind();\r\n\t\tself.textarea.unbind();\r\n\t\tKEdit.parent.remove.call(self);\r\n\t},\r\n\thtml : function(val, isFull) {\r\n\t\tvar self = this, doc = self.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tvar body = doc.body;\r\n\t\t\tif (val === undefined) {\r\n\t\t\t\tif (isFull) {\r\n\t\t\t\t\tval = '<!doctype html><html>' + body.parentNode.innerHTML + '</html>';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tval = body.innerHTML;\r\n\t\t\t\t}\r\n\t\t\t\tif (self.beforeGetHtml) {\r\n\t\t\t\t\tval = self.beforeGetHtml(val);\r\n\t\t\t\t}\r\n\t\t\t\tif (_GECKO && val == '<br />') {\r\n\t\t\t\t\tval = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t\tif (self.beforeSetHtml) {\r\n\t\t\t\tval = self.beforeSetHtml(val);\r\n\t\t\t}\r\n\t\t\tif (_IE && _V >= 9) {\r\n\t\t\t\tval = val.replace(/(<.*?checked=\")checked(\".*>)/ig, '$1$2');\r\n\t\t\t}\r\n\t\t\tK(body).html(val);\r\n\t\t\tif (self.afterSetHtml) {\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.textarea.val();\r\n\t\t}\r\n\t\tself.textarea.val(val);\r\n\t\treturn self;\r\n\t},\r\n\tdesign : function(bool) {\r\n\t\tvar self = this, val;\r\n\t\tif (bool === undefined ? !self.designMode : bool) {\r\n\t\t\tif (!self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = true;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.textarea.hide();\r\n\t\t\t\tself.iframe.show();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (self.designMode) {\r\n\t\t\t\tval = self.html();\r\n\t\t\t\tself.designMode = false;\r\n\t\t\t\tself.html(val);\r\n\t\t\t\tself.iframe.hide();\r\n\t\t\t\tself.textarea.show();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self.focus();\r\n\t},\r\n\tfocus : function() {\r\n\t\tvar self = this;\r\n\t\tself.designMode ? self.win.focus() : self.textarea[0].focus();\r\n\t\treturn self;\r\n\t},\r\n\tblur : function() {\r\n\t\tvar self = this;\r\n\t\tif (_IE) {\r\n\t\t\tvar input = K('<input type=\"text\" style=\"float:left;width:0;height:0;padding:0;margin:0;border:0;\" value=\"\" />', self.div);\r\n\t\t\tself.div.append(input);\r\n\t\t\tinput[0].focus();\r\n\t\t\tinput.remove();\r\n\t\t} else {\r\n\t\t\tself.designMode ? self.win.blur() : self.textarea[0].blur();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tafterChange : function(fn) {\r\n\t\tvar self = this, doc = self.doc, body = doc.body;\r\n\t\tK(doc).keyup(function(e) {\r\n\t\t\tif (!e.ctrlKey && !e.altKey && _CHANGE_KEY_MAP[e.which]) {\r\n\t\t\t\tfn(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK(doc).mouseup(fn).contextmenu(fn);\r\n\t\tK(self.win).blur(fn);\r\n\t\tfunction timeoutHandler(e) {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tfn(e);\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t\tK(body).bind('paste', timeoutHandler);\r\n\t\tK(body).bind('cut', timeoutHandler);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _edit(options) {\r\n\treturn new KEdit(options);\r\n}\r\nK.EditClass = KEdit;\r\nK.edit = _edit;\r\nK.iframeDoc = _iframeDoc;\r\n\r\n\r\nfunction _selectToolbar(name, fn) {\r\n\tvar self = this,\r\n\t\tknode = self.get(name);\r\n\tif (knode) {\r\n\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfn(knode);\r\n\t}\r\n}\r\n\r\r\nfunction KToolbar(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KToolbar, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tKToolbar.parent.init.call(self, options);\r\n\t\tself.disableMode = _undef(options.disableMode, false);\r\n\t\tself.noDisableItemMap = _toMap(_undef(options.noDisableItems, []));\r\n\t\tself._itemMap = {};\r\n\t\tself.div.addClass('ke-toolbar').bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tfunction find(target) {\r\n\t\t\tvar knode = K(target);\r\n\t\t\tif (knode.hasClass('ke-outline')) {\r\n\t\t\t\treturn knode;\r\n\t\t\t}\r\n\t\t\tif (knode.hasClass('ke-toolbar-icon')) {\r\n\t\t\t\treturn knode.parent();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction hover(e, method) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (knode.hasClass('ke-selected')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tknode[method]('ke-on');\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.div.mouseover(function(e) {\r\n\t\t\thover(e, 'addClass');\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\thover(e, 'removeClass');\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\tvar knode = find(e.target);\r\n\t\t\tif (knode) {\r\n\t\t\t\tif (knode.hasClass('ke-disabled')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.options.click.call(this, e, knode.attr('data-name'));\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tget : function(name) {\r\n\t\tif (this._itemMap[name]) {\r\n\t\t\treturn this._itemMap[name];\r\n\t\t}\r\n\t\treturn (this._itemMap[name] = K('span.ke-icon-' + name, this.div).parent());\r\n\t},\r\n\tselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.addClass('ke-selected');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tunselect : function(name) {\r\n\t\t_selectToolbar.call(this, name, function(knode) {\r\n\t\t\tknode.removeClass('ke-selected').removeClass('ke-on');\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\tenable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-disabled');\r\n\t\t\tknode.opacity(1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisable : function(name) {\r\n\t\tvar self = this,\r\n\t\t\tknode = name.get ? name : self.get(name);\r\n\t\tif (knode) {\r\n\t\t\tknode.removeClass('ke-selected').addClass('ke-disabled');\r\n\t\t\tknode.opacity(0.5);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tdisableAll : function(bool, noDisableItems) {\r\n\t\tvar self = this, map = self.noDisableItemMap, item;\r\n\t\tif (noDisableItems) {\r\n\t\t\tmap = _toMap(noDisableItems);\r\n\t\t}\r\n\t\tif (bool === undefined ? !self.disableMode : bool) {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.disable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = true;\r\n\t\t} else {\r\n\t\t\tK('span.ke-outline', self.div).each(function() {\r\n\t\t\t\tvar knode = K(this),\r\n\t\t\t\t\tname = knode[0].getAttribute('data-name', 2);\r\n\t\t\t\tif (!map[name]) {\r\n\t\t\t\t\tself.enable(knode);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.disableMode = false;\r\n\t\t}\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _toolbar(options) {\r\n\treturn new KToolbar(options);\r\n}\r\nK.ToolbarClass = KToolbar;\r\nK.toolbar = _toolbar;\r\n\r\n\r\r\nfunction KMenu(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KMenu, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKMenu.parent.init.call(self, options);\r\n\t\tself.centerLineMode = _undef(options.centerLineMode, true);\r\n\t\tself.div.addClass('ke-menu').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t},\r\n\taddItem : function(item) {\r\n\t\tvar self = this;\r\n\t\tif (item.title === '-') {\r\n\t\t\tself.div.append(K('<div class=\"ke-menu-separator\"></div>'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar itemDiv = K('<div class=\"ke-menu-item\" unselectable=\"on\"></div>'),\r\n\t\t\tleftDiv = K('<div class=\"ke-inline-block ke-menu-item-left\"></div>'),\r\n\t\t\trightDiv = K('<div class=\"ke-inline-block ke-menu-item-right\"></div>'),\r\n\t\t\theight = _addUnit(item.height),\r\n\t\t\ticonClass = _undef(item.iconClass, '');\r\n\t\tself.div.append(itemDiv);\r\n\t\tif (height) {\r\n\t\t\titemDiv.css('height', height);\r\n\t\t\trightDiv.css('line-height', height);\r\n\t\t}\r\n\t\tvar centerDiv;\r\n\t\tif (self.centerLineMode) {\r\n\t\t\tcenterDiv = K('<div class=\"ke-inline-block ke-menu-item-center\"></div>');\r\n\t\t\tif (height) {\r\n\t\t\t\tcenterDiv.css('height', height);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemDiv.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.addClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-menu-item-on');\r\n\t\t\tif (centerDiv) {\r\n\t\t\t\tcenterDiv.removeClass('ke-menu-item-center-on');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.click(function(e) {\r\n\t\t\titem.click.call(K(this));\r\n\t\t\te.stopPropagation();\r\n\t\t})\r\n\t\t.append(leftDiv);\r\n\t\tif (centerDiv) {\r\n\t\t\titemDiv.append(centerDiv);\r\n\t\t}\r\n\t\titemDiv.append(rightDiv);\r\n\t\tif (item.checked) {\r\n\t\t\ticonClass = 'ke-icon-checked';\r\n\t\t}\r\n\t\tif (iconClass !== '') {\r\n\t\t\tleftDiv.html('<span class=\"ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ' + iconClass + '\"></span>');\r\n\t\t}\r\n\t\trightDiv.html(item.title);\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tK('.ke-menu-item', self.div[0]).unbind();\r\n\t\tKMenu.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _menu(options) {\r\n\treturn new KMenu(options);\r\n}\r\nK.MenuClass = KMenu;\r\nK.menu = _menu;\r\n\r\n\r\r\nfunction KColorPicker(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KColorPicker, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.z = options.z || 811213;\r\n\t\tKColorPicker.parent.init.call(self, options);\r\n\t\tvar colors = options.colors || [\r\n\t\t\t['#E53333', '#E56600', '#FF9900', '#64451D', '#DFC5A4', '#FFE500'],\r\n\t\t\t['#009900', '#006600', '#99BB00', '#B8D100', '#60D978', '#00D5FF'],\r\n\t\t\t['#337FE5', '#003399', '#4C33E5', '#9933E5', '#CC33E5', '#EE33EE'],\r\n\t\t\t['#FFFFFF', '#CCCCCC', '#999999', '#666666', '#333333', '#000000']\r\n\t\t];\r\n\t\tself.selectedColor = (options.selectedColor || '').toLowerCase();\r\n\t\tself._cells = [];\r\n\t\tself.div.addClass('ke-colorpicker').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t}).attr('unselectable', 'on');\r\n\t\tvar table = self.doc.createElement('table');\r\n\t\tself.div.append(table);\r\n\t\ttable.className = 'ke-colorpicker-table';\r\n\t\ttable.cellPadding = 0;\r\n\t\ttable.cellSpacing = 0;\r\n\t\ttable.border = 0;\r\n\t\tvar row = table.insertRow(0), cell = row.insertCell(0);\r\n\t\tcell.colSpan = colors[0].length;\r\n\t\tself._addAttr(cell, '', 'ke-colorpicker-cell-top');\r\n\t\tfor (var i = 0; i < colors.length; i++) {\r\n\t\t\trow = table.insertRow(i + 1);\r\n\t\t\tfor (var j = 0; j < colors[i].length; j++) {\r\n\t\t\t\tcell = row.insertCell(j);\r\n\t\t\t\tself._addAttr(cell, colors[i][j], 'ke-colorpicker-cell');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_addAttr : function(cell, color, cls) {\r\n\t\tvar self = this;\r\n\t\tcell = K(cell).addClass(cls);\r\n\t\tif (self.selectedColor === color.toLowerCase()) {\r\n\t\t\tcell.addClass('ke-colorpicker-cell-selected');\r\n\t\t}\r\n\t\tcell.attr('title', color || self.options.noColor);\r\n\t\tcell.mouseover(function(e) {\r\n\t\t\tK(this).addClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.mouseout(function(e) {\r\n\t\t\tK(this).removeClass('ke-colorpicker-cell-on');\r\n\t\t});\r\n\t\tcell.click(function(e) {\r\n\t\t\te.stop();\r\n\t\t\tself.options.click.call(K(this), color);\r\n\t\t});\r\n\t\tif (color) {\r\n\t\t\tcell.append(K('<div class=\"ke-colorpicker-cell-color\" unselectable=\"on\"></div>').css('background-color', color));\r\n\t\t} else {\r\n\t\t\tcell.html(self.options.noColor);\r\n\t\t}\r\n\t\tK(cell).attr('unselectable', 'on');\r\n\t\tself._cells.push(cell);\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\t_each(self._cells, function() {\r\n\t\t\tthis.unbind();\r\n\t\t});\r\n\t\tKColorPicker.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _colorpicker(options) {\r\n\treturn new KColorPicker(options);\r\n}\r\nK.ColorPickerClass = KColorPicker;\r\nK.colorpicker = _colorpicker;\r\n\r\n\r\nfunction KUploadButton(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KUploadButton, {\r\n\tinit : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tbutton = K(options.button),\r\n\t\t\tfieldName = options.fieldName || 'file',\r\n\t\t\turl = options.url || '',\r\n\t\t\ttitle = button.val(),\r\n\t\t\textraParams = options.extraParams || {},\r\n\t\t\tcls = button[0].className || '',\r\n\t\t\ttarget = options.target || 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div class=\"ke-inline-block ' + cls + '\">',\r\n\t\t\t(options.target ? '' : '<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>'),\r\n\t\t\t(options.form ? '<div class=\"ke-upload-area\">' : '<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + url + '\">'),\r\n\t\t\t'<span class=\"ke-button-common\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + title + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'<input type=\"file\" class=\"ke-upload-file\" name=\"' + fieldName + '\" tabindex=\"-1\" />',\r\n\t\t\t(options.form ? '</div>' : '</form>'),\r\n\t\t\t'</div>'].join('');\r\n\t\tvar div = K(html, button.doc);\r\n\t\tbutton.hide();\r\n\t\tbutton.before(div);\r\n\t\tself.div = div;\r\n\t\tself.button = button;\r\n\t\tself.iframe = options.target ? K('iframe[name=\"' + target + '\"]') : K('iframe', div);\r\n\t\tself.form = options.form ? K(options.form) : K('form', div);\r\n\t\tself.fileBox = K('.ke-upload-file', div);\r\n\t\tvar width = options.width || K('.ke-button-common', div).width();\r\n\t\tK('.ke-upload-area', div).width(width);\r\n\t\tself.options = options;\r\n\t},\r\n\tsubmit : function() {\r\n\t\tvar self = this,\r\n\t\t\tiframe = self.iframe;\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind();\r\n\t\t\tvar tempForm = document.createElement('form');\r\n\t\t\tself.fileBox.before(tempForm);\r\n\t\t\tK(tempForm).append(self.fileBox);\r\n\t\t\ttempForm.reset();\r\n\t\t\tK(tempForm).remove(true);\r\n\t\t\tvar doc = K.iframeDoc(iframe),\r\n\t\t\t\tpre = doc.getElementsByTagName('pre')[0],\r\n\t\t\t\tstr = '', data;\r\n\t\t\tif (pre) {\r\n\t\t\t\tstr = pre.innerHTML;\r\n\t\t\t} else {\r\n\t\t\t\tstr = doc.body.innerHTML;\r\n\t\t\t}\r\n\t\t\tstr = _unescape(str);\r\n\t\t\tiframe[0].src = 'javascript:false';\r\n\t\t\ttry {\r\n\t\t\t\tdata = K.json(str);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tself.options.afterError.call(self, '<!doctype html><html>' + doc.body.parentNode.innerHTML + '</html>');\r\n\t\t\t}\r\n\t\t\tif (data) {\r\n\t\t\t\tself.options.afterUpload.call(self, data);\r\n\t\t\t}\r\n\t\t});\r\n\t\tself.form[0].submit();\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.fileBox) {\r\n\t\t\tself.fileBox.unbind();\r\n\t\t}\r\n\t\tself.iframe.remove();\r\n\t\tself.div.remove();\r\n\t\tself.button.show();\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _uploadbutton(options) {\r\n\treturn new KUploadButton(options);\r\n}\r\nK.UploadButtonClass = KUploadButton;\r\nK.uploadbutton = _uploadbutton;\r\n\r\n\r\nfunction _createButton(arg) {\r\n\targ = arg || {};\r\n\tvar name = arg.name || '',\r\n\t\tspan = K('<span class=\"ke-button-common ke-button-outer\" title=\"' + name + '\"></span>'),\r\n\t\tbtn = K('<input class=\"ke-button-common ke-button\" type=\"button\" value=\"' + name + '\" />');\r\n\tif (arg.click) {\r\n\t\tbtn.click(arg.click);\r\n\t}\r\n\tspan.append(btn);\r\n\treturn span;\r\n}\r\n\r\r\nfunction KDialog(options) {\r\n\tthis.init(options);\r\n}\r\n_extend(KDialog, KWidget, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\tvar shadowMode = _undef(options.shadowMode, true);\r\n\t\toptions.z = options.z || 811213;\r\n\t\toptions.shadowMode = false;\r\n\t\toptions.autoScroll = _undef(options.autoScroll, true);\r\n\t\tKDialog.parent.init.call(self, options);\r\n\t\tvar title = options.title,\r\n\t\t\tbody = K(options.body, self.doc),\r\n\t\t\tpreviewBtn = options.previewBtn,\r\n\t\t\tyesBtn = options.yesBtn,\r\n\t\t\tnoBtn = options.noBtn,\r\n\t\t\tcloseBtn = options.closeBtn,\r\n\t\t\tshowMask = _undef(options.showMask, true);\r\n\t\tself.div.addClass('ke-dialog').bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tvar contentDiv = K('<div class=\"ke-dialog-content\"></div>').appendTo(self.div);\r\n\t\tif (_IE && _V < 7) {\r\n\t\t\tself.iframeMask = K('<iframe src=\"about:blank\" class=\"ke-dialog-shadow\"></iframe>').appendTo(self.div);\r\n\t\t} else if (shadowMode) {\r\n\t\t\tK('<div class=\"ke-dialog-shadow\"></div>').appendTo(self.div);\r\n\t\t}\r\n\t\tvar headerDiv = K('<div class=\"ke-dialog-header\"></div>');\r\n\t\tcontentDiv.append(headerDiv);\r\n\t\theaderDiv.html(title);\r\n\t\tself.closeIcon = K('<span class=\"ke-dialog-icon-close\" title=\"' + closeBtn.name + '\"></span>').click(closeBtn.click);\r\n\t\theaderDiv.append(self.closeIcon);\r\n\t\tself.draggable({\r\n\t\t\tclickEl : headerDiv,\r\n\t\t\tbeforeDrag : options.beforeDrag\r\n\t\t});\r\n\t\tvar bodyDiv = K('<div class=\"ke-dialog-body\"></div>');\r\n\t\tcontentDiv.append(bodyDiv);\r\n\t\tbodyDiv.append(body);\r\n\t\tvar footerDiv = K('<div class=\"ke-dialog-footer\"></div>');\r\n\t\tif (previewBtn || yesBtn || noBtn) {\r\n\t\t\tcontentDiv.append(footerDiv);\r\n\t\t}\r\n\t\t_each([\r\n\t\t\t{ btn : previewBtn, name : 'preview' },\r\n\t\t\t{ btn : yesBtn, name : 'yes' },\r\n\t\t\t{ btn : noBtn, name : 'no' }\r\n\t\t], function() {\r\n\t\t\tif (this.btn) {\r\n\t\t\t\tvar button = _createButton(this.btn);\r\n\t\t\t\tbutton.addClass('ke-dialog-' + this.name);\r\n\t\t\t\tfooterDiv.append(button);\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.height) {\r\n\t\t\tbodyDiv.height(_removeUnit(self.height) - headerDiv.height() - footerDiv.height());\r\n\t\t}\r\n\t\tself.div.width(self.div.width());\r\n\t\tself.div.height(self.div.height());\r\n\t\tself.mask = null;\r\n\t\tif (showMask) {\r\n\t\t\tvar docEl = _docElement(self.doc),\r\n\t\t\t\tdocWidth = Math.max(docEl.scrollWidth, docEl.clientWidth),\r\n\t\t\t\tdocHeight = Math.max(docEl.scrollHeight, docEl.clientHeight);\r\n\t\t\tself.mask = _widget({\r\n\t\t\t\tx : 0,\r\n\t\t\t\ty : 0,\r\n\t\t\t\tz : self.z - 1,\r\n\t\t\t\tcls : 'ke-dialog-mask',\r\n\t\t\t\twidth : docWidth,\r\n\t\t\t\theight : docHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.autoPos(self.div.width(), self.div.height());\r\n\t\tself.footerDiv = footerDiv;\r\n\t\tself.bodyDiv = bodyDiv;\r\n\t\tself.headerDiv = headerDiv;\r\n\t\tself.isLoading = false;\r\n\t},\r\n\tsetMaskIndex : function(z) {\r\n\t\tvar self = this;\r\n\t\tself.mask.div.css('z-index', z);\r\n\t},\r\n\tshowLoading : function(msg) {\r\n\t\tmsg = _undef(msg, '');\r\n\t\tvar self = this, body = self.bodyDiv;\r\n\t\tself.loading = K('<div class=\"ke-dialog-loading\"><div class=\"ke-inline-block ke-dialog-loading-content\" style=\"margin-top:' + Math.round(body.height() / 3) + 'px;\">' + msg + '</div></div>')\r\n\t\t\t.width(body.width()).height(body.height())\r\n\t\t\t.css('top', self.headerDiv.height() + 'px');\r\n\t\tbody.css('visibility', 'hidden').after(self.loading);\r\n\t\tself.isLoading = true;\r\n\t\treturn self;\r\n\t},\r\n\thideLoading : function() {\r\n\t\tthis.loading && this.loading.remove();\r\n\t\tthis.bodyDiv.css('visibility', 'visible');\r\n\t\tthis.isLoading = false;\r\n\t\treturn this;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.options.beforeRemove) {\r\n\t\t\tself.options.beforeRemove.call(self);\r\n\t\t}\r\n\t\tself.mask && self.mask.remove();\r\n\t\tself.iframeMask && self.iframeMask.remove();\r\n\t\tself.closeIcon.unbind();\r\n\t\tK('input', self.div).unbind();\r\n\t\tK('button', self.div).unbind();\r\n\t\tself.footerDiv.unbind();\r\n\t\tself.bodyDiv.unbind();\r\n\t\tself.headerDiv.unbind();\r\n\t\tK('iframe', self.div).each(function() {\r\n\t\t\tK(this).remove();\r\n\t\t});\r\n\t\tKDialog.parent.remove.call(self);\r\n\t\treturn self;\r\n\t}\r\n});\r\nfunction _dialog(options) {\r\n\treturn new KDialog(options);\r\n}\r\nK.DialogClass = KDialog;\r\nK.dialog = _dialog;\r\n\r\n\r\nfunction _tabs(options) {\r\n\tvar self = _widget(options),\r\n\t\tremove = self.remove,\r\n\t\tafterSelect = options.afterSelect,\r\n\t\tdiv = self.div,\r\n\t\tliList = [];\r\n\tdiv.addClass('ke-tabs')\r\n\t\t.bind('contextmenu,mousedown,mousemove', function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n\tvar ul = K('<ul class=\"ke-tabs-ul ke-clearfix\"></ul>');\r\n\tdiv.append(ul);\r\n\tself.add = function(tab) {\r\n\t\tvar li = K('<li class=\"ke-tabs-li\">' + tab.title + '</li>');\r\n\t\tli.data('tab', tab);\r\n\t\tliList.push(li);\r\n\t\tul.append(li);\r\n\t};\r\n\tself.selectedIndex = 0;\r\n\tself.select = function(index) {\r\n\t\tself.selectedIndex = index;\r\n\t\t_each(liList, function(i, li) {\r\n\t\t\tli.unbind();\r\n\t\t\tif (i === index) {\r\n\t\t\t\tli.addClass('ke-tabs-li-selected');\r\n\t\t\t\tK(li.data('tab').panel).show('');\r\n\t\t\t} else {\r\n\t\t\t\tli.removeClass('ke-tabs-li-selected').removeClass('ke-tabs-li-on')\r\n\t\t\t\t.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function() {\r\n\t\t\t\t\tK(this).removeClass('ke-tabs-li-on');\r\n\t\t\t\t})\r\n\t\t\t\t.click(function() {\r\n\t\t\t\t\tself.select(i);\r\n\t\t\t\t});\r\n\t\t\t\tK(li.data('tab').panel).hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (afterSelect) {\r\n\t\t\tafterSelect.call(self, index);\r\n\t\t}\r\n\t};\r\n\tself.remove = function() {\r\n\t\t_each(liList, function() {\r\n\t\t\tthis.remove();\r\n\t\t});\r\n\t\tul.remove();\r\n\t\tremove.call(self);\r\n\t};\r\n\treturn self;\r\n}\r\nK.tabs = _tabs;\r\n\r\n\r\nfunction _loadScript(url, fn) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tscript = document.createElement('script');\r\n\thead.appendChild(script);\r\n\tscript.src = url;\r\n\tscript.charset = 'utf-8';\r\n\tscript.onload = script.onreadystatechange = function() {\r\n\t\tif (!this.readyState || this.readyState === 'loaded') {\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn();\r\n\t\t\t}\r\n\t\t\tscript.onload = script.onreadystatechange = null;\r\n\t\t\thead.removeChild(script);\r\n\t\t}\r\n\t};\r\n}\r\n\r\r\nfunction _chopQuery(url) {\r\n\tvar index = url.indexOf('?');\r\n\treturn index > 0 ? url.substr(0, index) : url;\r\n}\r\nfunction _loadStyle(url) {\r\n\tvar head = document.getElementsByTagName('head')[0] || (_QUIRKS ? document.body : document.documentElement),\r\n\t\tlink = document.createElement('link'),\r\n\t\tabsoluteUrl = _chopQuery(_formatUrl(url, 'absolute'));\r\n\tvar links = K('link[rel=\"stylesheet\"]', head);\r\n\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\t\tif (_chopQuery(_formatUrl(links[i].href, 'absolute')) === absoluteUrl) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\thead.appendChild(link);\r\n\tlink.href = url;\r\n\tlink.rel = 'stylesheet';\r\n}\r\nfunction _ajax(url, fn, method, param, dataType) {\r\n\tmethod = method || 'GET';\r\n\tdataType = dataType || 'json';\r\n\tvar xhr = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');\r\n\txhr.open(method, url, true);\r\n\txhr.onreadystatechange = function () {\r\n\t\tif (xhr.readyState == 4 && xhr.status == 200) {\r\n\t\t\tif (fn) {\r\n\t\t\t\tvar data = _trim(xhr.responseText);\r\n\t\t\t\tif (dataType == 'json') {\r\n\t\t\t\t\tdata = _json(data);\r\n\t\t\t\t}\r\n\t\t\t\tfn(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (method == 'POST') {\r\n\t\tvar params = [];\r\n\t\t_each(param, function(key, val) {\r\n\t\t\tparams.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\r\n\t\t});\r\n\t\ttry {\r\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n\t\t} catch (e) {}\r\n\t\txhr.send(params.join('&'));\r\n\t} else {\r\n\t\txhr.send(null);\r\n\t}\r\n}\r\nK.loadScript = _loadScript;\r\nK.loadStyle = _loadStyle;\r\nK.ajax = _ajax;\r\n\r\n\r\nvar _plugins = {};\r\nfunction _plugin(name, fn) {\r\n\tif (name === undefined) {\r\n\t\treturn _plugins;\r\n\t}\r\n\tif (!fn) {\r\n\t\treturn _plugins[name];\r\n\t}\r\n\t_plugins[name] = fn;\r\n}\r\nvar _language = {};\r\nfunction _parseLangKey(key) {\r\n\tvar match, ns = 'core';\r\n\tif ((match = /^(\\w+)\\.(\\w+)$/.exec(key))) {\r\n\t\tns = match[1];\r\n\t\tkey = match[2];\r\n\t}\r\n\treturn { ns : ns, key : key };\r\n}\r\nfunction _lang(mixed, langType) {\r\n\tlangType = langType === undefined ? K.options.langType : langType;\r\n\tif (typeof mixed === 'string') {\r\n\t\tif (!_language[langType]) {\r\n\t\t\treturn 'no language';\r\n\t\t}\r\n\t\tvar pos = mixed.length - 1;\r\n\t\tif (mixed.substr(pos) === '.') {\r\n\t\t\treturn _language[langType][mixed.substr(0, pos)];\r\n\t\t}\r\n\t\tvar obj = _parseLangKey(mixed);\r\n\t\treturn _language[langType][obj.ns][obj.key];\r\n\t}\r\n\t_each(mixed, function(key, val) {\r\n\t\tvar obj = _parseLangKey(key);\r\n\t\tif (!_language[langType]) {\r\n\t\t\t_language[langType] = {};\r\n\t\t}\r\n\t\tif (!_language[langType][obj.ns]) {\r\n\t\t\t_language[langType][obj.ns] = {};\r\n\t\t}\r\n\t\t_language[langType][obj.ns][obj.key] = val;\r\n\t});\r\n}\r\n\r\r\nfunction _getImageFromRange(range, fn) {\r\n\tif (range.collapsed) {\r\n\t\treturn;\r\n\t}\r\n\trange = range.cloneRange().up();\r\n\tvar sc = range.startContainer, so = range.startOffset;\r\n\tif (!_WEBKIT && !range.isControl()) {\r\n\t\treturn;\r\n\t}\r\n\tvar img = K(sc.childNodes[so]);\r\n\tif (!img || img.name != 'img') {\r\n\t\treturn;\r\n\t}\r\n\tif (fn(img)) {\r\n\t\treturn img;\r\n\t}\r\n}\r\nfunction _bindContextmenuEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).contextmenu(function(e) {\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\tif (!self.useContextmenu) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (self._contextmenus.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar maxWidth = 0, items = [];\r\n\t\t_each(self._contextmenus, function() {\r\n\t\t\tif (this.title == '-') {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.cond && this.cond()) {\r\n\t\t\t\titems.push(this);\r\n\t\t\t\tif (this.width && this.width > maxWidth) {\r\n\t\t\t\t\tmaxWidth = this.width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\twhile (items.length > 0 && items[0].title == '-') {\r\n\t\t\titems.shift();\r\n\t\t}\r\n\t\twhile (items.length > 0 && items[items.length - 1].title == '-') {\r\n\t\t\titems.pop();\r\n\t\t}\r\n\t\tvar prevItem = null;\r\n\t\t_each(items, function(i) {\r\n\t\t\tif (this.title == '-' && prevItem.title == '-') {\r\n\t\t\t\tdelete items[i];\r\n\t\t\t}\r\n\t\t\tprevItem = this;\r\n\t\t});\r\n\t\tif (items.length > 0) {\r\n\t\t\te.preventDefault();\r\n\t\t\tvar pos = K(self.edit.iframe).pos(),\r\n\t\t\t\tmenu = _menu({\r\n\t\t\t\t\tx : pos.x + e.clientX,\r\n\t\t\t\t\ty : pos.y + e.clientY,\r\n\t\t\t\t\twidth : maxWidth,\r\n\t\t\t\t\tcss : { visibility: 'hidden' },\r\n\t\t\t\t\tshadowMode : self.shadowMode\r\n\t\t\t\t});\r\n\t\t\t_each(items, function() {\r\n\t\t\t\tif (this.title) {\r\n\t\t\t\t\tmenu.addItem(this);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar docEl = _docElement(menu.doc),\r\n\t\t\t\tmenuHeight = menu.div.height();\r\n\t\t\tif (e.clientY + menuHeight >= docEl.clientHeight - 100) {\r\n\t\t\t\tmenu.pos(menu.x, _removeUnit(menu.y) - menuHeight);\r\n\t\t\t}\r\n\t\t\tmenu.div.css('visibility', 'visible');\r\n\t\t\tself.menu = menu;\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindNewlineEvent() {\r\n\tvar self = this, doc = self.edit.doc, newlineTag = self.newlineTag;\r\n\tif (_IE && newlineTag !== 'br') {\r\n\t\treturn;\r\n\t}\r\n\tif (_GECKO && _V < 3 && newlineTag !== 'p') {\r\n\t\treturn;\r\n\t}\r\n\tif (_OPERA && _V < 9) {\r\n\t\treturn;\r\n\t}\r\n\tvar brSkipTagMap = _toMap('h1,h2,h3,h4,h5,h6,pre,li'),\r\n\t\tpSkipTagMap = _toMap('p,h1,h2,h3,h4,h5,h6,pre,li,blockquote');\r\n\tfunction getAncestorTagName(range) {\r\n\t\tvar ancestor = K(range.commonAncestor());\r\n\t\twhile (ancestor) {\r\n\t\t\tif (ancestor.type == 1 && !ancestor.isStyle()) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tancestor = ancestor.parent();\r\n\t\t}\r\n\t\treturn ancestor.name;\r\n\t}\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag === 'br' && !brSkipTagMap[tagName]) {\r\n\t\t\te.preventDefault();\r\n\t\t\tself.insertHtml('<br />' + (_IE && _V < 9 ? '' : '\\u200B'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t});\r\n\tK(doc).keyup(function(e) {\r\n\t\tif (e.which != 13 || e.shiftKey || e.ctrlKey || e.altKey) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (newlineTag == 'br') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (_GECKO) {\r\n\t\t\tvar root = self.cmd.commonAncestor('p');\r\n\t\t\tvar a = self.cmd.commonAncestor('a');\r\n\t\t\tif (a && a.text() == '') {\r\n\t\t\t\ta.remove(true);\r\n\t\t\t\tself.cmd.range.selectNodeContents(root[0]).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tself.cmd.selection();\r\n\t\tvar tagName = getAncestorTagName(self.cmd.range);\r\n\t\tif (tagName == 'marquee' || tagName == 'select') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!pSkipTagMap[tagName]) {\r\n\t\t\t_nativeCommand(doc, 'formatblock', '<p>');\r\n\t\t}\r\n\t\tvar div = self.cmd.commonAncestor('div');\r\n\t\tif (div) {\r\n\t\t\tvar p = K('<p></p>'),\r\n\t\t\t\tchild = div[0].firstChild;\r\n\t\t\twhile (child) {\r\n\t\t\t\tvar next = child.nextSibling;\r\n\t\t\t\tp.append(child);\r\n\t\t\t\tchild = next;\r\n\t\t\t}\r\n\t\t\tdiv.before(p);\r\n\t\t\tdiv.remove();\r\n\t\t\tself.cmd.range.selectNodeContents(p[0]);\r\n\t\t\tself.cmd.select();\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindTabEvent() {\r\n\tvar self = this, doc = self.edit.doc;\r\n\tK(doc).keydown(function(e) {\r\n\t\tif (e.which == 9) {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (self.afterTab) {\r\n\t\t\t\tself.afterTab.call(self, e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\t\trange.shrink();\r\n\t\t\tif (range.collapsed && range.startContainer.nodeType == 1) {\r\n\t\t\t\trange.insertNode(K('@&nbsp;', doc)[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tself.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\r\n\t\t}\r\n\t});\r\n}\r\nfunction _bindFocusEvent() {\r\n\tvar self = this;\r\n\tK(self.edit.textarea[0], self.edit.win).focus(function(e) {\r\n\t\tif (self.afterFocus) {\r\n\t\t\tself.afterFocus.call(self, e);\r\n\t\t}\r\n\t}).blur(function(e) {\r\n\t\tif (self.afterBlur) {\r\n\t\t\tself.afterBlur.call(self, e);\r\n\t\t}\r\n\t});\r\n}\r\nfunction _removeBookmarkTag(html) {\r\n\treturn _trim(html.replace(/<span [^>]*id=\"?__kindeditor_bookmark_\\w+_\\d+__\"?[^>]*><\\/span>/ig, ''));\r\n}\r\nfunction _removeTempTag(html) {\r\n\treturn html.replace(/<div[^>]+class=\"?__kindeditor_paste__\"?[^>]*>[\\s\\S]*?<\\/div>/ig, '');\r\n}\r\nfunction _addBookmarkToStack(stack, bookmark) {\r\n\tif (stack.length === 0) {\r\n\t\tstack.push(bookmark);\r\n\t\treturn;\r\n\t}\r\n\tvar prev = stack[stack.length - 1];\r\n\tif (_removeBookmarkTag(bookmark.html) !== _removeBookmarkTag(prev.html)) {\r\n\t\tstack.push(bookmark);\r\n\t}\r\n}\r\n\r\r\r\nfunction _undoToRedo(fromStack, toStack) {\r\n\tvar self = this, edit = self.edit,\r\n\t\tbody = edit.doc.body,\r\n\t\trange, bookmark;\r\n\tif (fromStack.length === 0) {\r\n\t\treturn self;\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\trange = self.cmd.range;\r\n\t\tbookmark = range.createBookmark(true);\r\n\t\tbookmark.html = body.innerHTML;\r\n\t} else {\r\n\t\tbookmark = {\r\n\t\t\thtml : body.innerHTML\r\n\t\t};\r\n\t}\r\n\t_addBookmarkToStack(toStack, bookmark);\r\n\tvar prev = fromStack.pop();\r\n\tif (_removeBookmarkTag(bookmark.html) === _removeBookmarkTag(prev.html) && fromStack.length > 0) {\r\n\t\tprev = fromStack.pop();\r\n\t}\r\n\tif (edit.designMode) {\r\n\t\tedit.html(prev.html);\r\n\t\tif (prev.start) {\r\n\t\t\trange.moveToBookmark(prev);\r\n\t\t\tself.select();\r\n\t\t}\r\n\t} else {\r\n\t\tK(body).html(_removeBookmarkTag(prev.html));\r\n\t}\r\n\treturn self;\r\n}\r\nfunction KEditor(options) {\r\n\tvar self = this;\r\n\tself.options = {};\r\n\tfunction setOption(key, val) {\r\n\t\tif (KEditor.prototype[key] === undefined) {\r\n\t\t\tself[key] = val;\r\n\t\t}\r\n\t\tself.options[key] = val;\r\n\t}\r\n\t_each(options, function(key, val) {\r\n\t\tsetOption(key, options[key]);\r\n\t});\r\n\t_each(K.options, function(key, val) {\r\n\t\tif (self[key] === undefined) {\r\n\t\t\tsetOption(key, val);\r\n\t\t}\r\n\t});\r\n\tvar se = K(self.srcElement || '<textarea/>');\r\n\tif (!self.width) {\r\n\t\tself.width = se[0].style.width || se.width();\r\n\t}\r\n\tif (!self.height) {\r\n\t\tself.height = se[0].style.height || se.height();\r\n\t}\r\n\tsetOption('width', _undef(self.width, self.minWidth));\r\n\tsetOption('height', _undef(self.height, self.minHeight));\r\n\tsetOption('width', _addUnit(self.width));\r\n\tsetOption('height', _addUnit(self.height));\r\n\tif (_MOBILE && (!_IOS || _V < 534)) {\r\n\t\tself.designMode = false;\r\n\t}\r\n\tself.srcElement = se;\r\n\tself.initContent = '';\r\n\tself.plugin = {};\r\n\tself.isCreated = false;\r\n\tself._handlers = {};\r\n\tself._contextmenus = [];\r\n\tself._undoStack = [];\r\n\tself._redoStack = [];\r\n\tself._firstAddBookmark = true;\r\n\tself.menu = self.contextmenu = null;\r\n\tself.dialogs = [];\r\n}\r\nKEditor.prototype = {\r\n\tlang : function(mixed) {\r\n\t\treturn _lang(mixed, this.langType);\r\n\t},\r\n\tloadPlugin : function(name, fn) {\r\n\t\tvar self = this;\r\n\t\tif (_plugins[name]) {\r\n\t\t\tif (!_isFunction(_plugins[name])) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}, 100);\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t\t_plugins[name].call(self, KindEditor);\r\n\t\t\tif (fn) {\r\n\t\t\t\tfn.call(self);\r\n\t\t\t}\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_plugins[name] = 'loading';\r\n\t\t_loadScript(self.pluginsPath + name + '/' + name + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif (_plugins[name]) {\r\n\t\t\t\t\tself.loadPlugin(name, fn);\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\thandler : function(key, fn) {\r\n\t\tvar self = this;\r\n\t\tif (!self._handlers[key]) {\r\n\t\t\tself._handlers[key] = [];\r\n\t\t}\r\n\t\tif (_isFunction(fn)) {\r\n\t\t\tself._handlers[key].push(fn);\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\t_each(self._handlers[key], function() {\r\n\t\t\tfn = this.call(self, fn);\r\n\t\t});\r\n\t\treturn fn;\r\n\t},\r\n\tclickToolbar : function(name, fn) {\r\n\t\tvar self = this, key = 'clickToolbar' + name;\r\n\t\tif (fn === undefined) {\r\n\t\t\tif (self._handlers[key]) {\r\n\t\t\t\treturn self.handler(key);\r\n\t\t\t}\r\n\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\tself.handler(key);\r\n\t\t\t});\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\treturn self.handler(key, fn);\r\n\t},\r\n\tupdateState : function() {\r\n\t\tvar self = this;\r\n\t\t_each(('justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,' +\r\n\t\t\t'subscript,superscript,bold,italic,underline,strikethrough').split(','), function(i, name) {\r\n\t\t\tself.cmd.state(name) ? self.toolbar.select(name) : self.toolbar.unselect(name);\r\n\t\t});\r\n\t\treturn self;\r\n\t},\r\n\taddContextmenu : function(item) {\r\n\t\tthis._contextmenus.push(item);\r\n\t\treturn this;\r\n\t},\r\n\tafterCreate : function(fn) {\r\n\t\treturn this.handler('afterCreate', fn);\r\n\t},\r\n\tbeforeRemove : function(fn) {\r\n\t\treturn this.handler('beforeRemove', fn);\r\n\t},\r\n\tbeforeGetHtml : function(fn) {\r\n\t\treturn this.handler('beforeGetHtml', fn);\r\n\t},\r\n\tbeforeSetHtml : function(fn) {\r\n\t\treturn this.handler('beforeSetHtml', fn);\r\n\t},\r\n\tafterSetHtml : function(fn) {\r\n\t\treturn this.handler('afterSetHtml', fn);\r\n\t},\r\n\tcreate : function() {\r\n\t\tvar self = this, fullscreenMode = self.fullscreenMode;\r\n\t\tif (self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tif (self.srcElement.data('kindeditor')) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.srcElement.data('kindeditor', 'true');\r\n\t\tif (fullscreenMode) {\r\n\t\t\t_docElement().style.overflow = 'hidden';\r\n\t\t} else {\r\n\t\t\t_docElement().style.overflow = '';\r\n\t\t}\r\n\t\tvar width = fullscreenMode ? _docElement().clientWidth + 'px' : self.width,\r\n\t\t\theight = fullscreenMode ? _docElement().clientHeight + 'px' : self.height;\r\n\t\tif ((_IE && _V < 8) || _QUIRKS) {\r\n\t\t\theight = _addUnit(_removeUnit(height) + 2);\r\n\t\t}\r\n\t\tvar container = self.container = K(self.layout);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tK(document.body).append(container);\r\n\t\t} else {\r\n\t\t\tself.srcElement.before(container);\r\n\t\t}\r\n\t\tvar toolbarDiv = K('.toolbar', container),\r\n\t\t\teditDiv = K('.edit', container),\r\n\t\t\tstatusbar = self.statusbar = K('.statusbar', container);\r\n\t\tcontainer.removeClass('container')\r\n\t\t\t.addClass('ke-container ke-container-' + self.themeType).css('width', width);\r\n\t\tif (fullscreenMode) {\r\n\t\t\tcontainer.css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tleft : 0,\r\n\t\t\t\ttop : 0,\r\n\t\t\t\t'z-index' : 811211\r\n\t\t\t});\r\n\t\t\tif (!_GECKO) {\r\n\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t}\r\n\t\t\twindow.scrollTo(0, 0);\r\n\t\t\tK(document.body).css({\r\n\t\t\t\t'height' : '1px',\r\n\t\t\t\t'overflow' : 'hidden'\r\n\t\t\t});\r\n\t\t\tK(document.body.parentNode).css('overflow', 'hidden');\r\n\t\t\tself._fullscreenExecuted = true;\r\n\t\t} else {\r\n\t\t\tif (self._fullscreenExecuted) {\r\n\t\t\t\tK(document.body).css({\r\n\t\t\t\t\t'height' : '',\r\n\t\t\t\t\t'overflow' : ''\r\n\t\t\t\t});\r\n\t\t\t\tK(document.body.parentNode).css('overflow', '');\r\n\t\t\t}\r\n\t\t\tif (self._scrollPos) {\r\n\t\t\t\twindow.scrollTo(self._scrollPos.x, self._scrollPos.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar htmlList = [];\r\n\t\tK.each(self.items, function(i, name) {\r\n\t\t\tif (name == '|') {\r\n\t\t\t\thtmlList.push('<span class=\"ke-inline-block ke-separator\"></span>');\r\n\t\t\t} else if (name == '/') {\r\n\t\t\t\thtmlList.push('<div class=\"ke-hr\"></div>');\r\n\t\t\t} else {\r\n\t\t\t\thtmlList.push('<span class=\"ke-outline\" data-name=\"' + name + '\" title=\"' + self.lang(name) + '\" unselectable=\"on\">');\r\n\t\t\t\thtmlList.push('<span class=\"ke-toolbar-icon ke-toolbar-icon-url ke-icon-' + name + '\" unselectable=\"on\"></span></span>');\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar toolbar = self.toolbar = _toolbar({\r\n\t\t\tsrc : toolbarDiv,\r\n\t\t\thtml : htmlList.join(''),\r\n\t\t\tnoDisableItems : self.noDisableItems,\r\n\t\t\tclick : function(e, name) {\r\n\t\t\t\te.stop();\r\n\t\t\t\tif (self.menu) {\r\n\t\t\t\t\tvar menuName = self.menu.name;\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\tif (menuName === name) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.clickToolbar(name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar editHeight = _removeUnit(height) - toolbar.div.height();\r\n\t\tvar edit = self.edit = _edit({\r\n\t\t\theight : editHeight > 0 && _removeUnit(height) > self.minHeight ? editHeight : self.minHeight,\r\n\t\t\tsrc : editDiv,\r\n\t\t\tsrcElement : self.srcElement,\r\n\t\t\tdesignMode : self.designMode,\r\n\t\t\tthemesPath : self.themesPath,\r\n\t\t\tbodyClass : self.bodyClass,\r\n\t\t\tcssPath : self.cssPath,\r\n\t\t\tcssData : self.cssData,\r\n\t\t\tbeforeGetHtml : function(html) {\r\n\t\t\t\thtml = self.beforeGetHtml(html);\r\n\t\t\t\thtml = _removeBookmarkTag(_removeTempTag(html));\r\n\t\t\t\treturn _formatHtml(html, self.filterMode ? self.htmlTags : null, self.urlType, self.wellFormatMode, self.indentChar);\r\n\t\t\t},\r\n\t\t\tbeforeSetHtml : function(html) {\r\n\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null, '', false);\r\n\t\t\t\treturn self.beforeSetHtml(html);\r\n\t\t\t},\r\n\t\t\tafterSetHtml : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.afterSetHtml();\r\n\t\t\t},\r\n\t\t\tafterCreate : function() {\r\n\t\t\t\tself.edit = edit = this;\r\n\t\t\t\tself.cmd = edit.cmd;\r\n\t\t\t\tself._docMousedownFn = function(e) {\r\n\t\t\t\t\tif (self.menu) {\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tK(edit.doc, document).mousedown(self._docMousedownFn);\r\n\t\t\t\t_bindContextmenuEvent.call(self);\r\n\t\t\t\t_bindNewlineEvent.call(self);\r\n\t\t\t\t_bindTabEvent.call(self);\r\n\t\t\t\t_bindFocusEvent.call(self);\r\n\t\t\t\tedit.afterChange(function(e) {\r\n\t\t\t\t\tif (!edit.designMode) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.updateState();\r\n\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tedit.textarea.keyup(function(e) {\r\n\t\t\t\t\tif (!e.ctrlKey && !e.altKey && _INPUT_KEY_MAP[e.which]) {\r\n\t\t\t\t\t\tif (self.options.afterChange) {\r\n\t\t\t\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (self.readonlyMode) {\r\n\t\t\t\t\tself.readonly();\r\n\t\t\t\t}\r\n\t\t\t\tself.isCreated = true;\r\n\t\t\t\tif (self.initContent === '') {\r\n\t\t\t\t\tself.initContent = self.html();\r\n\t\t\t\t}\r\n\t\t\t\tif (self._undoStack.length > 0) {\r\n\t\t\t\t\tvar prev = self._undoStack.pop();\r\n\t\t\t\t\tif (prev.start) {\r\n\t\t\t\t\t\tself.html(prev.html);\r\n\t\t\t\t\t\tedit.cmd.range.moveToBookmark(prev);\r\n\t\t\t\t\t\tself.select();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tself.afterCreate();\r\n\t\t\t\tif (self.options.afterCreate) {\r\n\t\t\t\t\tself.options.afterCreate.call(self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tstatusbar.removeClass('statusbar').addClass('ke-statusbar')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-center-icon\"></span>')\r\n\t\t\t.append('<span class=\"ke-inline-block ke-statusbar-right-icon\"></span>');\r\n\t\tif (self._fullscreenResizeHandler) {\r\n\t\t\tK(window).unbind('resize', self._fullscreenResizeHandler);\r\n\t\t\tself._fullscreenResizeHandler = null;\r\n\t\t}\r\n\t\tfunction initResize() {\r\n\t\t\tif (statusbar.height() === 0) {\r\n\t\t\t\tsetTimeout(initResize, 100);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tself.resize(width, height, false);\r\n\t\t}\r\n\t\tinitResize();\r\n\t\tif (fullscreenMode) {\r\n\t\t\tself._fullscreenResizeHandler = function(e) {\r\n\t\t\t\tif (self.isCreated) {\r\n\t\t\t\t\tself.resize(_docElement().clientWidth, _docElement().clientHeight, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tK(window).bind('resize', self._fullscreenResizeHandler);\r\n\t\t\ttoolbar.select('fullscreen');\r\n\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t} else {\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tK(window).bind('scroll', function(e) {\r\n\t\t\t\t\tself._scrollPos = _getScrollPos();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (self.resizeType > 0) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar,\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(null, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.first().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t\tif (self.resizeType === 2) {\r\n\t\t\t\t_drag({\r\n\t\t\t\t\tmoveEl : container,\r\n\t\t\t\t\tclickEl : statusbar.last(),\r\n\t\t\t\t\tmoveFn : function(x, y, width, height, diffX, diffY) {\r\n\t\t\t\t\t\twidth += diffX;\r\n\t\t\t\t\t\theight += diffY;\r\n\t\t\t\t\t\tself.resize(width, height);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tstatusbar.last().css('visibility', 'hidden');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tremove : function() {\r\n\t\tvar self = this;\r\n\t\tif (!self.isCreated) {\r\n\t\t\treturn self;\r\n\t\t}\r\n\t\tself.beforeRemove();\r\n\t\tself.srcElement.data('kindeditor', '');\r\n\t\tif (self.menu) {\r\n\t\t\tself.hideMenu();\r\n\t\t}\r\n\t\t_each(self.dialogs, function() {\r\n\t\t\tself.hideDialog();\r\n\t\t});\r\n\t\tK(document).unbind('mousedown', self._docMousedownFn);\r\n\t\tself.toolbar.remove();\r\n\t\tself.edit.remove();\r\n\t\tself.statusbar.last().unbind();\r\n\t\tself.statusbar.unbind();\r\n\t\tself.container.remove();\r\n\t\tself.container = self.toolbar = self.edit = self.menu = null;\r\n\t\tself.dialogs = [];\r\n\t\tself.isCreated = false;\r\n\t\treturn self;\r\n\t},\r\n\tresize : function(width, height, updateProp) {\r\n\t\tvar self = this;\r\n\t\tupdateProp = _undef(updateProp, true);\r\n\t\tif (width) {\r\n\t\t\tif (!/%/.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t\twidth = width < self.minWidth ? self.minWidth : width;\r\n\t\t\t}\r\n\t\t\tself.container.css('width', _addUnit(width));\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.width = _addUnit(width);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (height) {\r\n\t\t\theight = _removeUnit(height);\r\n\t\t\teditHeight = _removeUnit(height) - self.toolbar.div.height() - self.statusbar.height();\r\n\t\t\teditHeight = editHeight < self.minHeight ? self.minHeight : editHeight;\r\n\t\t\tself.edit.setHeight(editHeight);\r\n\t\t\tif (updateProp) {\r\n\t\t\t\tself.height = _addUnit(height);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tselect : function() {\r\n\t\tthis.isCreated && this.cmd.select();\r\n\t\treturn this;\r\n\t},\r\n\thtml : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn self.isCreated ? self.edit.html() : _elementVal(self.srcElement);\r\n\t\t}\r\n\t\tself.isCreated ? self.edit.html(val) : _elementVal(self.srcElement, val);\r\n\t\tif (self.isCreated) {\r\n\t\t\tself.cmd.selection();\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tfullHtml : function() {\r\n\t\treturn this.isCreated ? this.edit.html(undefined, true) : '';\r\n\t},\r\n\ttext : function(val) {\r\n\t\tvar self = this;\r\n\t\tif (val === undefined) {\r\n\t\t\treturn _trim(self.html().replace(/<(?!img|embed).*?>/ig, '').replace(/&nbsp;/ig, ' '));\r\n\t\t} else {\r\n\t\t\treturn self.html(_escape(val));\r\n\t\t}\r\n\t},\r\n\tisEmpty : function() {\r\n\t\treturn _trim(this.text().replace(/\\r\\n|\\n|\\r/, '')) === '';\r\n\t},\r\n\tisDirty : function() {\r\n\t\treturn _trim(this.initContent.replace(/\\r\\n|\\n|\\r|t/g, '')) !== _trim(this.html().replace(/\\r\\n|\\n|\\r|t/g, ''));\r\n\t},\r\n\tselectedHtml : function() {\r\n\t\tvar val = this.isCreated ? this.cmd.range.html() : '';\r\n\t\tval = _removeBookmarkTag(_removeTempTag(val));\r\n\t\treturn val;\r\n\t},\r\n\tcount : function(mode) {\r\n\t\tvar self = this;\r\n\t\tmode = (mode || 'html').toLowerCase();\r\n\t\tif (mode === 'html') {\r\n\t\t\treturn self.html().length;\r\n\t\t}\r\n\t\tif (mode === 'text') {\r\n\t\t\treturn self.text().replace(/<(?:img|embed).*?>/ig, 'K').replace(/\\r\\n|\\n|\\r/g, '').length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t},\r\n\texec : function(key) {\r\n\t\tkey = key.toLowerCase();\r\n\t\tvar self = this, cmd = self.cmd,\r\n\t\t\tchangeFlag = _inArray(key, 'selectall,copy,paste,print'.split(',')) < 0;\r\n\t\tif (changeFlag) {\r\n\t\t\tself.addBookmark(false);\r\n\t\t}\r\n\t\tcmd[key].apply(cmd, _toArray(arguments, 1));\r\n\t\tif (changeFlag) {\r\n\t\t\tself.updateState();\r\n\t\t\tself.addBookmark(false);\r\n\t\t\tif (self.options.afterChange) {\r\n\t\t\t\tself.options.afterChange.call(self);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\tinsertHtml : function(val, quickMode) {\r\n\t\tif (!this.isCreated) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\tval = this.beforeSetHtml(val);\r\n\t\tthis.exec('inserthtml', val, quickMode);\r\n\t\treturn this;\r\n\t},\r\n\tappendHtml : function(val) {\r\n\t\tthis.html(this.html() + val);\r\n\t\tif (this.isCreated) {\r\n\t\t\tvar cmd = this.cmd;\r\n\t\t\tcmd.range.selectNodeContents(cmd.doc.body).collapse(false);\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\tsync : function() {\r\n\t\t_elementVal(this.srcElement, this.html());\r\n\t\treturn this;\r\n\t},\r\n\tfocus : function() {\r\n\t\tthis.isCreated ? this.edit.focus() : this.srcElement[0].focus();\r\n\t\treturn this;\r\n\t},\r\n\tblur : function() {\r\n\t\tthis.isCreated ? this.edit.blur() : this.srcElement[0].blur();\r\n\t\treturn this;\r\n\t},\r\n\taddBookmark : function(checkSize) {\r\n\t\tcheckSize = _undef(checkSize, true);\r\n\t\tvar self = this, edit = self.edit,\r\n\t\t\tbody = edit.doc.body,\r\n\t\t\thtml = _removeTempTag(body.innerHTML), bookmark;\r\n\t\tif (checkSize && self._undoStack.length > 0) {\r\n\t\t\tvar prev = self._undoStack[self._undoStack.length - 1];\r\n\t\t\tif (Math.abs(html.length - _removeBookmarkTag(prev.html).length) < self.minChangeSize) {\r\n\t\t\t\treturn self;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (edit.designMode && !self._firstAddBookmark) {\r\n\t\t\tvar range = self.cmd.range;\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\t\tbookmark.html = _removeTempTag(body.innerHTML);\r\n\t\t\trange.moveToBookmark(bookmark);\r\n\t\t} else {\r\n\t\t\tbookmark = {\r\n\t\t\t\thtml : html\r\n\t\t\t};\r\n\t\t}\r\n\t\tself._firstAddBookmark = false;\r\n\t\t_addBookmarkToStack(self._undoStack, bookmark);\r\n\t\treturn self;\r\n\t},\r\n\tundo : function() {\r\n\t\treturn _undoToRedo.call(this, this._undoStack, this._redoStack);\r\n\t},\r\n\tredo : function() {\r\n\t\treturn _undoToRedo.call(this, this._redoStack, this._undoStack);\r\n\t},\r\n\tfullscreen : function(bool) {\r\n\t\tthis.fullscreenMode = (bool === undefined ? !this.fullscreenMode : bool);\r\n\t\tthis.addBookmark(false);\r\n\t\treturn this.remove().create();\r\n\t},\r\n\treadonly : function(isReadonly) {\r\n\t\tisReadonly = _undef(isReadonly, true);\r\n\t\tvar self = this, edit = self.edit, doc = edit.doc;\r\n\t\tif (self.designMode) {\r\n\t\t\tself.toolbar.disableAll(isReadonly, []);\r\n\t\t} else {\r\n\t\t\t_each(self.noDisableItems, function() {\r\n\t\t\t\tself.toolbar[isReadonly ? 'disable' : 'enable'](this);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (_IE) {\r\n\t\t\tdoc.body.contentEditable = !isReadonly;\r\n\t\t} else {\r\n\t\t\tdoc.designMode = isReadonly ? 'off' : 'on';\r\n\t\t}\r\n\t\tedit.textarea[0].disabled = isReadonly;\r\n\t},\r\n\tcreateMenu : function(options) {\r\n\t\tvar self = this,\r\n\t\t\tname = options.name,\r\n\t\t\tknode = self.toolbar.get(name),\r\n\t\t\tpos = knode.pos();\r\n\t\toptions.x = pos.x;\r\n\t\toptions.y = pos.y + knode.height();\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\tif (options.selectedColor !== undefined) {\r\n\t\t\toptions.cls = 'ke-colorpicker-' + self.themeType;\r\n\t\t\toptions.noColor = self.lang('noColor');\r\n\t\t\tself.menu = _colorpicker(options);\r\n\t\t} else {\r\n\t\t\toptions.cls = 'ke-menu-' + self.themeType;\r\n\t\t\toptions.centerLineMode = false;\r\n\t\t\tself.menu = _menu(options);\r\n\t\t}\r\n\t\treturn self.menu;\r\n\t},\r\n\thideMenu : function() {\r\n\t\tthis.menu.remove();\r\n\t\tthis.menu = null;\r\n\t\treturn this;\r\n\t},\r\n\thideContextmenu : function() {\r\n\t\tthis.contextmenu.remove();\r\n\t\tthis.contextmenu = null;\r\n\t\treturn this;\r\n\t},\r\n\tcreateDialog : function(options) {\r\n\t\tvar self = this, name = options.name;\r\n\t\toptions.z = self.options.zIndex;\r\n\t\toptions.shadowMode = _undef(options.shadowMode, self.shadowMode);\r\n\t\toptions.closeBtn = _undef(options.closeBtn, {\r\n\t\t\tname : self.lang('close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\toptions.noBtn = _undef(options.noBtn, {\r\n\t\t\tname : self.lang(options.yesBtn ? 'no' : 'close'),\r\n\t\t\tclick : function(e) {\r\n\t\t\t\tself.hideDialog();\r\n\t\t\t\tif (_IE && self.cmd) {\r\n\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (self.dialogAlignType != 'page') {\r\n\t\t\toptions.alignEl = self.container;\r\n\t\t}\r\n\t\toptions.cls = 'ke-dialog-' + self.themeType;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z + 2);\r\n\t\t\toptions.z = parentDialog.z + 3;\r\n\t\t\toptions.showMask = false;\r\n\t\t}\r\n\t\tvar dialog = _dialog(options);\r\n\t\tself.dialogs.push(dialog);\r\n\t\treturn dialog;\r\n\t},\r\n\thideDialog : function() {\r\n\t\tvar self = this;\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tself.dialogs.pop().remove();\r\n\t\t}\r\n\t\tif (self.dialogs.length > 0) {\r\n\t\t\tvar firstDialog = self.dialogs[0],\r\n\t\t\t\tparentDialog = self.dialogs[self.dialogs.length - 1];\r\n\t\t\tfirstDialog.setMaskIndex(parentDialog.z - 1);\r\n\t\t}\r\n\t\treturn self;\r\n\t},\r\n\terrorDialog : function(html) {\r\n\t\tvar self = this;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\twidth : 750,\r\n\t\t\ttitle : self.lang('uploadError'),\r\n\t\t\tbody : '<div style=\"padding:10px 20px;\"><iframe frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe></div>'\r\n\t\t});\r\n\t\tvar iframe = K('iframe', dialog.div), doc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(html);\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t\treturn self;\r\n\t}\r\n};\r\nfunction _editor(options) {\r\n\treturn new KEditor(options);\r\n}\r\n_instances = [];\r\nfunction _create(expr, options) {\r\n\toptions = options || {};\r\n\toptions.basePath = _undef(options.basePath, K.basePath);\r\n\toptions.themesPath = _undef(options.themesPath, options.basePath + 'themes/');\r\n\toptions.langPath = _undef(options.langPath, options.basePath + 'lang/');\r\n\toptions.pluginsPath = _undef(options.pluginsPath, options.basePath + 'plugins/');\r\n\tif (_undef(options.loadStyleMode, K.options.loadStyleMode)) {\r\n\t\tvar themeType = _undef(options.themeType, K.options.themeType);\r\n\t\t_loadStyle(options.themesPath + 'default/default.css');\r\n\t\t_loadStyle(options.themesPath + themeType + '/' + themeType + '.css');\r\n\t}\r\n\tfunction create(editor) {\r\n\t\t_each(_plugins, function(name, fn) {\r\n\t\t\tif (_isFunction(fn)) {\r\n\t\t\t\tfn.call(editor, KindEditor);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn editor.create();\r\n\t}\r\n\tvar knode = K(expr);\r\n\tif (!knode || knode.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\tif (knode.length > 1) {\r\n\t\tknode.each(function() {\r\n\t\t\t_create(this, options);\r\n\t\t});\r\n\t\treturn _instances[0];\r\n\t}\r\n\toptions.srcElement = knode[0];\r\n\tvar editor = new KEditor(options);\r\n\t_instances.push(editor);\r\n\tif (_language[editor.langType]) {\r\n\t\treturn create(editor);\r\n\t}\r\n\t_loadScript(editor.langPath + editor.langType + '.js?ver=' + encodeURIComponent(K.DEBUG ? _TIME : _VERSION), function() {\r\n\t\tcreate(editor);\r\n\t});\r\n\treturn editor;\r\n}\r\nfunction _eachEditor(expr, fn) {\r\n\tK(expr).each(function(i, el) {\r\n\t\tK.each(_instances, function(j, editor) {\r\n\t\t\tif (editor && editor.srcElement[0] == el) {\r\n\t\t\t\tfn.call(editor, j);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\nK.remove = function(expr) {\r\n\t_eachEditor(expr, function(i) {\r\n\t\tthis.remove();\r\n\t\t_instances.splice(i, 1);\r\n\t});\r\n};\r\nK.sync = function(expr) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.sync();\r\n\t});\r\n};\r\nK.html = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.html(val);\r\n\t});\r\n};\r\nK.insertHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.insertHtml(val);\r\n\t});\r\n};\r\nK.appendHtml = function(expr, val) {\r\n\t_eachEditor(expr, function() {\r\n\t\tthis.appendHtml(val);\r\n\t});\r\n};\r\n\r\r\nif (_IE && _V < 7) {\r\n\t_nativeCommand(document, 'BackgroundImageCache', true);\r\n}\r\nK.EditorClass = KEditor;\r\nK.editor = _editor;\r\nK.create = _create;\r\nK.instances = _instances;\r\nK.plugin = _plugin;\r\nK.lang = _lang;\r\n\r\r\n_plugin('core', function(K) {\r\n\tvar self = this,\r\n\t\tshortcutKeys = {\r\n\t\t\tundo : 'Z', redo : 'Y', bold : 'B', italic : 'I', underline : 'U', print : 'P', selectall : 'A'\r\n\t\t};\r\n\tself.afterSetHtml(function() {\r\n\t\tif (self.options.afterChange) {\r\n\t\t\tself.options.afterChange.call(self);\r\n\t\t}\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (self.syncType != 'form') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar el = K(self.srcElement), hasForm = false;\r\n\t\twhile ((el = el.parent())) {\r\n\t\t\tif (el.name == 'form') {\r\n\t\t\t\thasForm = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (hasForm) {\r\n\t\t\tel.bind('submit', function(e) {\r\n\t\t\t\tself.sync();\r\n\t\t\t\tK(window).bind('unload', function() {\r\n\t\t\t\t\tself.edit.textarea.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tvar resetBtn = K('[type=\"reset\"]', el);\r\n\t\t\tresetBtn.click(function() {\r\n\t\t\t\tself.html(self.initContent);\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t});\r\n\t\t\tself.beforeRemove(function() {\r\n\t\t\t\tel.unbind();\r\n\t\t\t\tresetBtn.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('source', function() {\r\n\t\tif (self.edit.designMode) {\r\n\t\t\tself.toolbar.disableAll(true);\r\n\t\t\tself.edit.design(false);\r\n\t\t\tself.toolbar.select('source');\r\n\t\t} else {\r\n\t\t\tself.toolbar.disableAll(false);\r\n\t\t\tself.edit.design(true);\r\n\t\t\tself.toolbar.unselect('source');\r\n\t\t\tif (_GECKO) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t}, 0);\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection();\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.designMode = self.edit.designMode;\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tif (!self.designMode) {\r\n\t\t\tself.toolbar.disableAll(true).select('source');\r\n\t\t}\r\n\t});\r\n\tself.clickToolbar('fullscreen', function() {\r\n\t\tself.fullscreen();\r\n\t});\r\n\tif (self.fullscreenShortcut) {\r\n\t\tvar loaded = false;\r\n\t\tself.afterCreate(function() {\r\n\t\t\tK(self.edit.doc, self.edit.textarea).keyup(function(e) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.fullscreen();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (loaded) {\r\n\t\t\t\tif (_IE && !self.designMode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tself.focus();\r\n\t\t\t}\r\n\t\t\tif (!loaded) {\r\n\t\t\t\tloaded = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_each('undo,redo'.split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself[name]();\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('formatblock', function() {\r\n\t\tvar blocks = self.lang('formatblock.formatBlock'),\r\n\t\t\theights = {\r\n\t\t\t\th1 : 28,\r\n\t\t\t\th2 : 24,\r\n\t\t\t\th3 : 18,\r\n\t\t\t\tH4 : 14,\r\n\t\t\t\tp : 12\r\n\t\t\t},\r\n\t\t\tcurVal = self.cmd.val('formatblock'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'formatblock',\r\n\t\t\t\twidth : self.langType == 'en' ? 200 : 150\r\n\t\t\t});\r\n\t\t_each(blocks, function(key, val) {\r\n\t\t\tvar style = 'font-size:' + heights[key] + 'px;';\r\n\t\t\tif (key.charAt(0) === 'h') {\r\n\t\t\t\tstyle += 'font-weight:bold;';\r\n\t\t\t}\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"' + style + '\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : heights[key] + 12,\r\n\t\t\t\tchecked : (curVal === key || curVal === val),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.select().exec('formatblock', '<' + key + '>').hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontname', function() {\r\n\t\tvar curVal = self.cmd.val('fontname'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontname',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.lang('fontname.fontName'), function(key, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-family: ' + key + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\tchecked : (curVal === key.toLowerCase() || curVal === val.toLowerCase()),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontname', key).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('fontsize', function() {\r\n\t\tvar curVal = self.cmd.val('fontsize'),\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : 'fontsize',\r\n\t\t\t\twidth : 150\r\n\t\t\t});\r\n\t\t_each(self.fontSizeTable, function(i, val) {\r\n\t\t\tmenu.addItem({\r\n\t\t\t\ttitle : '<span style=\"font-size:' + val + ';\" unselectable=\"on\">' + val + '</span>',\r\n\t\t\t\theight : _removeUnit(val) + 12,\r\n\t\t\t\tchecked : curVal === val,\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.exec('fontsize', val).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each('forecolor,hilitecolor'.split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tselectedColor : self.cmd.val(name) || 'default',\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\tself.exec(name, color).hideMenu();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t_each(('cut,copy,paste').split(','), function(i, name) {\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus();\r\n\t\t\ttry {\r\n\t\t\t\tself.exec(name, null);\r\n\t\t\t} catch(e) {\r\n\t\t\t\talert(self.lang(name + 'Error'));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tself.clickToolbar('about', function() {\r\n\t\tvar html = '<div style=\"margin:20px;\">' +\r\n\t\t\t'<div>KindEditor ' + _VERSION + '</div>' +\r\n\t\t\t'<div>Copyright &copy; <a href=\"http://www.kindsoft.net/\" target=\"_blank\">kindsoft.net</a> All rights reserved.</div>' +\r\n\t\t\t'</div>';\r\n\t\tself.createDialog({\r\n\t\t\tname : 'about',\r\n\t\t\twidth : 350,\r\n\t\t\ttitle : self.lang('about'),\r\n\t\t\tbody : html\r\n\t\t});\r\n\t});\r\n\tself.plugin.getSelectedLink = function() {\r\n\t\treturn self.cmd.commonAncestor('a');\r\n\t};\r\n\tself.plugin.getSelectedImage = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn !/^ke-\\w+$/i.test(img[0].className);\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedFlash = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-flash';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedMedia = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-media' || img[0].className == 'ke-rm';\r\n\t\t});\r\n\t};\r\n\tself.plugin.getSelectedAnchor = function() {\r\n\t\treturn _getImageFromRange(self.edit.cmd.range, function(img) {\r\n\t\t\treturn img[0].className == 'ke-anchor';\r\n\t\t});\r\n\t};\r\n\t_each('link,image,flash,media,anchor'.split(','), function(i, name) {\r\n\t\tvar uName = name.charAt(0).toUpperCase() + name.substr(1);\r\n\t\t_each('edit,delete'.split(','), function(j, val) {\r\n\t\t\tself.addContextmenu({\r\n\t\t\t\ttitle : self.lang(val + uName),\r\n\t\t\t\tclick : function() {\r\n\t\t\t\t\tself.loadPlugin(name, function() {\r\n\t\t\t\t\t\tself.plugin[name][val]();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcond : self.plugin['getSelected' + uName],\r\n\t\t\t\twidth : 150,\r\n\t\t\t\ticonClass : val == 'edit' ? 'ke-icon-' + name : undefined\r\n\t\t\t});\r\n\t\t});\r\n\t\tself.addContextmenu({ title : '-' });\r\n\t});\r\n\tself.plugin.getSelectedTable = function() {\r\n\t\treturn self.cmd.commonAncestor('table');\r\n\t};\r\n\tself.plugin.getSelectedRow = function() {\r\n\t\treturn self.cmd.commonAncestor('tr');\r\n\t};\r\n\tself.plugin.getSelectedCell = function() {\r\n\t\treturn self.cmd.commonAncestor('td');\r\n\t};\r\n\t_each(('prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,' +\r\n\t'rowsplit,colsplit,coldelete,rowdelete,insert,delete').split(','), function(i, val) {\r\n\t\tvar cond = _inArray(val, ['prop', 'delete']) < 0 ? self.plugin.getSelectedCell : self.plugin.getSelectedTable;\r\n\t\tself.addContextmenu({\r\n\t\t\ttitle : self.lang('table' + val),\r\n\t\t\tclick : function() {\r\n\t\t\t\tself.loadPlugin('table', function() {\r\n\t\t\t\t\tself.plugin.table[val]();\r\n\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcond : cond,\r\n\t\t\twidth : 170,\r\n\t\t\ticonClass : 'ke-icon-table' + val\r\n\t\t});\r\n\t});\r\n\tself.addContextmenu({ title : '-' });\r\n\t_each(('selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,' +\r\n\t\t'insertunorderedlist,indent,outdent,subscript,superscript,hr,print,' +\r\n\t\t'bold,italic,underline,strikethrough,removeformat,unlink').split(','), function(i, name) {\r\n\t\tif (shortcutKeys[name]) {\r\n\t\t\tself.afterCreate(function() {\r\n\t\t\t\t_ctrl(this.edit.doc, shortcutKeys[name], function() {\r\n\t\t\t\t\tself.cmd.selection();\r\n\t\t\t\t\tself.clickToolbar(name);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tself.clickToolbar(name, function() {\r\n\t\t\tself.focus().exec(name, null);\r\n\t\t});\r\n\t});\r\n\tself.afterCreate(function() {\r\n\t\tvar doc = self.edit.doc, cmd, bookmark, div,\r\n\t\t\tcls = '__kindeditor_paste__', pasting = false;\r\n\t\tfunction movePastedData() {\r\n\t\t\tcmd.range.moveToBookmark(bookmark);\r\n\t\t\tcmd.select();\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\tK('div.' + cls, div).each(function() {\r\n\t\t\t\t\tK(this).after('<br />').remove(true);\r\n\t\t\t\t});\r\n\t\t\t\tK('span.Apple-style-span', div).remove(true);\r\n\t\t\t\tK('span.Apple-tab-span', div).remove(true);\r\n\t\t\t\tK('span[style]', div).each(function() {\r\n\t\t\t\t\tif (K(this).css('white-space') == 'nowrap') {\r\n\t\t\t\t\t\tK(this).remove(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tK('meta', div).remove();\r\n\t\t\t}\r\n\t\t\tvar html = div[0].innerHTML;\r\n\t\t\tdiv.remove();\r\n\t\t\tif (html === '') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (_WEBKIT) {\r\n\t\t\t\thtml = html.replace(/(<br>)\\1/ig, '$1');\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 2) {\r\n\t\t\t\thtml = html.replace(/(<(?:p|p\\s[^>]*)>) *(<\\/p>)/ig, '');\r\n\t\t\t\tif (/schemas-microsoft-com|worddocument|mso-\\w+/i.test(html)) {\r\n\t\t\t\t\thtml = _clearMsWord(html, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = _formatHtml(html, self.filterMode ? self.htmlTags : null);\r\n\t\t\t\t\thtml = self.beforeSetHtml(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (self.pasteType === 1) {\r\n\t\t\t\thtml = html.replace(/&nbsp;/ig, ' ');\r\n\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, '\\n');\r\n\t\t\t\thtml = html.replace(/<br[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<\\/p><p[^>]*>/ig, '\\n');\r\n\t\t\t\thtml = html.replace(/<[^>]+>/g, '');\r\n\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\tif (/\\n/.test(html)) {\r\n\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '<br /></p>').replace(/\\n/g, '<br /></p><p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.insertHtml(html, true);\r\n\t\t}\r\n\t\tK(doc.body).bind('paste', function(e){\r\n\t\t\tif (self.pasteType === 0) {\r\n\t\t\t\te.stop();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pasting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpasting = true;\r\n\t\t\tK('div.' + cls, doc).remove();\r\n\t\t\tcmd = self.cmd.selection();\r\n\t\t\tbookmark = cmd.range.createBookmark();\r\n\t\t\tdiv = K('<div class=\"' + cls + '\"></div>', doc).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\twidth : '1px',\r\n\t\t\t\theight : '1px',\r\n\t\t\t\toverflow : 'hidden',\r\n\t\t\t\tleft : '-1981px',\r\n\t\t\t\ttop : K(bookmark.start).pos().y + 'px',\r\n\t\t\t\t'white-space' : 'nowrap'\r\n\t\t\t});\r\n\t\t\tK(doc.body).append(div);\r\n\t\t\tif (_IE) {\r\n\t\t\t\tvar rng = cmd.range.get(true);\r\n\t\t\t\trng.moveToElementText(div[0]);\r\n\t\t\t\trng.select();\r\n\t\t\t\trng.execCommand('paste');\r\n\t\t\t\te.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tcmd.range.selectNodeContents(div[0]);\r\n\t\t\t\tcmd.select();\r\n\t\t\t}\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tmovePastedData();\r\n\t\t\t\tpasting = false;\r\n\t\t\t}, 0);\r\n\t\t});\r\n\t});\r\n\tself.beforeGetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<div\\s+[^>]*data-ke-input-tag=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, tag) {\r\n\t\t\t\treturn unescape(tag);\r\n\t\t\t});\r\n\t\t\thtml = html.replace(/(<input)((?:\\s+[^>]*)?>)/ig, function($0, $1, $2) {\r\n\t\t\t\tif (!/\\s+type=\"[^\"]+\"/i.test($0)) {\r\n\t\t\t\t\treturn $1 + ' type=\"text\"' + $2;\r\n\t\t\t\t}\r\n\t\t\t\treturn $0;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/(<(?:noscript|noscript\\s[^>]*)>)([\\s\\S]*?)(<\\/noscript>)/ig, function($0, $1, $2, $3) {\r\n\t\t\treturn $1 + _unescape($2).replace(/\\s+/g, ' ') + $3;\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-(flash|rm|media)\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\tvar styles = _getCssList(imgAttrs.style || '');\r\n\t\t\tvar attrs = _mediaAttrs(imgAttrs['data-ke-tag']);\r\n\t\t\tvar width = _undef(styles.width, '');\r\n\t\t\tvar height = _undef(styles.height, '');\r\n\t\t\tif (/px/i.test(width)) {\r\n\t\t\t\twidth = _removeUnit(width);\r\n\t\t\t}\r\n\t\t\tif (/px/i.test(height)) {\r\n\t\t\t\theight = _removeUnit(height);\r\n\t\t\t}\r\n\t\t\tattrs.width = _undef(imgAttrs.width, width);\r\n\t\t\tattrs.height = _undef(imgAttrs.height, height);\r\n\t\t\treturn _mediaEmbed(attrs);\r\n\t\t})\r\n\t\t.replace(/<img[^>]*class=\"?ke-anchor\"?[^>]*>/ig, function(full) {\r\n\t\t\tvar imgAttrs = _getAttrList(full);\r\n\t\t\treturn '<a name=\"' + unescape(imgAttrs['data-ke-name']) + '\"></a>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-script-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<script' + unescape(attr) + '>' + unescape(code) + '</script>';\r\n\t\t})\r\n\t\t.replace(/<div\\s+[^>]*data-ke-noscript-attr=\"([^\"]*)\"[^>]*>([\\s\\S]*?)<\\/div>/ig, function(full, attr, code) {\r\n\t\t\treturn '<noscript' + unescape(attr) + '>' + unescape(code) + '</noscript>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)data-ke-src=\"([^\"]*)\"([^>]*>)/ig, function(full, start, src, end) {\r\n\t\t\tfull = full.replace(/(\\s+(?:href|src)=\")[^\"]*(\")/i, function($0, $1, $2) {\r\n\t\t\t\treturn $1 + _unescape(src) + $2;\r\n\t\t\t});\r\n\t\t\tfull = full.replace(/\\s+data-ke-src=\"[^\"]*\"/i, '');\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)data-ke-(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + end;\r\n\t\t});\r\n\t});\r\n\tself.beforeSetHtml(function(html) {\r\n\t\tif (_IE && _V <= 8) {\r\n\t\t\thtml = html.replace(/<input[^>]*>|<(select|button)[^>]*>[\\s\\S]*?<\\/\\1>/ig, function(full) {\r\n\t\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\t\tvar styles = _getCssList(attrs.style || '');\r\n\t\t\t\tif (styles.display == 'none') {\r\n\t\t\t\t\treturn '<div class=\"ke-display-none\" data-ke-input-tag=\"' + escape(full) + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn full;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn html.replace(/<embed[^>]*type=\"([^\"]+)\"[^>]*>(?:<\\/embed>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tattrs.src = _undef(attrs.src, '');\r\n\t\t\tattrs.width = _undef(attrs.width, 0);\r\n\t\t\tattrs.height = _undef(attrs.height, 0);\r\n\t\t\treturn _mediaImg(self.themesPath + 'common/blank.gif', attrs);\r\n\t\t})\r\n\t\t.replace(/<a[^>]*name=\"([^\"]+)\"[^>]*>(?:<\\/a>)?/ig, function(full) {\r\n\t\t\tvar attrs = _getAttrList(full);\r\n\t\t\tif (attrs.href !== undefined) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn '<img class=\"ke-anchor\" src=\"' + self.themesPath + 'common/anchor.gif\" data-ke-name=\"' + escape(attrs.name) + '\" />';\r\n\t\t})\r\n\t\t.replace(/<script([^>]*)>([\\s\\S]*?)<\\/script>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-script\" data-ke-script-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/<noscript([^>]*)>([\\s\\S]*?)<\\/noscript>/ig, function(full, attr, code) {\r\n\t\t\treturn '<div class=\"ke-noscript\" data-ke-noscript-attr=\"' + escape(attr) + '\">' + escape(code) + '</div>';\r\n\t\t})\r\n\t\t.replace(/(<[^>]*)(href|src)=\"([^\"]*)\"([^>]*>)/ig, function(full, start, key, src, end) {\r\n\t\t\tif (full.match(/\\sdata-ke-src=\"[^\"]*\"/i)) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\tfull = start + key + '=\"' + src + '\"' + ' data-ke-src=\"' + _escape(src) + '\"' + end;\r\n\t\t\treturn full;\r\n\t\t})\r\n\t\t.replace(/(<[^>]+\\s)(on\\w+=\"[^\"]*\"[^>]*>)/ig, function(full, start, end) {\r\n\t\t\treturn start + 'data-ke-' + end;\r\n\t\t})\r\n\t\t.replace(/<table[^>]*\\s+border=\"0\"[^>]*>/ig, function(full) {\r\n\t\t\tif (full.indexOf('ke-zeroborder') >= 0) {\r\n\t\t\t\treturn full;\r\n\t\t\t}\r\n\t\t\treturn _addClassToTag(full, 'ke-zeroborder');\r\n\t\t});\r\n\t});\r\n});\r\n\r\n\r\n})(window);\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.lang({\r\n\tsource : 'HTML代码',\r\n\tpreview : '预览',\r\n\tundo : '后退(Ctrl+Z)',\r\n\tredo : '前进(Ctrl+Y)',\r\n\tcut : '剪切(Ctrl+X)',\r\n\tcopy : '复制(Ctrl+C)',\r\n\tpaste : '粘贴(Ctrl+V)',\r\n\tplainpaste : '粘贴为无格式文本',\r\n\twordpaste : '从Word粘贴',\r\n\tselectall : '全选(Ctrl+A)',\r\n\tjustifyleft : '左对齐',\r\n\tjustifycenter : '居中',\r\n\tjustifyright : '右对齐',\r\n\tjustifyfull : '两端对齐',\r\n\tinsertorderedlist : '编号',\r\n\tinsertunorderedlist : '项目符号',\r\n\tindent : '增加缩进',\r\n\toutdent : '减少缩进',\r\n\tsubscript : '下标',\r\n\tsuperscript : '上标',\r\n\tformatblock : '段落',\r\n\tfontname : '字体',\r\n\tfontsize : '文字大小',\r\n\tforecolor : '文字颜色',\r\n\thilitecolor : '文字背景',\r\n\tbold : '粗体(Ctrl+B)',\r\n\titalic : '斜体(Ctrl+I)',\r\n\tunderline : '下划线(Ctrl+U)',\r\n\tstrikethrough : '删除线',\r\n\tremoveformat : '删除格式',\r\n\timage : '图片',\r\n\tmultiimage : '批量图片上传',\r\n\tflash : 'Flash',\r\n\tmedia : '视音频',\r\n\ttable : '表格',\r\n\ttablecell : '单元格',\r\n\thr : '插入横线',\r\n\temoticons : '插入表情',\r\n\tlink : '超级链接',\r\n\tunlink : '取消超级链接',\r\n\tfullscreen : '全屏显示',\r\n\tabout : '关于',\r\n\tprint : '打印(Ctrl+P)',\r\n\tfilemanager : '文件空间',\r\n\tcode : '插入程序代码',\r\n\tmap : 'Google地图',\r\n\tbaidumap : '百度地图',\r\n\tlineheight : '行距',\r\n\tclearhtml : '清理HTML代码',\r\n\tpagebreak : '插入分页符',\r\n\tquickformat : '一键排版',\r\n\tinsertfile : '插入文件',\r\n\ttemplate : '插入模板',\r\n\tanchor : '锚点',\r\n\tyes : '确定',\r\n\tno : '取消',\r\n\tclose : '关闭',\r\n\teditImage : '图片属性',\r\n\tdeleteImage : '删除图片',\r\n\teditFlash : 'Flash属性',\r\n\tdeleteFlash : '删除Flash',\r\n\teditMedia : '视音频属性',\r\n\tdeleteMedia : '删除视音频',\r\n\teditLink : '超级链接属性',\r\n\tdeleteLink : '取消超级链接',\r\n\teditAnchor : '锚点属性',\r\n\tdeleteAnchor : '删除锚点',\r\n\ttableprop : '表格属性',\r\n\ttablecellprop : '单元格属性',\r\n\ttableinsert : '插入表格',\r\n\ttabledelete : '删除表格',\r\n\ttablecolinsertleft : '左侧插入列',\r\n\ttablecolinsertright : '右侧插入列',\r\n\ttablerowinsertabove : '上方插入行',\r\n\ttablerowinsertbelow : '下方插入行',\r\n\ttablerowmerge : '向下合并单元格',\r\n\ttablecolmerge : '向右合并单元格',\r\n\ttablerowsplit : '拆分行',\r\n\ttablecolsplit : '拆分列',\r\n\ttablecoldelete : '删除列',\r\n\ttablerowdelete : '删除行',\r\n\tnoColor : '无颜色',\r\n\tpleaseSelectFile : '请选择文件。',\r\n\tinvalidImg : \"请输入有效的URL地址。\\n只允许jpg,gif,bmp,png格式。\",\r\n\tinvalidMedia : \"请输入有效的URL地址。\\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。\",\r\n\tinvalidWidth : \"宽度必须为数字。\",\r\n\tinvalidHeight : \"高度必须为数字。\",\r\n\tinvalidBorder : \"边框必须为数字。\",\r\n\tinvalidUrl : \"请输入有效的URL地址。\",\r\n\tinvalidRows : '行数为必选项，只允许输入大于0的数字。',\r\n\tinvalidCols : '列数为必选项，只允许输入大于0的数字。',\r\n\tinvalidPadding : '边距必须为数字。',\r\n\tinvalidSpacing : '间距必须为数字。',\r\n\tinvalidJson : '服务器发生故障。',\r\n\tuploadSuccess : '上传成功。',\r\n\tcutError : '您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。',\r\n\tcopyError : '您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。',\r\n\tpasteError : '您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。',\r\n\tajaxLoading : '加载中，请稍候 ...',\r\n\tuploadLoading : '上传中，请稍候 ...',\r\n\tuploadError : '上传错误',\r\n\t'plainpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'wordpaste.comment' : '请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。',\r\n\t'code.pleaseInput' : '请输入程序代码。',\r\n\t'link.url' : 'URL',\r\n\t'link.linkType' : '打开类型',\r\n\t'link.newWindow' : '新窗口',\r\n\t'link.selfWindow' : '当前窗口',\r\n\t'flash.url' : 'URL',\r\n\t'flash.width' : '宽度',\r\n\t'flash.height' : '高度',\r\n\t'flash.upload' : '上传',\r\n\t'flash.viewServer' : '文件空间',\r\n\t'media.url' : 'URL',\r\n\t'media.width' : '宽度',\r\n\t'media.height' : '高度',\r\n\t'media.autostart' : '自动播放',\r\n\t'media.upload' : '上传',\r\n\t'media.viewServer' : '文件空间',\r\n\t'image.remoteImage' : '网络图片',\r\n\t'image.localImage' : '本地上传',\r\n\t'image.remoteUrl' : '图片地址',\r\n\t'image.localUrl' : '上传文件',\r\n\t'image.size' : '图片大小',\r\n\t'image.width' : '宽',\r\n\t'image.height' : '高',\r\n\t'image.resetSize' : '重置大小',\r\n\t'image.align' : '对齐方式',\r\n\t'image.defaultAlign' : '默认方式',\r\n\t'image.leftAlign' : '左对齐',\r\n\t'image.rightAlign' : '右对齐',\r\n\t'image.imgTitle' : '图片说明',\r\n\t'image.upload' : '浏览...',\r\n\t'image.viewServer' : '图片空间',\r\n\t'multiimage.uploadDesc' : '允许用户同时上传<%=uploadLimit%>张图片，单张图片容量不超过<%=sizeLimit%>',\r\n\t'multiimage.startUpload' : '开始上传',\r\n\t'multiimage.clearAll' : '全部清空',\r\n\t'multiimage.insertAll' : '全部插入',\r\n\t'multiimage.queueLimitExceeded' : '文件数量超过限制。',\r\n\t'multiimage.fileExceedsSizeLimit' : '文件大小超过限制。',\r\n\t'multiimage.zeroByteFile' : '无法上传空文件。',\r\n\t'multiimage.invalidFiletype' : '文件类型不正确。',\r\n\t'multiimage.unknownError' : '发生异常，无法上传。',\r\n\t'multiimage.pending' : '等待上传',\r\n\t'multiimage.uploadError' : '上传失败',\r\n\t'filemanager.emptyFolder' : '空文件夹',\r\n\t'filemanager.moveup' : '移到上一级文件夹',\r\n\t'filemanager.viewType' : '显示方式：',\r\n\t'filemanager.viewImage' : '缩略图',\r\n\t'filemanager.listImage' : '详细信息',\r\n\t'filemanager.orderType' : '排序方式：',\r\n\t'filemanager.fileName' : '名称',\r\n\t'filemanager.fileSize' : '大小',\r\n\t'filemanager.fileType' : '类型',\r\n\t'insertfile.url' : 'URL',\r\n\t'insertfile.title' : '文件说明',\r\n\t'insertfile.upload' : '上传',\r\n\t'insertfile.viewServer' : '文件空间',\r\n\t'table.cells' : '单元格数',\r\n\t'table.rows' : '行数',\r\n\t'table.cols' : '列数',\r\n\t'table.size' : '大小',\r\n\t'table.width' : '宽度',\r\n\t'table.height' : '高度',\r\n\t'table.percent' : '%',\r\n\t'table.px' : 'px',\r\n\t'table.space' : '边距间距',\r\n\t'table.padding' : '边距',\r\n\t'table.spacing' : '间距',\r\n\t'table.align' : '对齐方式',\r\n\t'table.textAlign' : '水平对齐',\r\n\t'table.verticalAlign' : '垂直对齐',\r\n\t'table.alignDefault' : '默认',\r\n\t'table.alignLeft' : '左对齐',\r\n\t'table.alignCenter' : '居中',\r\n\t'table.alignRight' : '右对齐',\r\n\t'table.alignTop' : '顶部',\r\n\t'table.alignMiddle' : '中部',\r\n\t'table.alignBottom' : '底部',\r\n\t'table.alignBaseline' : '基线',\r\n\t'table.border' : '边框',\r\n\t'table.borderWidth' : '边框',\r\n\t'table.borderColor' : '颜色',\r\n\t'table.backgroundColor' : '背景颜色',\r\n\t'map.address' : '地址: ',\r\n\t'map.search' : '搜索',\r\n\t'baidumap.address' : '地址: ',\r\n\t'baidumap.search' : '搜索',\r\n\t'baidumap.insertDynamicMap' : '插入动态地图',\r\n\t'anchor.name' : '锚点名称',\r\n\t'formatblock.formatBlock' : {\r\n\t\th1 : '标题 1',\r\n\t\th2 : '标题 2',\r\n\t\th3 : '标题 3',\r\n\t\th4 : '标题 4',\r\n\t\tp : '正 文'\r\n\t},\r\n\t'fontname.fontName' : {\r\n\t\t'SimSun' : '宋体',\r\n\t\t'NSimSun' : '新宋体',\r\n\t\t'FangSong_GB2312' : '仿宋_GB2312',\r\n\t\t'KaiTi_GB2312' : '楷体_GB2312',\r\n\t\t'SimHei' : '黑体',\r\n\t\t'Microsoft YaHei' : '微软雅黑',\r\n\t\t'Arial' : 'Arial',\r\n\t\t'Arial Black' : 'Arial Black',\r\n\t\t'Times New Roman' : 'Times New Roman',\r\n\t\t'Courier New' : 'Courier New',\r\n\t\t'Tahoma' : 'Tahoma',\r\n\t\t'Verdana' : 'Verdana'\r\n\t},\r\n\t'lineheight.lineHeight' : [\r\n\t\t{'1' : '单倍行距'},\r\n\t\t{'1.5' : '1.5倍行距'},\r\n\t\t{'2' : '2倍行距'},\r\n\t\t{'2.5' : '2.5倍行距'},\r\n\t\t{'3' : '3倍行距'}\r\n\t],\r\n\t'template.selectTemplate' : '可选模板',\r\n\t'template.replaceContent' : '替换当前内容',\r\n\t'template.fileList' : {\r\n\t\t'1.html' : '图片和文字',\r\n\t\t'2.html' : '表格',\r\n\t\t'3.html' : '项目编号'\r\n\t}\r\n}, 'zh-CN');\r\nKindEditor.options.langType = 'zh-CN';\r\n/*******************************************************************************\n* KindEditor - WYSIWYG HTML Editor for Internet\n* Copyright (C) 2006-2011 kindsoft.net\n*\n* @author Roddy <luolonghao@gmail.com>\n* @site http://www.kindsoft.net/\n* @licence http://www.kindsoft.net/license.php\n*******************************************************************************/\nKindEditor.plugin('anchor', function(K) {\n\tvar self = this, name = 'anchor', lang = self.lang(name + '.');\n\tself.plugin.anchor = {\n\t\tedit : function() {\n\t\t\tvar html = ['<div style=\"padding:20px;\">',\n\t\t\t\t\t'<div class=\"ke-dialog-row\">',\n\t\t\t\t\t'<label for=\"keName\">' + lang.name + '</label>',\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keName\" name=\"name\" value=\"\" style=\"width:100px;\" />',\n\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('');\n\t\t\tvar dialog = self.createDialog({\n\t\t\t\tname : name,\n\t\t\t\twidth : 300,\n\t\t\t\ttitle : self.lang(name),\n\t\t\t\tbody : html,\n\t\t\t\tyesBtn : {\n\t\t\t\t\tname : self.lang('yes'),\n\t\t\t\t\tclick : function(e) {\n\t\t\t\t\t\tself.insertHtml('<a name=\"' + nameBox.val() + '\">').hideDialog().focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar div = dialog.div,\n\t\t\t\tnameBox = K('input[name=\"name\"]', div);\n\t\t\tvar img = self.plugin.getSelectedAnchor();\n\t\t\tif (img) {\n\t\t\t\tnameBox.val(unescape(img.attr('data-ke-name')));\n\t\t\t}\n\t\t\tnameBox[0].focus();\n\t\t\tnameBox[0].select();\n\t\t},\n\t\t'delete' : function() {\n\t\t\tself.plugin.getSelectedAnchor().remove();\n\t\t}\n\t};\n\tself.clickToolbar(name, self.plugin.anchor.edit);\n});\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('autoheight', function(K) {\r\n\tvar self = this;\r\n\tif (!self.autoHeightMode) {\r\n\t\treturn;\r\n\t}\r\n\tvar minHeight;\r\n\tfunction hideScroll() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe[0].scroll = 'no';\r\n\t\tbody.style.overflowY = 'hidden';\r\n\t}\r\n\tfunction resetHeight() {\r\n\t\tvar edit = self.edit;\r\n\t\tvar body = edit.doc.body;\r\n\t\tedit.iframe.height(minHeight);\r\n\t\tself.resize(null, Math.max((K.IE ? body.scrollHeight : body.offsetHeight) + 76, minHeight));\r\n\t}\r\n\tfunction init() {\r\n\t\tminHeight = K.removeUnit(self.height);\r\n\t\tself.edit.afterChange(resetHeight);\r\n\t\thideScroll();\r\n\t\tresetHeight();\r\n\t}\r\n\tif (self.isCreated) {\r\n\t\tinit();\r\n\t} else {\r\n\t\tself.afterCreate(init);\r\n\t}\r\n});\r\n/*\r\n* 如何实现真正的自动高度？\r\n* 修改编辑器高度之后，再次获取body内容高度时，最小值只会是当前iframe的设置高度，这样就导致高度只增不减。\r\n* 所以每次获取body内容高度之前，先将iframe的高度重置为最小高度，这样就能获取body的实际高度。\r\n* 由此就实现了真正的自动高度\r\n* 测试：chrome、firefox、IE9、IE8\r\n* */\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('baidumap', function(K) {\r\n\tvar self = this, name = 'baidumap', lang = self.lang(name + '.');\r\n\tvar mapWidth = K.undef(self.mapWidth, 558);\r\n\tvar mapHeight = K.undef(self.mapHeight, 360);\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t'<input type=\"checkbox\" id=\"keInsertDynamicMap\" name=\"insertDynamicMap\" value=\"1\" /> <label for=\"keInsertDynamicMap\">' + lang.insertDynamicMap + '</label>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : mapWidth + 42,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar map = win.map;\r\n\t\t\t\t\tvar centerObj = map.getCenter();\r\n\t\t\t\t\tvar center = centerObj.lng + ',' + centerObj.lat;\r\n\t\t\t\t\tvar zoom = map.getZoom();\r\n\t\t\t\t\tvar url = [checkbox[0].checked ? self.pluginsPath + 'baidumap/index.html' : 'http://api.map.baidu.com/staticimage',\r\n\t\t\t\t\t\t'?center=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&zoom=' + encodeURIComponent(zoom),\r\n\t\t\t\t\t\t'&width=' + mapWidth,\r\n\t\t\t\t\t\t'&height=' + mapHeight,\r\n\t\t\t\t\t\t'&markers=' + encodeURIComponent(center),\r\n\t\t\t\t\t\t'&markerStyles=' + encodeURIComponent('l,A')].join('');\r\n\t\t\t\t\tif (checkbox[0].checked) {\r\n\t\t\t\t\t\tself.insertHtml('<iframe src=\"' + url + '\" frameborder=\"0\" style=\"width:' + (mapWidth + 2) + 'px;height:' + (mapHeight + 2) + 'px;\"></iframe>');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\tcheckbox = K('[name=\"insertDynamicMap\"]', dialog.div),\r\n\t\t\twin, doc;\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'baidumap/map.html\" style=\"width:' + mapWidth + 'px;height:' + mapHeight + 'px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\nKindEditor.plugin('map', function(K) {\r\n\tvar self = this, name = 'map', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar html = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\tlang.address + ' <input id=\"kindeditor_plugin_map_address\" name=\"address\" class=\"ke-input-text\" value=\"\" style=\"width:200px;\" /> ',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" name=\"searchBtn\" class=\"ke-button-common ke-button\" value=\"' + lang.search + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-map\" style=\"width:558px;height:360px;\"></div>',\r\n\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 600,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar geocoder = win.geocoder,\r\n\t\t\t\t\t\tmap = win.map,\r\n\t\t\t\t\t\tcenter = map.getCenter().lat() + ',' + map.getCenter().lng(),\r\n\t\t\t\t\t\tzoom = map.getZoom(),\r\n\t\t\t\t\t\tmaptype = map.getMapTypeId(),\r\n\t\t\t\t\t\turl = 'http://maps.googleapis.com/maps/api/staticmap';\r\n\t\t\t\t\t\turl += '?center=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&zoom=' + encodeURIComponent(zoom);\r\n\t\t\t\t\t\turl += '&size=558x360';\r\n\t\t\t\t\t\turl += '&maptype=' + encodeURIComponent(maptype);\r\n\t\t\t\t\t\turl += '&markers=' + encodeURIComponent(center);\r\n\t\t\t\t\t\turl += '&language=' + self.langType;\r\n\t\t\t\t\t\turl += '&sensor=false';\r\n\t\t\t\t\tself.exec('insertimage', url).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tsearchBtn.remove();\r\n\t\t\t\tif (doc) {\r\n\t\t\t\t\tdoc.write('');\r\n\t\t\t\t}\r\n\t\t\t\tiframe.remove();\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar div = dialog.div,\r\n\t\t\taddressBox = K('[name=\"address\"]', div),\r\n\t\t\tsearchBtn = K('[name=\"searchBtn\"]', div),\r\n\t\t\twin, doc;\r\n\t\tvar iframeHtml = ['<!doctype html><html><head>',\r\n\t\t\t'<meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\" />',\r\n\t\t\t'<style>',\r\n\t\t\t'\thtml { height: 100% }',\r\n\t\t\t'\tbody { height: 100%; margin: 0; padding: 0; background-color: #FFF }',\r\n\t\t\t'\t#map_canvas { height: 100% }',\r\n\t\t\t'</style>',\r\n\t\t\t'<script src=\"http://maps.googleapis.com/maps/api/js?sensor=false&language=' + self.langType + '\"></script>',\r\n\t\t\t'<script>',\r\n\t\t\t'var map, geocoder;',\r\n\t\t\t'function initialize() {',\r\n\t\t\t'\tvar latlng = new google.maps.LatLng(31.230393, 121.473704);',\r\n\t\t\t'\tvar options = {',\r\n\t\t\t'\t\tzoom: 11,',\r\n\t\t\t'\t\tcenter: latlng,',\r\n\t\t\t'\t\tdisableDefaultUI: true,',\r\n\t\t\t'\t\tpanControl: true,',\r\n\t\t\t'\t\tzoomControl: true,',\r\n\t\t\t'\t\tmapTypeControl: true,',\r\n\t\t\t'\t\tscaleControl: true,',\r\n\t\t\t'\t\tstreetViewControl: false,',\r\n\t\t\t'\t\toverviewMapControl: true,',\r\n\t\t\t'\t\tmapTypeId: google.maps.MapTypeId.ROADMAP',\r\n\t\t\t'\t};',\r\n\t\t\t'\tmap = new google.maps.Map(document.getElementById(\"map_canvas\"), options);',\r\n\t\t\t'\tgeocoder = new google.maps.Geocoder();',\r\n\t\t\t'\tgeocoder.geocode({latLng: latlng}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tif (results[3]) {',\r\n\t\t\t'\t\t\t\tparent.document.getElementById(\"kindeditor_plugin_map_address\").value = results[3].formatted_address;',\r\n\t\t\t'\t\t\t}',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'function search(address) {',\r\n\t\t\t'\tif (!map) return;',\r\n\t\t\t'\tgeocoder.geocode({address : address}, function(results, status) {',\r\n\t\t\t'\t\tif (status == google.maps.GeocoderStatus.OK) {',\r\n\t\t\t'\t\t\tmap.setZoom(11);',\r\n\t\t\t'\t\t\tmap.setCenter(results[0].geometry.location);',\r\n\t\t\t'\t\t\tvar marker = new google.maps.Marker({',\r\n\t\t\t'\t\t\t\tmap: map,',\r\n\t\t\t'\t\t\t\tposition: results[0].geometry.location',\r\n\t\t\t'\t\t\t});',\r\n\t\t\t'\t\t} else {',\r\n\t\t\t'\t\t\talert(\"Invalid address: \" + address);',\r\n\t\t\t'\t\t}',\r\n\t\t\t'\t});',\r\n\t\t\t'}',\r\n\t\t\t'</script>',\r\n\t\t\t'</head>',\r\n\t\t\t'<body onload=\"initialize();\">',\r\n\t\t\t'<div id=\"map_canvas\" style=\"width:100%; height:100%\"></div>',\r\n\t\t\t'</body></html>'].join('\\n');\r\n\t\tvar iframe = K('<iframe class=\"ke-textarea\" frameborder=\"0\" src=\"' + self.pluginsPath + 'map/map.html\" style=\"width:558px;height:360px;\"></iframe>');\r\n\t\tfunction ready() {\r\n\t\t\twin = iframe[0].contentWindow;\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\t}\r\n\t\tiframe.bind('load', function() {\r\n\t\t\tiframe.unbind('load');\r\n\t\t\tif (K.IE) {\r\n\t\t\t\tready();\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(ready, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t\tK('.ke-map', div).replaceWith(iframe);\r\n\t\tsearchBtn.click(function() {\r\n\t\t\twin.search(addressBox.val());\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('clearhtml', function(K) {\r\n\tvar self = this, name = 'clearhtml';\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar html = self.html();\r\n\t\thtml = html.replace(/(<script[^>]*>)([\\s\\S]*?)(<\\/script>)/ig, '');\r\n\t\thtml = html.replace(/(<style[^>]*>)([\\s\\S]*?)(<\\/style>)/ig, '');\r\n\t\thtml = K.formatHtml(html, {\r\n\t\t\ta : ['href', 'target'],\r\n\t\t\tembed : ['src', 'width', 'height', 'type', 'loop', 'autostart', 'quality', '.width', '.height', 'align', 'allowscriptaccess'],\r\n\t\t\timg : ['src', 'width', 'height', 'border', 'alt', 'title', '.width', '.height'],\r\n\t\t\ttable : ['border'],\r\n\t\t\t'td,th' : ['rowspan', 'colspan'],\r\n\t\t\t'div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6' : []\r\n\t\t});\r\n\t\tself.html(html);\r\n\t\tself.cmd.selection(true);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n\r\r\r\nKindEditor.plugin('code', function(K) {\r\n\tvar self = this, name = 'code';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<select class=\"ke-code-type\">',\r\n\t\t\t\t'<option value=\"js\">JavaScript</option>',\r\n\t\t\t\t'<option value=\"html\">HTML</option>',\r\n\t\t\t\t'<option value=\"css\">CSS</option>',\r\n\t\t\t\t'<option value=\"php\">PHP</option>',\r\n\t\t\t\t'<option value=\"pl\">Perl</option>',\r\n\t\t\t\t'<option value=\"py\">Python</option>',\r\n\t\t\t\t'<option value=\"rb\">Ruby</option>',\r\n\t\t\t\t'<option value=\"java\">Java</option>',\r\n\t\t\t\t'<option value=\"vb\">ASP/VB</option>',\r\n\t\t\t\t'<option value=\"cpp\">C/C++</option>',\r\n\t\t\t\t'<option value=\"cs\">C#</option>',\r\n\t\t\t\t'<option value=\"xml\">XML</option>',\r\n\t\t\t\t'<option value=\"bsh\">Shell</option>',\r\n\t\t\t\t'<option value=\"\">Other</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>',\r\n\t\t\t\t'</div>'].join(''),\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar type = K('.ke-code-type', dialog.div).val(),\r\n\t\t\t\t\t\t\tcode = textarea.val(),\r\n\t\t\t\t\t\t\tcls = type === '' ? '' :  ' lang-' + type,\r\n\t\t\t\t\t\t\thtml = '<pre class=\"prettyprint' + cls + '\">\\n' + K.escape(code) + '</pre> ';\r\n\t\t\t\t\t\tif (K.trim(code) === '') {\r\n\t\t\t\t\t\t\talert(lang.pleaseInput);\r\n\t\t\t\t\t\t\ttextarea[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('emoticons', function(K) {\r\n\tvar self = this, name = 'emoticons',\r\n\t\tpath = (self.emoticonsPath || self.pluginsPath + 'emoticons/images/'),\r\n\t\tallowPreview = self.allowPreviewEmoticons === undefined ? true : self.allowPreviewEmoticons,\r\n\t\tcurrentPageNum = 1;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar rows = 5, cols = 9, total = 135, startNum = 0,\r\n\t\t\tcells = rows * cols, pages = Math.ceil(total / cells),\r\n\t\t\tcolsHalf = Math.floor(cols / 2),\r\n\t\t\twrapperDiv = K('<div class=\"ke-plugin-emoticons\"></div>'),\r\n\t\t\telements = [],\r\n\t\t\tmenu = self.createMenu({\r\n\t\t\t\tname : name,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tremoveEvent();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\tmenu.div.append(wrapperDiv);\r\n\t\tvar previewDiv, previewImg;\r\n\t\tif (allowPreview) {\r\n\t\t\tpreviewDiv = K('<div class=\"ke-preview\"></div>').css('right', 0);\r\n\t\t\tpreviewImg = K('<img class=\"ke-preview-img\" src=\"' + path + startNum + '.gif\" />');\r\n\t\t\twrapperDiv.append(previewDiv);\r\n\t\t\tpreviewDiv.append(previewImg);\r\n\t\t}\r\n\t\tfunction bindCellEvent(cell, j, num) {\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tif (j > colsHalf) {\r\n\t\t\t\t\t\tpreviewDiv.css('left', 0);\r\n\t\t\t\t\t\tpreviewDiv.css('right', '');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpreviewDiv.css('left', '');\r\n\t\t\t\t\t\tpreviewDiv.css('right', 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviewImg.attr('src', path + num + '.gif');\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcell.mouseover(function() {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcell.mouseout(function() {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\t\tcell.click(function(e) {\r\n\t\t\t\tself.insertHtml('<img src=\"' + path + num + '.gif\" border=\"0\" alt=\"\" />').hideMenu().focus();\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createEmoticonsTable(pageNum, parentDiv) {\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\tparentDiv.append(table);\r\n\t\t\tif (previewDiv) {\r\n\t\t\t\tK(table).mouseover(function() {\r\n\t\t\t\t\tpreviewDiv.show('block');\r\n\t\t\t\t});\r\n\t\t\t\tK(table).mouseout(function() {\r\n\t\t\t\t\tpreviewDiv.hide();\r\n\t\t\t\t});\r\n\t\t\t\telements.push(K(table));\r\n\t\t\t}\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tvar num = (pageNum - 1) * cells + startNum;\r\n\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\tvar row = table.insertRow(i);\r\n\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\tvar cell = K(row.insertCell(j));\r\n\t\t\t\t\tcell.addClass('ke-cell');\r\n\t\t\t\t\tbindCellEvent(cell, j, num);\r\n\t\t\t\t\tvar span = K('<span class=\"ke-img\"></span>')\r\n\t\t\t\t\t\t.css('background-position', '-' + (24 * num) + 'px 0px')\r\n\t\t\t\t\t\t.css('background-image', 'url(' + path + 'static.gif)');\r\n\t\t\t\t\tcell.append(span);\r\n\t\t\t\t\telements.push(cell);\r\n\t\t\t\t\tnum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn table;\r\n\t\t}\r\n\t\tvar table = createEmoticonsTable(currentPageNum, wrapperDiv);\r\n\t\tfunction removeEvent() {\r\n\t\t\tK.each(elements, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar pageDiv;\r\n\t\tfunction bindPageEvent(el, pageNum) {\r\n\t\t\tel.click(function(e) {\r\n\t\t\t\tremoveEvent();\r\n\t\t\t\ttable.parentNode.removeChild(table);\r\n\t\t\t\tpageDiv.remove();\r\n\t\t\t\ttable = createEmoticonsTable(pageNum, wrapperDiv);\r\n\t\t\t\tcreatePageTable(pageNum);\r\n\t\t\t\tcurrentPageNum = pageNum;\r\n\t\t\t\te.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfunction createPageTable(currentPageNum) {\r\n\t\t\tpageDiv = K('<div class=\"ke-page\"></div>');\r\n\t\t\twrapperDiv.append(pageDiv);\r\n\t\t\tfor (var pageNum = 1; pageNum <= pages; pageNum++) {\r\n\t\t\t\tif (currentPageNum !== pageNum) {\r\n\t\t\t\t\tvar a = K('<a href=\"javascript:;\">[' + pageNum + ']</a>');\r\n\t\t\t\t\tbindPageEvent(a, pageNum);\r\n\t\t\t\t\tpageDiv.append(a);\r\n\t\t\t\t\telements.push(a);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageDiv.append(K('@[' + pageNum + ']'));\r\n\t\t\t\t}\r\n\t\t\t\tpageDiv.append(K('@&nbsp;'));\r\n\t\t\t}\r\n\t\t}\r\n\t\tcreatePageTable(currentPageNum);\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('filemanager', function(K) {\r\n\tvar self = this, name = 'filemanager',\r\n\t\tfileManagerJson = K.undef(self.fileManagerJson, self.basePath + 'php/file_manager_json.php'),\r\n\t\timgPath = self.pluginsPath + name + '/images/',\r\n\t\tlang = self.lang(name + '.');\r\n\tfunction makeFileTitle(filename, filesize, datetime) {\r\n\t\treturn filename + ' (' + Math.ceil(filesize / 1024) + 'KB, ' + datetime + ')';\r\n\t}\r\n\tfunction bindTitle(el, data) {\r\n\t\tif (data.is_dir) {\r\n\t\t\tel.attr('title', data.filename);\r\n\t\t} else {\r\n\t\t\tel.attr('title', makeFileTitle(data.filename, data.filesize, data.datetime));\r\n\t\t}\r\n\t}\r\n\tself.plugin.filemanagerDialog = function(options) {\r\n\t\tvar width = K.undef(options.width, 650),\r\n\t\t\theight = K.undef(options.height, 510),\r\n\t\t\tdirName = K.undef(options.dirName, ''),\r\n\t\t\tviewType = K.undef(options.viewType, 'VIEW').toUpperCase(),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:10px 20px;\">',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-header\">',\r\n\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t'<img class=\"ke-inline-block\" name=\"moveupImg\" src=\"' + imgPath + 'go-up.gif\" width=\"16\" height=\"16\" border=\"0\" alt=\"\" /> ',\r\n\t\t\t'<a class=\"ke-inline-block\" name=\"moveupLink\" href=\"javascript:;\">' + lang.moveup + '</a>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-right\">',\r\n\t\t\tlang.viewType + ' <select class=\"ke-inline-block\" name=\"viewType\">',\r\n\t\t\t'<option value=\"VIEW\">' + lang.viewImage + '</option>',\r\n\t\t\t'<option value=\"LIST\">' + lang.listImage + '</option>',\r\n\t\t\t'</select> ',\r\n\t\t\tlang.orderType + ' <select class=\"ke-inline-block\" name=\"orderType\">',\r\n\t\t\t'<option value=\"NAME\">' + lang.fileName + '</option>',\r\n\t\t\t'<option value=\"SIZE\">' + lang.fileSize + '</option>',\r\n\t\t\t'<option value=\"TYPE\">' + lang.fileType + '</option>',\r\n\t\t\t'</select>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-plugin-filemanager-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : width,\r\n\t\t\theight : height,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html\r\n\t\t}),\r\n\t\tdiv = dialog.div,\r\n\t\tbodyDiv = K('.ke-plugin-filemanager-body', div),\r\n\t\tmoveupImg = K('[name=\"moveupImg\"]', div),\r\n\t\tmoveupLink = K('[name=\"moveupLink\"]', div),\r\n\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\tviewTypeBox = K('[name=\"viewType\"]', div),\r\n\t\torderTypeBox = K('[name=\"orderType\"]', div);\r\n\t\tfunction reloadPage(path, order, func) {\r\n\t\t\tvar param = 'path=' + path + '&order=' + order + '&dir=' + dirName;\r\n\t\t\tdialog.showLoading(self.lang('ajaxLoading'));\r\n\t\t\tK.ajax(K.addParam(fileManagerJson, param + '&' + new Date().getTime()), function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tfunc(data);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar elList = [];\r\n\t\tfunction bindEvent(el, result, data, createFunc) {\r\n\t\t\tvar fileUrl = K.formatUrl(result.current_url + data.filename, 'absolute'),\r\n\t\t\t\tdirPath = encodeURIComponent(result.current_dir_path + data.filename + '/');\r\n\t\t\tif (data.is_dir) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\treloadPage(dirPath, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t} else if (data.is_photo) {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tel.click(function(e) {\r\n\t\t\t\t\tclickFn.call(this, fileUrl, data.filename);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telList.push(el);\r\n\t\t}\r\n\t\tfunction createCommon(result, createFunc) {\r\n\t\t\tK.each(elList, function() {\r\n\t\t\t\tthis.unbind();\r\n\t\t\t});\r\n\t\t\tmoveupLink.unbind();\r\n\t\t\tviewTypeBox.unbind();\r\n\t\t\torderTypeBox.unbind();\r\n\t\t\tif (result.current_dir_path) {\r\n\t\t\t\tmoveupLink.click(function(e) {\r\n\t\t\t\t\treloadPage(result.moveup_dir_path, orderTypeBox.val(), createFunc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tfunction changeFunc() {\r\n\t\t\t\tif (viewTypeBox.val() == 'VIEW') {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treloadPage(result.current_dir_path, orderTypeBox.val(), createList);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tviewTypeBox.change(changeFunc);\r\n\t\t\torderTypeBox.change(changeFunc);\r\n\t\t\tbodyDiv.html('');\r\n\t\t}\r\n\t\tfunction createList(result) {\r\n\t\t\tcreateCommon(result, createList);\r\n\t\t\tvar table = document.createElement('table');\r\n\t\t\ttable.className = 'ke-table';\r\n\t\t\ttable.cellPadding = 0;\r\n\t\t\ttable.cellSpacing = 0;\r\n\t\t\ttable.border = 0;\r\n\t\t\tbodyDiv.append(table);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i], row = K(table.insertRow(i));\r\n\t\t\t\trow.mouseover(function(e) {\r\n\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t})\r\n\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t});\r\n\t\t\t\tvar iconUrl = imgPath + (data.is_dir ? 'folder-16.gif' : 'file-16.gif'),\r\n\t\t\t\t\timg = K('<img src=\"' + iconUrl + '\" width=\"16\" height=\"16\" alt=\"' + data.filename + '\" align=\"absmiddle\" />'),\r\n\t\t\t\t\tcell0 = K(row[0].insertCell(0)).addClass('ke-cell ke-name').append(img).append(document.createTextNode(' ' + data.filename));\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\trow.css('cursor', 'pointer');\r\n\t\t\t\t\tcell0.attr('title', data.filename);\r\n\t\t\t\t\tbindEvent(cell0, result, data, createList);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell0.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tK(row[0].insertCell(1)).addClass('ke-cell ke-size').html(data.is_dir ? '-' : Math.ceil(data.filesize / 1024) + 'KB');\r\n\t\t\t\tK(row[0].insertCell(2)).addClass('ke-cell ke-datetime').html(data.datetime);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction createView(result) {\r\n\t\t\tcreateCommon(result, createView);\r\n\t\t\tvar fileList = result.file_list;\r\n\t\t\tfor (var i = 0, len = fileList.length; i < len; i++) {\r\n\t\t\t\tvar data = fileList[i],\r\n\t\t\t\t\tdiv = K('<div class=\"ke-inline-block ke-item\"></div>');\r\n\t\t\t\tbodyDiv.append(div);\r\n\t\t\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t\t\t.mouseover(function(e) {\r\n\t\t\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.mouseout(function(e) {\r\n\t\t\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t\t\t});\r\n\t\t\t\tdiv.append(photoDiv);\r\n\t\t\t\tvar fileUrl = result.current_url + data.filename,\r\n\t\t\t\t\ticonUrl = data.is_dir ? imgPath + 'folder-64.gif' : (data.is_photo ? fileUrl : imgPath + 'file-64.gif');\r\n\t\t\t\tvar img = K('<img src=\"' + iconUrl + '\" width=\"80\" height=\"80\" alt=\"' + data.filename + '\" />');\r\n\t\t\t\tif (!data.is_dir || data.has_file) {\r\n\t\t\t\t\tphotoDiv.css('cursor', 'pointer');\r\n\t\t\t\t\tbindTitle(photoDiv, data);\r\n\t\t\t\t\tbindEvent(photoDiv, result, data, createView);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tphotoDiv.attr('title', lang.emptyFolder);\r\n\t\t\t\t}\r\n\t\t\t\tphotoDiv.append(img);\r\n\t\t\t\tdiv.append('<div class=\"ke-name\" title=\"' + data.filename + '\">' + data.filename + '</div>');\r\n\t\t\t}\r\n\t\t}\r\n\t\tviewTypeBox.val(viewType);\r\n\t\treloadPage('', orderTypeBox.val(), viewType == 'VIEW' ? createView : createList);\r\n\t\treturn dialog;\r\n\t}\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('flash', function(K) {\r\n\tvar self = this, name = 'flash', lang = self.lang(name + '.'),\r\n\t\tallowFlashUpload = K.undef(self.allowFlashUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.flash = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType('.swf'),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tquality : 'high'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowFlashUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=flash'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'flash',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedFlash();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedFlash().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.flash.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('image', function(K) {\r\n\tvar self = this, name = 'image',\r\n\t\tallowImageUpload = K.undef(self.allowImageUpload, true),\r\n\t\tallowImageRemote = K.undef(self.allowImageRemote, true),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timageTabIndex = K.undef(self.imageTabIndex, 0),\r\n\t\timgPath = self.pluginsPath + 'image/images/',\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tfillDescAfterUploadImage = K.undef(self.fillDescAfterUploadImage, false),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.imageDialog = function(options) {\r\n\t\tvar imageUrl = options.imageUrl,\r\n\t\t\timageWidth = K.undef(options.imageWidth, ''),\r\n\t\t\timageHeight = K.undef(options.imageHeight, ''),\r\n\t\t\timageTitle = K.undef(options.imageTitle, ''),\r\n\t\t\timageAlign = K.undef(options.imageAlign, ''),\r\n\t\t\tshowRemote = K.undef(options.showRemote, true),\r\n\t\t\tshowLocal = K.undef(options.showLocal, true),\r\n\t\t\ttabIndex = K.undef(options.tabIndex, 0),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar target = 'kindeditor_upload_iframe_' + new Date().getTime();\r\n\t\tvar hiddenElements = [];\r\n\t\tfor(var k in extraParams){\r\n\t\t\thiddenElements.push('<input type=\"hidden\" name=\"' + k + '\" value=\"' + extraParams[k] + '\" />');\r\n\t\t}\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"tabs\"></div>',\r\n\t\t\t'<div class=\"tab1\" style=\"display:none;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteUrl\" style=\"width:60px;\">' + lang.remoteUrl + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteUrl\" class=\"ke-input-text\" name=\"url\" value=\"\" style=\"width:200px;\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteWidth\" style=\"width:60px;\">' + lang.size + '</label>',\r\n\t\t\tlang.width + ' <input type=\"text\" id=\"remoteWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> ',\r\n\t\t\t'<img class=\"ke-refresh-btn\" src=\"' + imgPath + 'refresh.png\" width=\"16\" height=\"16\" alt=\"\" style=\"cursor:pointer;\" title=\"' + lang.resetSize + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label style=\"width:60px;\">' + lang.align + '</label>',\r\n\t\t\t'<input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"\" checked=\"checked\" /> <img name=\"defaultImg\" src=\"' + imgPath + 'align_top.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"left\" /> <img name=\"leftImg\" src=\"' + imgPath + 'align_left.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t' <input type=\"radio\" name=\"align\" class=\"ke-inline-block\" value=\"right\" /> <img name=\"rightImg\" src=\"' + imgPath + 'align_right.gif\" width=\"23\" height=\"25\" alt=\"\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"remoteTitle\" style=\"width:60px;\">' + lang.imgTitle + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"remoteTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:200px;\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"tab2\" style=\"display:none;\">',\r\n\t\t\t'<iframe name=\"' + target + '\" style=\"display:none;\"></iframe>',\r\n\t\t\t'<form class=\"ke-upload-area ke-form\" method=\"post\" enctype=\"multipart/form-data\" target=\"' + target + '\" action=\"' + K.addParam(uploadJson, 'dir=image') + '\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\thiddenElements.join(''),\r\n\t\t\t'<label style=\"width:60px;\">' + lang.localUrl + '</label>',\r\n\t\t\t'<input type=\"text\" name=\"localUrl\" class=\"ke-input-text\" tabindex=\"-1\" style=\"width:200px;\" readonly=\"true\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialogWidth = showLocal || allowFileManager ? 450 : 400,\r\n\t\t\tdialogHeight = showLocal && showRemote ? 300 : 250;\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : dialogWidth,\r\n\t\t\theight : dialogHeight,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tif (dialog.isLoading) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (showLocal && showRemote && tabs && tabs.selectedIndex === 1 || !showRemote) {\r\n\t\t\t\t\t\tif (uploadbutton.fileBox.val() == '') {\r\n\t\t\t\t\t\t\talert(self.lang('pleaseSelectFile'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t\t\tlocalUrlBox.val('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\ttitle = titleBox.val(),\r\n\t\t\t\t\t\talign = '';\r\n\t\t\t\t\talignBox.each(function() {\r\n\t\t\t\t\t\tif (this.checked) {\r\n\t\t\t\t\t\t\talign = this.value;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title, width, height, 0, align);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tviewServerBtn.unbind();\r\n\t\t\t\twidthBox.unbind();\r\n\t\t\t\theightBox.unbind();\r\n\t\t\t\trefreshBtn.unbind();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tlocalUrlBox = K('[name=\"localUrl\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('.tab1 [name=\"width\"]', div),\r\n\t\t\theightBox = K('.tab1 [name=\"height\"]', div),\r\n\t\t\trefreshBtn = K('.ke-refresh-btn', div),\r\n\t\t\ttitleBox = K('.tab1 [name=\"title\"]', div),\r\n\t\t\talignBox = K('.tab1 [name=\"align\"]', div);\r\n\t\tvar tabs;\r\n\t\tif (showRemote && showLocal) {\r\n\t\t\ttabs = K.tabs({\r\n\t\t\t\tsrc : K('.tabs', div),\r\n\t\t\t\tafterSelect : function(i) {}\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.remoteImage,\r\n\t\t\t\tpanel : K('.tab1', div)\r\n\t\t\t});\r\n\t\t\ttabs.add({\r\n\t\t\t\ttitle : lang.localImage,\r\n\t\t\t\tpanel : K('.tab2', div)\r\n\t\t\t});\r\n\t\t\ttabs.select(tabIndex);\r\n\t\t} else if (showRemote) {\r\n\t\t\tK('.tab1', div).show();\r\n\t\t} else if (showLocal) {\r\n\t\t\tK('.tab2', div).show();\r\n\t\t}\r\n\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\tfieldName : filePostName,\r\n\t\t\tform : K('.ke-form', div),\r\n\t\t\ttarget : target,\r\n\t\t\twidth: 60,\r\n\t\t\tafterUpload : function(data) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!fillDescAfterUploadImage) {\r\n\t\t\t\t\t\tclickFn.call(self, url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tK(\".ke-dialog-row #remoteUrl\", div).val(url);\r\n\t\t\t\t\t\tK(\".ke-tabs-li\", div)[0].click();\r\n\t\t\t\t\t\tK(\".ke-refresh-btn\", div).click();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(data.message);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tdialog.hideLoading();\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\tlocalUrlBox.val(uploadbutton.fileBox.val());\r\n\t\t});\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'VIEW',\r\n\t\t\t\t\t\tdirName : 'image',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\tvar originalWidth = 0, originalHeight = 0;\r\n\t\tfunction setSize(width, height) {\r\n\t\t\twidthBox.val(width);\r\n\t\t\theightBox.val(height);\r\n\t\t\toriginalWidth = width;\r\n\t\t\toriginalHeight = height;\r\n\t\t}\r\n\t\trefreshBtn.click(function(e) {\r\n\t\t\tvar tempImg = K('<img src=\"' + urlBox.val() + '\" />', document).css({\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tvisibility : 'hidden',\r\n\t\t\t\ttop : 0,\r\n\t\t\t\tleft : '-1000px'\r\n\t\t\t});\r\n\t\t\ttempImg.bind('load', function() {\r\n\t\t\t\tsetSize(tempImg.width(), tempImg.height());\r\n\t\t\t\ttempImg.remove();\r\n\t\t\t});\r\n\t\t\tK(document.body).append(tempImg);\r\n\t\t});\r\n\t\twidthBox.change(function(e) {\r\n\t\t\tif (originalWidth > 0) {\r\n\t\t\t\theightBox.val(Math.round(originalHeight / originalWidth * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\theightBox.change(function(e) {\r\n\t\t\tif (originalHeight > 0) {\r\n\t\t\t\twidthBox.val(Math.round(originalWidth / originalHeight * parseInt(this.value, 10)));\r\n\t\t\t}\r\n\t\t});\r\n\t\turlBox.val(options.imageUrl);\r\n\t\tsetSize(options.imageWidth, options.imageHeight);\r\n\t\ttitleBox.val(options.imageTitle);\r\n\t\talignBox.each(function() {\r\n\t\t\tif (this.value === options.imageAlign) {\r\n\t\t\t\tthis.checked = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (showRemote && tabIndex === 0) {\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t}\r\n\t\treturn dialog;\r\n\t};\r\n\tself.plugin.image = {\r\n\t\tedit : function() {\r\n\t\t\tvar img = self.plugin.getSelectedImage();\r\n\t\t\tself.plugin.imageDialog({\r\n\t\t\t\timageUrl : img ? img.attr('data-ke-src') : 'http://',\r\n\t\t\t\timageWidth : img ? img.width() : '',\r\n\t\t\t\timageHeight : img ? img.height() : '',\r\n\t\t\t\timageTitle : img ? img.attr('title') : '',\r\n\t\t\t\timageAlign : img ? img.attr('align') : '',\r\n\t\t\t\tshowRemote : allowImageRemote,\r\n\t\t\t\tshowLocal : allowImageUpload,\r\n\t\t\t\ttabIndex: img ? 0 : imageTabIndex,\r\n\t\t\t\tclickFn : function(url, title, width, height, border, align) {\r\n\t\t\t\t\tif (img) {\r\n\t\t\t\t\t\timg.attr('src', url);\r\n\t\t\t\t\t\timg.attr('data-ke-src', url);\r\n\t\t\t\t\t\timg.attr('width', width);\r\n\t\t\t\t\t\timg.attr('height', height);\r\n\t\t\t\t\t\timg.attr('title', title);\r\n\t\t\t\t\t\timg.attr('align', align);\r\n\t\t\t\t\t\timg.attr('alt', title);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.exec('insertimage', url, title, width, height, border, align);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar target = self.plugin.getSelectedImage();\r\n\t\t\tif (target.parent().name == 'a') {\r\n\t\t\t\ttarget = target.parent();\r\n\t\t\t}\r\n\t\t\ttarget.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.image.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('insertfile', function(K) {\r\n\tvar self = this, name = 'insertfile',\r\n\t\tallowFileUpload = K.undef(self.allowFileUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.fileDialog = function(options) {\r\n\t\tvar fileUrl = K.undef(options.fileUrl, 'http://'),\r\n\t\t\tfileTitle = K.undef(options.fileTitle, ''),\r\n\t\t\tclickFn = options.clickFn;\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keUrl\" name=\"url\" class=\"ke-input-text\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t'<label for=\"keTitle\" style=\"width:60px;\">' + lang.title + '</label>',\r\n\t\t\t'<input type=\"text\" id=\"keTitle\" class=\"ke-input-text\" name=\"title\" value=\"\" style=\"width:160px;\" /></div>',\r\n\t\t\t'</div>',\r\n\t\t\t'</form>',\r\n\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 450,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\ttitle = titleBox.val();\r\n\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (K.trim(title) === '') {\r\n\t\t\t\t\t\ttitle = url;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclickFn.call(self, url, title);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar urlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\ttitleBox = K('[name=\"title\"]', div);\r\n\t\tif (allowFileUpload) {\r\n\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\tfieldName : filePostName,\r\n\t\t\t\turl : K.addParam(uploadJson, 'dir=file'),\r\n\t\t\t\textraParams : extraParams,\r\n\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\tuploadbutton.submit();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t}\r\n\t\tif (allowFileManager) {\r\n\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\tdirName : 'file',\r\n\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tviewServerBtn.hide();\r\n\t\t}\r\n\t\turlBox.val(fileUrl);\r\n\t\ttitleBox.val(fileTitle);\r\n\t\turlBox[0].focus();\r\n\t\turlBox[0].select();\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.fileDialog({\r\n\t\t\tclickFn : function(url, title) {\r\n\t\t\t\tvar html = '<a class=\"ke-insertfile\" href=\"' + url + '\" data-ke-src=\"' + url + '\" target=\"_blank\">' + title + '</a>';\r\n\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('lineheight', function(K) {\r\n\tvar self = this, name = 'lineheight', lang = self.lang(name + '.');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar curVal = '', commonNode = self.cmd.commonNode({'*' : '.line-height'});\r\n\t\tif (commonNode) {\r\n\t\t\tcurVal = commonNode.css('line-height');\r\n\t\t}\r\n\t\tvar menu = self.createMenu({\r\n\t\t\tname : name,\r\n\t\t\twidth : 150\r\n\t\t});\r\n\t\tK.each(lang.lineHeight, function(i, row) {\r\n\t\t\tK.each(row, function(key, val) {\r\n\t\t\t\tmenu.addItem({\r\n\t\t\t\t\ttitle : val,\r\n\t\t\t\t\tchecked : curVal === key,\r\n\t\t\t\t\tclick : function() {\r\n\t\t\t\t\t\tself.cmd.toggle('<span style=\"line-height:' + key + ';\"></span>', {\r\n\t\t\t\t\t\t\tspan : '.line-height=' + key\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.updateState();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\tself.hideMenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('link', function(K) {\r\n\tvar self = this, name = 'link';\r\n\tself.plugin.link = {\r\n\t\tedit : function() {\r\n\t\t\tvar lang = self.lang(name + '.'),\r\n\t\t\t\thtml = '<div style=\"padding:20px;\">' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\">' +\r\n\t\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>' +\r\n\t\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:260px;\" /></div>' +\r\n\t\t\t\t\t'<div class=\"ke-dialog-row\"\">' +\r\n\t\t\t\t\t'<label for=\"keType\" style=\"width:60px;\">' + lang.linkType + '</label>' +\r\n\t\t\t\t\t'<select id=\"keType\" name=\"type\"></select>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\tdialog = self.createDialog({\r\n\t\t\t\t\tname : name,\r\n\t\t\t\t\twidth : 450,\r\n\t\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\t\tbody : html,\r\n\t\t\t\t\tyesBtn : {\r\n\t\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\t\tvar url = K.trim(urlBox.val());\r\n\t\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.exec('createlink', url, typeBox.val()).hideDialog().focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tdiv = dialog.div,\r\n\t\t\t\turlBox = K('input[name=\"url\"]', div),\r\n\t\t\t\ttypeBox = K('select[name=\"type\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\ttypeBox[0].options[0] = new Option(lang.newWindow, '_blank');\r\n\t\t\ttypeBox[0].options[1] = new Option(lang.selfWindow, '');\r\n\t\t\tself.cmd.selection();\r\n\t\t\tvar a = self.plugin.getSelectedLink();\r\n\t\t\tif (a) {\r\n\t\t\t\tself.cmd.range.selectNode(a[0]);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\turlBox.val(a.attr('data-ke-src'));\r\n\t\t\t\ttypeBox.val(a.attr('target'));\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.exec('unlink', null);\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.link.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('media', function(K) {\r\n\tvar self = this, name = 'media', lang = self.lang(name + '.'),\r\n\t\tallowMediaUpload = K.undef(self.allowMediaUpload, true),\r\n\t\tallowFileManager = K.undef(self.allowFileManager, false),\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\textraParams = K.undef(self.extraFileUploadParams, {}),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php');\r\n\tself.plugin.media = {\r\n\t\tedit : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keUrl\" style=\"width:60px;\">' + lang.url + '</label>',\r\n\t\t\t\t'<input class=\"ke-input-text\" type=\"text\" id=\"keUrl\" name=\"url\" value=\"\" style=\"width:160px;\" /> &nbsp;',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-upload-button\" value=\"' + lang.upload + '\" /> &nbsp;',\r\n\t\t\t\t'<span class=\"ke-button-common ke-button-outer\">',\r\n\t\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" name=\"viewServer\" value=\"' + lang.viewServer + '\" />',\r\n\t\t\t\t'</span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:60px;\">' + lang.width + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"550\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keHeight\" style=\"width:60px;\">' + lang.height + '</label>',\r\n\t\t\t\t'<input type=\"text\" id=\"keHeight\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"400\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAutostart\">' + lang.autostart + '</label>',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keAutostart\" name=\"autostart\" value=\"\" /> ',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\theight : 230,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar url = K.trim(urlBox.val()),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val();\r\n\t\t\t\t\t\tif (url == 'http://' || K.invalidUrl(url)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidUrl'));\r\n\t\t\t\t\t\t\turlBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = K.mediaImg(self.themesPath + 'common/blank.gif', {\r\n\t\t\t\t\t\t\t\tsrc : url,\r\n\t\t\t\t\t\t\t\ttype : K.mediaType(url),\r\n\t\t\t\t\t\t\t\twidth : width,\r\n\t\t\t\t\t\t\t\theight : height,\r\n\t\t\t\t\t\t\t\tautostart : autostartBox[0].checked ? 'true' : 'false',\r\n\t\t\t\t\t\t\t\tloop : 'true'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\turlBox = K('[name=\"url\"]', div),\r\n\t\t\tviewServerBtn = K('[name=\"viewServer\"]', div),\r\n\t\t\twidthBox = K('[name=\"width\"]', div),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\tautostartBox = K('[name=\"autostart\"]', div);\r\n\t\t\turlBox.val('http://');\r\n\t\t\tif (allowMediaUpload) {\r\n\t\t\t\tvar uploadbutton = K.uploadbutton({\r\n\t\t\t\t\tbutton : K('.ke-upload-button', div)[0],\r\n\t\t\t\t\tfieldName : filePostName,\r\n\t\t\t\t\textraParams : extraParams,\r\n\t\t\t\t\turl : K.addParam(uploadJson, 'dir=media'),\r\n\t\t\t\t\tafterUpload : function(data) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tif (data.error === 0) {\r\n\t\t\t\t\t\t\tvar url = data.url;\r\n\t\t\t\t\t\t\tif (formatUploadUrl) {\r\n\t\t\t\t\t\t\t\turl = K.formatUrl(url, 'absolute');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\turlBox.val(url);\r\n\t\t\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\t\t\tself.afterUpload.call(self, url, data, name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(self.lang('uploadSuccess'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\talert(data.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tafterError : function(html) {\r\n\t\t\t\t\t\tdialog.hideLoading();\r\n\t\t\t\t\t\tself.errorDialog(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tuploadbutton.fileBox.change(function(e) {\r\n\t\t\t\t\tdialog.showLoading(self.lang('uploadLoading'));\r\n\t\t\t\t\tuploadbutton.submit();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tK('.ke-upload-button', div).hide();\r\n\t\t\t}\r\n\t\t\tif (allowFileManager) {\r\n\t\t\t\tviewServerBtn.click(function(e) {\r\n\t\t\t\t\tself.loadPlugin('filemanager', function() {\r\n\t\t\t\t\t\tself.plugin.filemanagerDialog({\r\n\t\t\t\t\t\t\tviewType : 'LIST',\r\n\t\t\t\t\t\t\tdirName : 'media',\r\n\t\t\t\t\t\t\tclickFn : function(url, title) {\r\n\t\t\t\t\t\t\t\tif (self.dialogs.length > 1) {\r\n\t\t\t\t\t\t\t\t\tK('[name=\"url\"]', div).val(url);\r\n\t\t\t\t\t\t\t\t\tif (self.afterSelectFile) {\r\n\t\t\t\t\t\t\t\t\t\tself.afterSelectFile.call(self, url);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tself.hideDialog();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tviewServerBtn.hide();\r\n\t\t\t}\r\n\t\t\tvar img = self.plugin.getSelectedMedia();\r\n\t\t\tif (img) {\r\n\t\t\t\tvar attrs = K.mediaAttrs(img.attr('data-ke-tag'));\r\n\t\t\t\turlBox.val(attrs.src);\r\n\t\t\t\twidthBox.val(K.removeUnit(img.css('width')) || attrs.width || 0);\r\n\t\t\t\theightBox.val(K.removeUnit(img.css('height')) || attrs.height || 0);\r\n\t\t\t\tautostartBox[0].checked = (attrs.autostart === 'true');\r\n\t\t\t}\r\n\t\t\turlBox[0].focus();\r\n\t\t\turlBox[0].select();\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tself.plugin.getSelectedMedia().remove();\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.media.edit);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\n(function(K) {\r\nfunction KSWFUpload(options) {\r\n\tthis.init(options);\r\n}\r\nK.extend(KSWFUpload, {\r\n\tinit : function(options) {\r\n\t\tvar self = this;\r\n\t\toptions.afterError = options.afterError || function(str) {\r\n\t\t\talert(str);\r\n\t\t};\r\n\t\tself.options = options;\r\n\t\tself.progressbars = {};\r\n\t\tself.div = K(options.container).html([\r\n\t\t\t'<div class=\"ke-swfupload\">',\r\n\t\t\t'<div class=\"ke-swfupload-top\">',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-button\">',\r\n\t\t\t'<input type=\"button\" value=\"Browse\" />',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-inline-block ke-swfupload-desc\">' + options.uploadDesc + '</div>',\r\n\t\t\t'<span class=\"ke-button-common ke-button-outer ke-swfupload-startupload\">',\r\n\t\t\t'<input type=\"button\" class=\"ke-button-common ke-button\" value=\"' + options.startButtonValue + '\" />',\r\n\t\t\t'</span>',\r\n\t\t\t'</div>',\r\n\t\t\t'<div class=\"ke-swfupload-body\"></div>',\r\n\t\t\t'</div>'\r\n\t\t].join(''));\r\n\t\tself.bodyDiv = K('.ke-swfupload-body', self.div);\r\n\t\tfunction showError(itemDiv, msg) {\r\n\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\tK('.ke-message', itemDiv).addClass('ke-error').show().html(K.escape(msg));\r\n\t\t}\r\n\t\tvar settings = {\r\n\t\t\tdebug : false,\r\n\t\t\tupload_url : options.uploadUrl,\r\n\t\t\tflash_url : options.flashUrl,\r\n\t\t\tfile_post_name : options.filePostName,\r\n\t\t\tbutton_placeholder : K('.ke-swfupload-button > input', self.div)[0],\r\n\t\t\tbutton_image_url: options.buttonImageUrl,\r\n\t\t\tbutton_width: options.buttonWidth,\r\n\t\t\tbutton_height: options.buttonHeight,\r\n\t\t\tbutton_cursor : SWFUpload.CURSOR.HAND,\r\n\t\t\tfile_types : options.fileTypes,\r\n\t\t\tfile_types_description : options.fileTypesDesc,\r\n\t\t\tfile_upload_limit : options.fileUploadLimit,\r\n\t\t\tfile_size_limit : options.fileSizeLimit,\r\n\t\t\tpost_params : options.postParams,\r\n\t\t\tfile_queued_handler : function(file) {\r\n\t\t\t\tfile.url = self.options.fileIconUrl;\r\n\t\t\t\tself.appendFile(file);\r\n\t\t\t},\r\n\t\t\tfile_queue_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tvar errorName = '';\r\n\t\t\t\tswitch (errorCode) {\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:\r\n\t\t\t\t\t\terrorName = options.queueLimitExceeded;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:\r\n\t\t\t\t\t\terrorName = options.fileExceedsSizeLimit;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:\r\n\t\t\t\t\t\terrorName = options.zeroByteFile;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:\r\n\t\t\t\t\t\terrorName = options.invalidFiletype;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\terrorName = options.unknownError;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tK.DEBUG && alert(errorName);\r\n\t\t\t},\r\n\t\t\tupload_start_handler : function(file) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t\tK('.ke-progressbar', itemDiv).show();\r\n\t\t\t},\r\n\t\t\tupload_progress_handler : function(file, bytesLoaded, bytesTotal) {\r\n\t\t\t\tvar percent = Math.round(bytesLoaded * 100 / bytesTotal);\r\n\t\t\t\tvar progressbar = self.progressbars[file.id];\r\n\t\t\t\tprogressbar.bar.css('width', Math.round(percent * 80 / 100) + 'px');\r\n\t\t\t\tprogressbar.percent.html(percent + '%');\r\n\t\t\t},\r\n\t\t\tupload_error_handler : function(file, errorCode, message) {\r\n\t\t\t\tif (file && file.filestatus == SWFUpload.FILE_STATUS.ERROR) {\r\n\t\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\t\tshowError(itemDiv, self.options.errorMessage);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload_success_handler : function(file, serverData) {\r\n\t\t\t\tvar itemDiv = K('div[data-id=\"' + file.id + '\"]', self.bodyDiv).eq(0);\r\n\t\t\t\tvar data = {};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata = K.json(serverData);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tself.options.afterError.call(this, '<!doctype html><html>' + serverData + '</html>');\r\n\t\t\t\t}\r\n\t\t\t\tif (data.error !== 0) {\r\n\t\t\t\t\tshowError(itemDiv, K.DEBUG ? data.message : self.options.errorMessage);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tfile.url = data.url;\r\n\t\t\t\tK('.ke-img', itemDiv).attr('src', file.url).attr('data-status', file.filestatus).data('data', data);\r\n\t\t\t\tK('.ke-status > div', itemDiv).hide();\r\n\t\t\t}\r\n\t\t};\r\n\t\tself.swfu = new SWFUpload(settings);\r\n\t\tK('.ke-swfupload-startupload input', self.div).click(function() {\r\n\t\t\tself.swfu.startUpload();\r\n\t\t});\r\n\t},\r\n\tgetUrlList : function() {\r\n\t\tvar list = [];\r\n\t\tK('.ke-img', self.bodyDiv).each(function() {\r\n\t\t\tvar img = K(this);\r\n\t\t\tvar status = img.attr('data-status');\r\n\t\t\tif (status == SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\t\tlist.push(img.data('data'));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn list;\r\n\t},\r\n\tremoveFile : function(fileId) {\r\n\t\tvar self = this;\r\n\t\tself.swfu.cancelUpload(fileId);\r\n\t\tvar itemDiv = K('div[data-id=\"' + fileId + '\"]', self.bodyDiv);\r\n\t\tK('.ke-photo', itemDiv).unbind();\r\n\t\tK('.ke-delete', itemDiv).unbind();\r\n\t\titemDiv.remove();\r\n\t},\r\n\tremoveFiles : function() {\r\n\t\tvar self = this;\r\n\t\tK('.ke-item', self.bodyDiv).each(function() {\r\n\t\t\tself.removeFile(K(this).attr('data-id'));\r\n\t\t});\r\n\t},\r\n\tappendFile : function(file) {\r\n\t\tvar self = this;\r\n\t\tvar itemDiv = K('<div class=\"ke-inline-block ke-item\" data-id=\"' + file.id + '\"></div>');\r\n\t\tself.bodyDiv.append(itemDiv);\r\n\t\tvar photoDiv = K('<div class=\"ke-inline-block ke-photo\"></div>')\r\n\t\t\t.mouseover(function(e) {\r\n\t\t\t\tK(this).addClass('ke-on');\r\n\t\t\t})\r\n\t\t\t.mouseout(function(e) {\r\n\t\t\t\tK(this).removeClass('ke-on');\r\n\t\t\t});\r\n\t\titemDiv.append(photoDiv);\r\n\t\tvar img = K('<img src=\"' + file.url + '\" class=\"ke-img\" data-status=\"' + file.filestatus + '\" width=\"80\" height=\"80\" alt=\"' + file.name + '\" />');\r\n\t\tphotoDiv.append(img);\r\n\t\tK('<span class=\"ke-delete\"></span>').appendTo(photoDiv).click(function() {\r\n\t\t\tself.removeFile(file.id);\r\n\t\t});\r\n\t\tvar statusDiv = K('<div class=\"ke-status\"></div>').appendTo(photoDiv);\r\n\t\tK(['<div class=\"ke-progressbar\">',\r\n\t\t\t'<div class=\"ke-progressbar-bar\"><div class=\"ke-progressbar-bar-inner\"></div></div>',\r\n\t\t\t'<div class=\"ke-progressbar-percent\">0%</div></div>'].join('')).hide().appendTo(statusDiv);\r\n\t\tK('<div class=\"ke-message\">' + self.options.pendingMessage + '</div>').appendTo(statusDiv);\r\n\t\titemDiv.append('<div class=\"ke-name\">' + file.name + '</div>');\r\n\t\tself.progressbars[file.id] = {\r\n\t\t\tbar : K('.ke-progressbar-bar-inner', photoDiv),\r\n\t\t\tpercent : K('.ke-progressbar-percent', photoDiv)\r\n\t\t};\r\n\t},\r\n\tremove : function() {\r\n\t\tthis.removeFiles();\r\n\t\tthis.swfu.destroy();\r\n\t\tthis.div.html('');\r\n\t}\r\n});\r\nK.swfupload = function(element, options) {\r\n\treturn new KSWFUpload(element, options);\r\n};\r\n})(KindEditor);\r\nKindEditor.plugin('multiimage', function(K) {\r\n\tvar self = this, name = 'multiimage',\r\n\t\tformatUploadUrl = K.undef(self.formatUploadUrl, true),\r\n\t\tuploadJson = K.undef(self.uploadJson, self.basePath + 'php/upload_json.php'),\r\n\t\timgPath = self.pluginsPath + 'multiimage/images/',\r\n\t\timageSizeLimit = K.undef(self.imageSizeLimit, '1MB'),\r\n\t\timageFileTypes = K.undef(self.imageFileTypes, '*.jpg;*.gif;*.png'),\r\n\t\timageUploadLimit = K.undef(self.imageUploadLimit, 20),\r\n\t\tfilePostName = K.undef(self.filePostName, 'imgFile'),\r\n\t\tlang = self.lang(name + '.');\r\n\tself.plugin.multiImageDialog = function(options) {\r\n\t\tvar clickFn = options.clickFn,\r\n\t\t\tuploadDesc = K.tmpl(lang.uploadDesc, {uploadLimit : imageUploadLimit, sizeLimit : imageSizeLimit});\r\n\t\tvar html = [\r\n\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t'<div class=\"swfupload\">',\r\n\t\t\t'</div>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 650,\r\n\t\t\theight : 510,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tpreviewBtn : {\r\n\t\t\t\tname : lang.insertAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tclickFn.call(self, swfupload.getUrlList());\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : lang.clearAll,\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tswfupload.removeFiles();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbeforeRemove : function() {\r\n\t\t\t\tif (!K.IE || K.V <= 8) {\r\n\t\t\t\t\tswfupload.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}),\r\n\t\tdiv = dialog.div;\r\n\t\tvar swfupload = K.swfupload({\r\n\t\t\tcontainer : K('.swfupload', div),\r\n\t\t\tbuttonImageUrl : imgPath + (self.langType == 'zh-CN' ? 'select-files-zh-CN.png' : 'select-files-en.png'),\r\n\t\t\tbuttonWidth : self.langType == 'zh-CN' ? 72 : 88,\r\n\t\t\tbuttonHeight : 23,\r\n\t\t\tfileIconUrl : imgPath + 'image.png',\r\n\t\t\tuploadDesc : uploadDesc,\r\n\t\t\tstartButtonValue : lang.startUpload,\r\n\t\t\tuploadUrl : K.addParam(uploadJson, 'dir=image'),\r\n\t\t\tflashUrl : imgPath + 'swfupload.swf',\r\n\t\t\tfilePostName : filePostName,\r\n\t\t\tfileTypes : '*.jpg;*.jpeg;*.gif;*.png;*.bmp',\r\n\t\t\tfileTypesDesc : 'Image Files',\r\n\t\t\tfileUploadLimit : imageUploadLimit,\r\n\t\t\tfileSizeLimit : imageSizeLimit,\r\n\t\t\tpostParams :  K.undef(self.extraFileUploadParams, {}),\r\n\t\t\tqueueLimitExceeded : lang.queueLimitExceeded,\r\n\t\t\tfileExceedsSizeLimit : lang.fileExceedsSizeLimit,\r\n\t\t\tzeroByteFile : lang.zeroByteFile,\r\n\t\t\tinvalidFiletype : lang.invalidFiletype,\r\n\t\t\tunknownError : lang.unknownError,\r\n\t\t\tpendingMessage : lang.pending,\r\n\t\t\terrorMessage : lang.uploadError,\r\n\t\t\tafterError : function(html) {\r\n\t\t\t\tself.errorDialog(html);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dialog;\r\n\t};\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.plugin.multiImageDialog({\r\n\t\t\tclickFn : function (urlList) {\r\n\t\t\t\tif (urlList.length === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tK.each(urlList, function(i, data) {\r\n\t\t\t\t\tif (self.afterUpload) {\r\n\t\t\t\t\t\tself.afterUpload.call(self, data.url, data, 'multiimage');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.exec('insertimage', data.url, data.title, data.width, data.height, data.border, data.align);\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n/* ******************* */\r\n/* Constructor & Init  */\r\n/* ******************* */\r\n(function() {\r\nwindow.SWFUpload = function (settings) {\r\n\tthis.initSWFUpload(settings);\r\n};\r\nSWFUpload.prototype.initSWFUpload = function (settings) {\r\n\ttry {\r\n\t\tthis.customSettings = {};\r\n\t\tthis.settings = settings;\r\n\t\tthis.eventQueue = [];\r\n\t\tthis.movieName = \"KindEditor_SWFUpload_\" + SWFUpload.movieCount++;\r\n\t\tthis.movieElement = null;\r\n\t\tSWFUpload.instances[this.movieName] = this;\r\n\t\tthis.initSettings();\r\n\t\tthis.loadFlash();\r\n\t\tthis.displayDebugInfo();\r\n\t} catch (ex) {\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthrow ex;\r\n\t}\r\n};\r\n/* *************** */\r\n/* Static Members  */\r\n/* *************** */\r\nSWFUpload.instances = {};\r\nSWFUpload.movieCount = 0;\r\nSWFUpload.version = \"2.2.0 2009-03-25\";\r\nSWFUpload.QUEUE_ERROR = {\r\n\tQUEUE_LIMIT_EXCEEDED\t  \t\t: -100,\r\n\tFILE_EXCEEDS_SIZE_LIMIT  \t\t: -110,\r\n\tZERO_BYTE_FILE\t\t\t  \t\t: -120,\r\n\tINVALID_FILETYPE\t\t  \t\t: -130\r\n};\r\nSWFUpload.UPLOAD_ERROR = {\r\n\tHTTP_ERROR\t\t\t\t  \t\t: -200,\r\n\tMISSING_UPLOAD_URL\t      \t\t: -210,\r\n\tIO_ERROR\t\t\t\t  \t\t: -220,\r\n\tSECURITY_ERROR\t\t\t  \t\t: -230,\r\n\tUPLOAD_LIMIT_EXCEEDED\t  \t\t: -240,\r\n\tUPLOAD_FAILED\t\t\t  \t\t: -250,\r\n\tSPECIFIED_FILE_ID_NOT_FOUND\t\t: -260,\r\n\tFILE_VALIDATION_FAILED\t  \t\t: -270,\r\n\tFILE_CANCELLED\t\t\t  \t\t: -280,\r\n\tUPLOAD_STOPPED\t\t\t\t\t: -290\r\n};\r\nSWFUpload.FILE_STATUS = {\r\n\tQUEUED\t\t : -1,\r\n\tIN_PROGRESS\t : -2,\r\n\tERROR\t\t : -3,\r\n\tCOMPLETE\t : -4,\r\n\tCANCELLED\t : -5\r\n};\r\nSWFUpload.BUTTON_ACTION = {\r\n\tSELECT_FILE  : -100,\r\n\tSELECT_FILES : -110,\r\n\tSTART_UPLOAD : -120\r\n};\r\nSWFUpload.CURSOR = {\r\n\tARROW : -1,\r\n\tHAND : -2\r\n};\r\nSWFUpload.WINDOW_MODE = {\r\n\tWINDOW : \"window\",\r\n\tTRANSPARENT : \"transparent\",\r\n\tOPAQUE : \"opaque\"\r\n};\r\n\r\r\r\nSWFUpload.completeURL = function(url) {\r\n\tif (typeof(url) !== \"string\" || url.match(/^https?:\\/\\//i) || url.match(/^\\//)) {\r\n\t\treturn url;\r\n\t}\r\n\tvar currentURL = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? \":\" + window.location.port : \"\");\r\n\tvar indexSlash = window.location.pathname.lastIndexOf(\"/\");\r\n\tif (indexSlash <= 0) {\r\n\t\tpath = \"/\";\r\n\t} else {\r\n\t\tpath = window.location.pathname.substr(0, indexSlash) + \"/\";\r\n\t}\r\n\treturn /*currentURL +*/ path + url;\r\n};\r\n/* ******************** */\r\n/* Instance Members  */\r\n/* ******************** */\r\n\r\r\r\nSWFUpload.prototype.initSettings = function () {\r\n\tthis.ensureDefault = function (settingName, defaultValue) {\r\n\t\tthis.settings[settingName] = (this.settings[settingName] == undefined) ? defaultValue : this.settings[settingName];\r\n\t};\r\n\tthis.ensureDefault(\"upload_url\", \"\");\r\n\tthis.ensureDefault(\"preserve_relative_urls\", false);\r\n\tthis.ensureDefault(\"file_post_name\", \"Filedata\");\r\n\tthis.ensureDefault(\"post_params\", {});\r\n\tthis.ensureDefault(\"use_query_string\", false);\r\n\tthis.ensureDefault(\"requeue_on_error\", false);\r\n\tthis.ensureDefault(\"http_success\", []);\r\n\tthis.ensureDefault(\"assume_success_timeout\", 0);\r\n\tthis.ensureDefault(\"file_types\", \"*.*\");\r\n\tthis.ensureDefault(\"file_types_description\", \"All Files\");\r\n\tthis.ensureDefault(\"file_size_limit\", 0);\r\n\tthis.ensureDefault(\"file_upload_limit\", 0);\r\n\tthis.ensureDefault(\"file_queue_limit\", 0);\r\n\tthis.ensureDefault(\"flash_url\", \"swfupload.swf\");\r\n\tthis.ensureDefault(\"prevent_swf_caching\", true);\r\n\tthis.ensureDefault(\"button_image_url\", \"\");\r\n\tthis.ensureDefault(\"button_width\", 1);\r\n\tthis.ensureDefault(\"button_height\", 1);\r\n\tthis.ensureDefault(\"button_text\", \"\");\r\n\tthis.ensureDefault(\"button_text_style\", \"color: #000000; font-size: 16pt;\");\r\n\tthis.ensureDefault(\"button_text_top_padding\", 0);\r\n\tthis.ensureDefault(\"button_text_left_padding\", 0);\r\n\tthis.ensureDefault(\"button_action\", SWFUpload.BUTTON_ACTION.SELECT_FILES);\r\n\tthis.ensureDefault(\"button_disabled\", false);\r\n\tthis.ensureDefault(\"button_placeholder_id\", \"\");\r\n\tthis.ensureDefault(\"button_placeholder\", null);\r\n\tthis.ensureDefault(\"button_cursor\", SWFUpload.CURSOR.ARROW);\r\n\tthis.ensureDefault(\"button_window_mode\", SWFUpload.WINDOW_MODE.WINDOW);\r\n\tthis.ensureDefault(\"debug\", false);\r\n\tthis.settings.debug_enabled = this.settings.debug;\r\n\tthis.settings.return_upload_start_handler = this.returnUploadStart;\r\n\tthis.ensureDefault(\"swfupload_loaded_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_start_handler\", null);\r\n\tthis.ensureDefault(\"file_queued_handler\", null);\r\n\tthis.ensureDefault(\"file_queue_error_handler\", null);\r\n\tthis.ensureDefault(\"file_dialog_complete_handler\", null);\r\n\tthis.ensureDefault(\"upload_start_handler\", null);\r\n\tthis.ensureDefault(\"upload_progress_handler\", null);\r\n\tthis.ensureDefault(\"upload_error_handler\", null);\r\n\tthis.ensureDefault(\"upload_success_handler\", null);\r\n\tthis.ensureDefault(\"upload_complete_handler\", null);\r\n\tthis.ensureDefault(\"debug_handler\", this.debugMessage);\r\n\tthis.ensureDefault(\"custom_settings\", {});\r\n\tthis.customSettings = this.settings.custom_settings;\r\n\tif (!!this.settings.prevent_swf_caching) {\r\n\t\tthis.settings.flash_url = this.settings.flash_url + (this.settings.flash_url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + \"preventswfcaching=\" + new Date().getTime();\r\n\t}\r\n\tif (!this.settings.preserve_relative_urls) {\r\n\t\tthis.settings.upload_url = SWFUpload.completeURL(this.settings.upload_url);\r\n\t\tthis.settings.button_image_url = SWFUpload.completeURL(this.settings.button_image_url);\r\n\t}\r\n\tdelete this.ensureDefault;\r\n};\r\n\r\r\nSWFUpload.prototype.loadFlash = function () {\r\n\tvar targetElement, tempParent;\r\n\tif (document.getElementById(this.movieName) !== null) {\r\n\t\tthrow \"ID \" + this.movieName + \" is already in use. The Flash Object could not be added\";\r\n\t}\r\n\ttargetElement = document.getElementById(this.settings.button_placeholder_id) || this.settings.button_placeholder;\r\n\tif (targetElement == undefined) {\r\n\t\tthrow \"Could not find the placeholder element: \" + this.settings.button_placeholder_id;\r\n\t}\r\n\ttempParent = document.createElement(\"div\");\r\n\ttempParent.innerHTML = this.getFlashHTML();\r\n\ttargetElement.parentNode.replaceChild(tempParent.firstChild, targetElement);\r\n\tif (window[this.movieName] == undefined) {\r\n\t\twindow[this.movieName] = this.getMovieElement();\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getFlashHTML = function () {\r\n\tvar classid = '';\r\n\tif (KindEditor.IE && KindEditor.V > 8) {\r\n\t\tclassid = ' classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"';\r\n\t}\r\n\treturn ['<object id=\"', this.movieName, '\"' + classid + ' type=\"application/x-shockwave-flash\" data=\"', this.settings.flash_url, '\" width=\"', this.settings.button_width, '\" height=\"', this.settings.button_height, '\" class=\"swfupload\">',\r\n\t\t\t\t'<param name=\"wmode\" value=\"', this.settings.button_window_mode, '\" />',\r\n\t\t\t\t'<param name=\"movie\" value=\"', this.settings.flash_url, '\" />',\r\n\t\t\t\t'<param name=\"quality\" value=\"high\" />',\r\n\t\t\t\t'<param name=\"menu\" value=\"false\" />',\r\n\t\t\t\t'<param name=\"allowScriptAccess\" value=\"always\" />',\r\n\t\t\t\t'<param name=\"flashvars\" value=\"' + this.getFlashVars() + '\" />',\r\n\t\t\t\t'</object>'].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFlashVars = function () {\r\n\tvar paramString = this.buildParamString();\r\n\tvar httpSuccessString = this.settings.http_success.join(\",\");\r\n\treturn [\"movieName=\", encodeURIComponent(this.movieName),\r\n\t\t\t\"&amp;uploadURL=\", encodeURIComponent(this.settings.upload_url),\r\n\t\t\t\"&amp;useQueryString=\", encodeURIComponent(this.settings.use_query_string),\r\n\t\t\t\"&amp;requeueOnError=\", encodeURIComponent(this.settings.requeue_on_error),\r\n\t\t\t\"&amp;httpSuccess=\", encodeURIComponent(httpSuccessString),\r\n\t\t\t\"&amp;assumeSuccessTimeout=\", encodeURIComponent(this.settings.assume_success_timeout),\r\n\t\t\t\"&amp;params=\", encodeURIComponent(paramString),\r\n\t\t\t\"&amp;filePostName=\", encodeURIComponent(this.settings.file_post_name),\r\n\t\t\t\"&amp;fileTypes=\", encodeURIComponent(this.settings.file_types),\r\n\t\t\t\"&amp;fileTypesDescription=\", encodeURIComponent(this.settings.file_types_description),\r\n\t\t\t\"&amp;fileSizeLimit=\", encodeURIComponent(this.settings.file_size_limit),\r\n\t\t\t\"&amp;fileUploadLimit=\", encodeURIComponent(this.settings.file_upload_limit),\r\n\t\t\t\"&amp;fileQueueLimit=\", encodeURIComponent(this.settings.file_queue_limit),\r\n\t\t\t\"&amp;debugEnabled=\", encodeURIComponent(this.settings.debug_enabled),\r\n\t\t\t\"&amp;buttonImageURL=\", encodeURIComponent(this.settings.button_image_url),\r\n\t\t\t\"&amp;buttonWidth=\", encodeURIComponent(this.settings.button_width),\r\n\t\t\t\"&amp;buttonHeight=\", encodeURIComponent(this.settings.button_height),\r\n\t\t\t\"&amp;buttonText=\", encodeURIComponent(this.settings.button_text),\r\n\t\t\t\"&amp;buttonTextTopPadding=\", encodeURIComponent(this.settings.button_text_top_padding),\r\n\t\t\t\"&amp;buttonTextLeftPadding=\", encodeURIComponent(this.settings.button_text_left_padding),\r\n\t\t\t\"&amp;buttonTextStyle=\", encodeURIComponent(this.settings.button_text_style),\r\n\t\t\t\"&amp;buttonAction=\", encodeURIComponent(this.settings.button_action),\r\n\t\t\t\"&amp;buttonDisabled=\", encodeURIComponent(this.settings.button_disabled),\r\n\t\t\t\"&amp;buttonCursor=\", encodeURIComponent(this.settings.button_cursor)\r\n\t\t].join(\"\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.getMovieElement = function () {\r\n\tif (this.movieElement == undefined) {\r\n\t\tthis.movieElement = document.getElementById(this.movieName);\r\n\t}\r\n\tif (this.movieElement === null) {\r\n\t\tthrow \"Could not find Flash element\";\r\n\t}\r\n\treturn this.movieElement;\r\n};\r\n\r\r\r\nSWFUpload.prototype.buildParamString = function () {\r\n\tvar postParams = this.settings.post_params;\r\n\tvar paramStringPairs = [];\r\n\tif (typeof(postParams) === \"object\") {\r\n\t\tfor (var name in postParams) {\r\n\t\t\tif (postParams.hasOwnProperty(name)) {\r\n\t\t\t\tparamStringPairs.push(encodeURIComponent(name.toString()) + \"=\" + encodeURIComponent(postParams[name].toString()));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn paramStringPairs.join(\"&amp;\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.destroy = function () {\r\n\ttry {\r\n\t\tthis.cancelUpload(null, false);\r\n\t\tvar movieElement = null;\r\n\t\tmovieElement = this.getMovieElement();\r\n\t\tif (movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tfor (var i in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[i]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[i] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex1) {}\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tmovieElement.parentNode.removeChild(movieElement);\r\n\t\t\t} catch (ex) {}\r\n\t\t}\r\n\t\twindow[this.movieName] = null;\r\n\t\tSWFUpload.instances[this.movieName] = null;\r\n\t\tdelete SWFUpload.instances[this.movieName];\r\n\t\tthis.movieElement = null;\r\n\t\tthis.settings = null;\r\n\t\tthis.customSettings = null;\r\n\t\tthis.eventQueue = null;\r\n\t\tthis.movieName = null;\r\n\t\treturn true;\r\n\t} catch (ex2) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.displayDebugInfo = function () {\r\n\tthis.debug(\r\n\t\t[\r\n\t\t\t\"---SWFUpload Instance Info---\\n\",\r\n\t\t\t\"Version: \", SWFUpload.version, \"\\n\",\r\n\t\t\t\"Movie Name: \", this.movieName, \"\\n\",\r\n\t\t\t\"Settings:\\n\",\r\n\t\t\t\"\\t\", \"upload_url:               \", this.settings.upload_url, \"\\n\",\r\n\t\t\t\"\\t\", \"flash_url:                \", this.settings.flash_url, \"\\n\",\r\n\t\t\t\"\\t\", \"use_query_string:         \", this.settings.use_query_string.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"requeue_on_error:         \", this.settings.requeue_on_error.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"http_success:             \", this.settings.http_success.join(\", \"), \"\\n\",\r\n\t\t\t\"\\t\", \"assume_success_timeout:   \", this.settings.assume_success_timeout, \"\\n\",\r\n\t\t\t\"\\t\", \"file_post_name:           \", this.settings.file_post_name, \"\\n\",\r\n\t\t\t\"\\t\", \"post_params:              \", this.settings.post_params.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_types:               \", this.settings.file_types, \"\\n\",\r\n\t\t\t\"\\t\", \"file_types_description:   \", this.settings.file_types_description, \"\\n\",\r\n\t\t\t\"\\t\", \"file_size_limit:          \", this.settings.file_size_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_upload_limit:        \", this.settings.file_upload_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_limit:         \", this.settings.file_queue_limit, \"\\n\",\r\n\t\t\t\"\\t\", \"debug:                    \", this.settings.debug.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"prevent_swf_caching:      \", this.settings.prevent_swf_caching.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder_id:    \", this.settings.button_placeholder_id.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_placeholder:       \", (this.settings.button_placeholder ? \"Set\" : \"Not Set\"), \"\\n\",\r\n\t\t\t\"\\t\", \"button_image_url:         \", this.settings.button_image_url.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_width:             \", this.settings.button_width.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_height:            \", this.settings.button_height.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text:              \", this.settings.button_text.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_style:        \", this.settings.button_text_style.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_top_padding:  \", this.settings.button_text_top_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_text_left_padding: \", this.settings.button_text_left_padding.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_action:            \", this.settings.button_action.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"button_disabled:          \", this.settings.button_disabled.toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"custom_settings:          \", this.settings.custom_settings.toString(), \"\\n\",\r\n\t\t\t\"Event Handlers:\\n\",\r\n\t\t\t\"\\t\", \"swfupload_loaded_handler assigned:  \", (typeof this.settings.swfupload_loaded_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_dialog_start_handler assigned: \", (typeof this.settings.file_dialog_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queued_handler assigned:       \", (typeof this.settings.file_queued_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"file_queue_error_handler assigned:  \", (typeof this.settings.file_queue_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_start_handler assigned:      \", (typeof this.settings.upload_start_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_progress_handler assigned:   \", (typeof this.settings.upload_progress_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_error_handler assigned:      \", (typeof this.settings.upload_error_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_success_handler assigned:    \", (typeof this.settings.upload_success_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"upload_complete_handler assigned:   \", (typeof this.settings.upload_complete_handler === \"function\").toString(), \"\\n\",\r\n\t\t\t\"\\t\", \"debug_handler assigned:             \", (typeof this.settings.debug_handler === \"function\").toString(), \"\\n\"\r\n\t\t].join(\"\")\r\n\t);\r\n};\r\n/* Note: addSetting and getSetting are no longer used by SWFUpload but are included\r\n\tthe maintain v2 API compatibility\r\n*/\r\r\nSWFUpload.prototype.addSetting = function (name, value, default_value) {\r\n    if (value == undefined) {\r\n        return (this.settings[name] = default_value);\r\n    } else {\r\n        return (this.settings[name] = value);\r\n\t}\r\n};\r\n\r\r\nSWFUpload.prototype.getSetting = function (name) {\r\n    if (this.settings[name] != undefined) {\r\n        return this.settings[name];\r\n\t}\r\n    return \"\";\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.callFlash = function (functionName, argumentArray) {\r\n\targumentArray = argumentArray || [];\r\n\tvar movieElement = this.getMovieElement();\r\n\tvar returnValue, returnString;\r\n\ttry {\r\n\t\treturnString = movieElement.CallFunction('<invoke name=\"' + functionName + '\" returntype=\"javascript\">' + __flash__argumentsToXML(argumentArray, 0) + '</invoke>');\r\n\t\treturnValue = eval(returnString);\r\n\t} catch (ex) {\r\n\t\tthrow \"Call to \" + functionName + \" failed\";\r\n\t}\r\n\tif (returnValue != undefined && typeof returnValue.post === \"object\") {\r\n\t\treturnValue = this.unescapeFilePostParams(returnValue);\r\n\t}\r\n\treturn returnValue;\r\n};\r\n/* *****************************\r\n\t-- Flash control methods --\r\n\tYour UI should use these\r\n\tto operate SWFUpload\r\n   ***************************** */\r\n\r\r\r\r\nSWFUpload.prototype.selectFile = function () {\r\n\tthis.callFlash(\"SelectFile\");\r\n};\r\n\r\r\r\r\r\r\r\nSWFUpload.prototype.selectFiles = function () {\r\n\tthis.callFlash(\"SelectFiles\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.startUpload = function (fileID) {\r\n\tthis.callFlash(\"StartUpload\", [fileID]);\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.cancelUpload = function (fileID, triggerErrorEvent) {\r\n\tif (triggerErrorEvent !== false) {\r\n\t\ttriggerErrorEvent = true;\r\n\t}\r\n\tthis.callFlash(\"CancelUpload\", [fileID, triggerErrorEvent]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.stopUpload = function () {\r\n\tthis.callFlash(\"StopUpload\");\r\n};\r\n/* ************************\r\n * Settings methods\r\n *   These methods change the SWFUpload settings.\r\n *   SWFUpload settings should not be changed directly on the settings object\r\n *   since many of the settings need to be passed to Flash in order to take\r\n *   effect.\r\n * *********************** */\r\n\r\r\nSWFUpload.prototype.getStats = function () {\r\n\treturn this.callFlash(\"GetStats\");\r\n};\r\n\r\r\r\r\r\nSWFUpload.prototype.setStats = function (statsObject) {\r\n\tthis.callFlash(\"SetStats\", [statsObject]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.getFile = function (fileID) {\r\n\tif (typeof(fileID) === \"number\") {\r\n\t\treturn this.callFlash(\"GetFileByIndex\", [fileID]);\r\n\t} else {\r\n\t\treturn this.callFlash(\"GetFile\", [fileID]);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.addFileParam = function (fileID, name, value) {\r\n\treturn this.callFlash(\"AddFileParam\", [fileID, name, value]);\r\n};\r\n\r\r\r\nSWFUpload.prototype.removeFileParam = function (fileID, name) {\r\n\tthis.callFlash(\"RemoveFileParam\", [fileID, name]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUploadURL = function (url) {\r\n\tthis.settings.upload_url = url.toString();\r\n\tthis.callFlash(\"SetUploadURL\", [url]);\r\n};\r\n\r\r\nSWFUpload.prototype.setPostParams = function (paramsObject) {\r\n\tthis.settings.post_params = paramsObject;\r\n\tthis.callFlash(\"SetPostParams\", [paramsObject]);\r\n};\r\n\r\r\nSWFUpload.prototype.addPostParam = function (name, value) {\r\n\tthis.settings.post_params[name] = value;\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.removePostParam = function (name) {\r\n\tdelete this.settings.post_params[name];\r\n\tthis.callFlash(\"SetPostParams\", [this.settings.post_params]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileTypes = function (types, description) {\r\n\tthis.settings.file_types = types;\r\n\tthis.settings.file_types_description = description;\r\n\tthis.callFlash(\"SetFileTypes\", [types, description]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileSizeLimit = function (fileSizeLimit) {\r\n\tthis.settings.file_size_limit = fileSizeLimit;\r\n\tthis.callFlash(\"SetFileSizeLimit\", [fileSizeLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileUploadLimit = function (fileUploadLimit) {\r\n\tthis.settings.file_upload_limit = fileUploadLimit;\r\n\tthis.callFlash(\"SetFileUploadLimit\", [fileUploadLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFileQueueLimit = function (fileQueueLimit) {\r\n\tthis.settings.file_queue_limit = fileQueueLimit;\r\n\tthis.callFlash(\"SetFileQueueLimit\", [fileQueueLimit]);\r\n};\r\n\r\r\nSWFUpload.prototype.setFilePostName = function (filePostName) {\r\n\tthis.settings.file_post_name = filePostName;\r\n\tthis.callFlash(\"SetFilePostName\", [filePostName]);\r\n};\r\n\r\r\nSWFUpload.prototype.setUseQueryString = function (useQueryString) {\r\n\tthis.settings.use_query_string = useQueryString;\r\n\tthis.callFlash(\"SetUseQueryString\", [useQueryString]);\r\n};\r\n\r\r\nSWFUpload.prototype.setRequeueOnError = function (requeueOnError) {\r\n\tthis.settings.requeue_on_error = requeueOnError;\r\n\tthis.callFlash(\"SetRequeueOnError\", [requeueOnError]);\r\n};\r\n\r\r\nSWFUpload.prototype.setHTTPSuccess = function (http_status_codes) {\r\n\tif (typeof http_status_codes === \"string\") {\r\n\t\thttp_status_codes = http_status_codes.replace(\" \", \"\").split(\",\");\r\n\t}\r\n\tthis.settings.http_success = http_status_codes;\r\n\tthis.callFlash(\"SetHTTPSuccess\", [http_status_codes]);\r\n};\r\n\r\r\nSWFUpload.prototype.setAssumeSuccessTimeout = function (timeout_seconds) {\r\n\tthis.settings.assume_success_timeout = timeout_seconds;\r\n\tthis.callFlash(\"SetAssumeSuccessTimeout\", [timeout_seconds]);\r\n};\r\n\r\r\nSWFUpload.prototype.setDebugEnabled = function (debugEnabled) {\r\n\tthis.settings.debug_enabled = debugEnabled;\r\n\tthis.callFlash(\"SetDebugEnabled\", [debugEnabled]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonImageURL = function (buttonImageURL) {\r\n\tif (buttonImageURL == undefined) {\r\n\t\tbuttonImageURL = \"\";\r\n\t}\r\n\tthis.settings.button_image_url = buttonImageURL;\r\n\tthis.callFlash(\"SetButtonImageURL\", [buttonImageURL]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonDimensions = function (width, height) {\r\n\tthis.settings.button_width = width;\r\n\tthis.settings.button_height = height;\r\n\tvar movie = this.getMovieElement();\r\n\tif (movie != undefined) {\r\n\t\tmovie.style.width = width + \"px\";\r\n\t\tmovie.style.height = height + \"px\";\r\n\t}\r\n\tthis.callFlash(\"SetButtonDimensions\", [width, height]);\r\n};\r\r\nSWFUpload.prototype.setButtonText = function (html) {\r\n\tthis.settings.button_text = html;\r\n\tthis.callFlash(\"SetButtonText\", [html]);\r\n};\r\r\nSWFUpload.prototype.setButtonTextPadding = function (left, top) {\r\n\tthis.settings.button_text_top_padding = top;\r\n\tthis.settings.button_text_left_padding = left;\r\n\tthis.callFlash(\"SetButtonTextPadding\", [left, top]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonTextStyle = function (css) {\r\n\tthis.settings.button_text_style = css;\r\n\tthis.callFlash(\"SetButtonTextStyle\", [css]);\r\n};\r\r\nSWFUpload.prototype.setButtonDisabled = function (isDisabled) {\r\n\tthis.settings.button_disabled = isDisabled;\r\n\tthis.callFlash(\"SetButtonDisabled\", [isDisabled]);\r\n};\r\r\nSWFUpload.prototype.setButtonAction = function (buttonAction) {\r\n\tthis.settings.button_action = buttonAction;\r\n\tthis.callFlash(\"SetButtonAction\", [buttonAction]);\r\n};\r\n\r\r\nSWFUpload.prototype.setButtonCursor = function (cursor) {\r\n\tthis.settings.button_cursor = cursor;\r\n\tthis.callFlash(\"SetButtonCursor\", [cursor]);\r\n};\r\n/* *******************************\r\n\tFlash Event Interfaces\r\n\tThese functions are used by Flash to trigger the various\r\n\tevents.\r\n\tAll these functions a Private.\r\n\tBecause the ExternalInterface library is buggy the event calls\r\n\tare added to a queue and the queue then executed by a setTimeout.\r\n\tThis ensures that events are executed in a determinate order and that\r\n\tthe ExternalInterface bugs are avoided.\r\n******************************* */\r\nSWFUpload.prototype.queueEvent = function (handlerName, argumentArray) {\r\n\tif (argumentArray == undefined) {\r\n\t\targumentArray = [];\r\n\t} else if (!(argumentArray instanceof Array)) {\r\n\t\targumentArray = [argumentArray];\r\n\t}\r\n\tvar self = this;\r\n\tif (typeof this.settings[handlerName] === \"function\") {\r\n\t\tthis.eventQueue.push(function () {\r\n\t\t\tthis.settings[handlerName].apply(this, argumentArray);\r\n\t\t});\r\n\t\tsetTimeout(function () {\r\n\t\t\tself.executeNextEvent();\r\n\t\t}, 0);\r\n\t} else if (this.settings[handlerName] !== null) {\r\n\t\tthrow \"Event handler \" + handlerName + \" is unknown or is not a function\";\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.executeNextEvent = function () {\r\n\tvar  f = this.eventQueue ? this.eventQueue.shift() : null;\r\n\tif (typeof(f) === \"function\") {\r\n\t\tf.apply(this);\r\n\t}\r\n};\r\n\r\r\r\r\nSWFUpload.prototype.unescapeFilePostParams = function (file) {\r\n\tvar reg = /[$]([0-9a-f]{4})/i;\r\n\tvar unescapedPost = {};\r\n\tvar uk;\r\n\tif (file != undefined) {\r\n\t\tfor (var k in file.post) {\r\n\t\t\tif (file.post.hasOwnProperty(k)) {\r\n\t\t\t\tuk = k;\r\n\t\t\t\tvar match;\r\n\t\t\t\twhile ((match = reg.exec(uk)) !== null) {\r\n\t\t\t\t\tuk = uk.replace(match[0], String.fromCharCode(parseInt(\"0x\" + match[1], 16)));\r\n\t\t\t\t}\r\n\t\t\t\tunescapedPost[uk] = file.post[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfile.post = unescapedPost;\r\n\t}\r\n\treturn file;\r\n};\r\n\r\r\nSWFUpload.prototype.testExternalInterface = function () {\r\n\ttry {\r\n\t\treturn this.callFlash(\"TestExternalInterface\");\r\n\t} catch (ex) {\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\r\r\nSWFUpload.prototype.flashReady = function () {\r\n\tvar movieElement = this.getMovieElement();\r\n\tif (!movieElement) {\r\n\t\tthis.debug(\"Flash called back ready but the flash movie can't be found.\");\r\n\t\treturn;\r\n\t}\r\n\tthis.cleanUp(movieElement);\r\n\tthis.queueEvent(\"swfupload_loaded_handler\");\r\n};\r\n\r\r\r\nSWFUpload.prototype.cleanUp = function (movieElement) {\r\n\ttry {\r\n\t\tif (this.movieElement && typeof(movieElement.CallFunction) === \"unknown\") {\r\n\t\t\tthis.debug(\"Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)\");\r\n\t\t\tfor (var key in movieElement) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (typeof(movieElement[key]) === \"function\") {\r\n\t\t\t\t\t\tmovieElement[key] = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (ex) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (ex1) {\r\n\t}\r\n\twindow[\"__flash__removeCallback\"] = function (instance, name) {\r\n\t\ttry {\r\n\t\t\tif (instance) {\r\n\t\t\t\tinstance[name] = null;\r\n\t\t\t}\r\n\t\t} catch (flashEx) {\r\n\t\t}\r\n\t};\r\n};\r\n/* This is a chance to do something before the browse window opens */\r\nSWFUpload.prototype.fileDialogStart = function () {\r\n\tthis.queueEvent(\"file_dialog_start_handler\");\r\n};\r\n/* Called when a file is successfully added to the queue. */\r\nSWFUpload.prototype.fileQueued = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queued_handler\", file);\r\n};\r\n/* Handle errors that occur when an attempt to queue a file fails. */\r\nSWFUpload.prototype.fileQueueError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"file_queue_error_handler\", [file, errorCode, message]);\r\n};\r\n/* Called after the file dialog has closed and the selected files have been queued.\r\n\tYou could call startUpload here if you want the queued files to begin uploading immediately. */\r\nSWFUpload.prototype.fileDialogComplete = function (numFilesSelected, numFilesQueued, numFilesInQueue) {\r\n\tthis.queueEvent(\"file_dialog_complete_handler\", [numFilesSelected, numFilesQueued, numFilesInQueue]);\r\n};\r\nSWFUpload.prototype.uploadStart = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"return_upload_start_handler\", file);\r\n};\r\nSWFUpload.prototype.returnUploadStart = function (file) {\r\n\tvar returnValue;\r\n\tif (typeof this.settings.upload_start_handler === \"function\") {\r\n\t\tfile = this.unescapeFilePostParams(file);\r\n\t\treturnValue = this.settings.upload_start_handler.call(this, file);\r\n\t} else if (this.settings.upload_start_handler != undefined) {\r\n\t\tthrow \"upload_start_handler must be a function\";\r\n\t}\r\n\tif (returnValue === undefined) {\r\n\t\treturnValue = true;\r\n\t}\r\n\treturnValue = !!returnValue;\r\n\tthis.callFlash(\"ReturnUploadStart\", [returnValue]);\r\n};\r\nSWFUpload.prototype.uploadProgress = function (file, bytesComplete, bytesTotal) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_progress_handler\", [file, bytesComplete, bytesTotal]);\r\n};\r\nSWFUpload.prototype.uploadError = function (file, errorCode, message) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_error_handler\", [file, errorCode, message]);\r\n};\r\nSWFUpload.prototype.uploadSuccess = function (file, serverData, responseReceived) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_success_handler\", [file, serverData, responseReceived]);\r\n};\r\nSWFUpload.prototype.uploadComplete = function (file) {\r\n\tfile = this.unescapeFilePostParams(file);\r\n\tthis.queueEvent(\"upload_complete_handler\", file);\r\n};\r\n/* Called by SWFUpload JavaScript and Flash functions when debug is enabled. By default it writes messages to the\r\n   internal debug console.  You can override this event and have messages written where you want. */\r\nSWFUpload.prototype.debug = function (message) {\r\n\tthis.queueEvent(\"debug_handler\", message);\r\n};\r\n/* **********************************\r\n\tDebug Console\r\n\tThe debug console is a self contained, in page location\r\n\tfor debug message to be sent.  The Debug Console adds\r\n\titself to the body if necessary.\r\n\tThe console is automatically scrolled as messages appear.\r\n\tIf you are using your own debug handler or when you deploy to production and\r\n\thave debug disabled you can remove these functions to reduce the file size\r\n\tand complexity.\r\n********************************** */\r\n\r\r\r\r\nSWFUpload.prototype.debugMessage = function (message) {\r\n\tif (this.settings.debug) {\r\n\t\tvar exceptionMessage, exceptionValues = [];\r\n\t\tif (typeof message === \"object\" && typeof message.name === \"string\" && typeof message.message === \"string\") {\r\n\t\t\tfor (var key in message) {\r\n\t\t\t\tif (message.hasOwnProperty(key)) {\r\n\t\t\t\t\texceptionValues.push(key + \": \" + message[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\texceptionMessage = exceptionValues.join(\"\\n\") || \"\";\r\n\t\t\texceptionValues = exceptionMessage.split(\"\\n\");\r\n\t\t\texceptionMessage = \"EXCEPTION: \" + exceptionValues.join(\"\\nEXCEPTION: \");\r\n\t\t\tSWFUpload.Console.writeLine(exceptionMessage);\r\n\t\t} else {\r\n\t\t\tSWFUpload.Console.writeLine(message);\r\n\t\t}\r\n\t}\r\n};\r\nSWFUpload.Console = {};\r\nSWFUpload.Console.writeLine = function (message) {\r\n\tvar console, documentForm;\r\n\ttry {\r\n\t\tconsole = document.getElementById(\"SWFUpload_Console\");\r\n\t\tif (!console) {\r\n\t\t\tdocumentForm = document.createElement(\"form\");\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(documentForm);\r\n\t\t\tconsole = document.createElement(\"textarea\");\r\n\t\t\tconsole.id = \"SWFUpload_Console\";\r\n\t\t\tconsole.style.fontFamily = \"monospace\";\r\n\t\t\tconsole.setAttribute(\"wrap\", \"off\");\r\n\t\t\tconsole.wrap = \"off\";\r\n\t\t\tconsole.style.overflow = \"auto\";\r\n\t\t\tconsole.style.width = \"700px\";\r\n\t\t\tconsole.style.height = \"350px\";\r\n\t\t\tconsole.style.margin = \"5px\";\r\n\t\t\tdocumentForm.appendChild(console);\r\n\t\t}\r\n\t\tconsole.value += message + \"\\n\";\r\n\t\tconsole.scrollTop = console.scrollHeight - console.clientHeight;\r\n\t} catch (ex) {\r\n\t\talert(\"Exception: \" + ex.name + \" Message: \" + ex.message);\r\n\t}\r\n};\r\n})();\r\n(function() {\r\n/*\r\n\tQueue Plug-in\r\n\tFeatures:\r\n\t\t*Adds a cancelQueue() method for cancelling the entire queue.\r\n\t\t*All queued files are uploaded when startUpload() is called.\r\n\t\t*If false is returned from uploadComplete then the queue upload is stopped.\r\n\t\t If false is not returned (strict comparison) then the queue upload is continued.\r\n\t\t*Adds a QueueComplete event that is fired when all the queued files have finished uploading.\r\n\t\t Set the event handler with the queue_complete_handler setting.\r\n\t*/\r\nif (typeof(SWFUpload) === \"function\") {\r\n\tSWFUpload.queue = {};\r\n\tSWFUpload.prototype.initSettings = (function (oldInitSettings) {\r\n\t\treturn function () {\r\n\t\t\tif (typeof(oldInitSettings) === \"function\") {\r\n\t\t\t\toldInitSettings.call(this);\r\n\t\t\t}\r\n\t\t\tthis.queueSettings = {};\r\n\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\tthis.queueSettings.user_upload_complete_handler = this.settings.upload_complete_handler;\r\n\t\t\tthis.queueSettings.user_upload_start_handler = this.settings.upload_start_handler;\r\n\t\t\tthis.settings.upload_complete_handler = SWFUpload.queue.uploadCompleteHandler;\r\n\t\t\tthis.settings.upload_start_handler = SWFUpload.queue.uploadStartHandler;\r\n\t\t\tthis.settings.queue_complete_handler = this.settings.queue_complete_handler || null;\r\n\t\t};\r\n\t})(SWFUpload.prototype.initSettings);\r\n\tSWFUpload.prototype.startUpload = function (fileID) {\r\n\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\tthis.callFlash(\"StartUpload\", [fileID]);\r\n\t};\r\n\tSWFUpload.prototype.cancelQueue = function () {\r\n\t\tthis.queueSettings.queue_cancelled_flag = true;\r\n\t\tthis.stopUpload();\r\n\t\tvar stats = this.getStats();\r\n\t\twhile (stats.files_queued > 0) {\r\n\t\t\tthis.cancelUpload();\r\n\t\t\tstats = this.getStats();\r\n\t\t}\r\n\t};\r\n\tSWFUpload.queue.uploadStartHandler = function (file) {\r\n\t\tvar returnValue;\r\n\t\tif (typeof(this.queueSettings.user_upload_start_handler) === \"function\") {\r\n\t\t\treturnValue = this.queueSettings.user_upload_start_handler.call(this, file);\r\n\t\t}\r\n\t\treturnValue = (returnValue === false) ? false : true;\r\n\t\tthis.queueSettings.queue_cancelled_flag = !returnValue;\r\n\t\treturn returnValue;\r\n\t};\r\n\tSWFUpload.queue.uploadCompleteHandler = function (file) {\r\n\t\tvar user_upload_complete_handler = this.queueSettings.user_upload_complete_handler;\r\n\t\tvar continueUpload;\r\n\t\tif (file.filestatus === SWFUpload.FILE_STATUS.COMPLETE) {\r\n\t\t\tthis.queueSettings.queue_upload_count++;\r\n\t\t}\r\n\t\tif (typeof(user_upload_complete_handler) === \"function\") {\r\n\t\t\tcontinueUpload = (user_upload_complete_handler.call(this, file) === false) ? false : true;\r\n\t\t} else if (file.filestatus === SWFUpload.FILE_STATUS.QUEUED) {\r\n\t\t\tcontinueUpload = false;\r\n\t\t} else {\r\n\t\t\tcontinueUpload = true;\r\n\t\t}\r\n\t\tif (continueUpload) {\r\n\t\t\tvar stats = this.getStats();\r\n\t\t\tif (stats.files_queued > 0 && this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.startUpload();\r\n\t\t\t} else if (this.queueSettings.queue_cancelled_flag === false) {\r\n\t\t\t\tthis.queueEvent(\"queue_complete_handler\", [this.queueSettings.queue_upload_count]);\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.queueSettings.queue_cancelled_flag = false;\r\n\t\t\t\tthis.queueSettings.queue_upload_count = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n})();\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('pagebreak', function(K) {\r\n\tvar self = this;\r\n\tvar name = 'pagebreak';\r\n\tvar pagebreakHtml = K.undef(self.pagebreakHtml, '<hr style=\"page-break-after: always;\" class=\"ke-pagebreak\" />');\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar cmd = self.cmd, range = cmd.range;\r\n\t\tself.focus();\r\n\t\tvar tail = self.newlineTag == 'br' || K.WEBKIT ? '' : '<span id=\"__kindeditor_tail_tag__\"></span>';\r\n\t\tself.insertHtml(pagebreakHtml + tail);\r\n\t\tif (tail !== '') {\r\n\t\t\tvar p = K('#__kindeditor_tail_tag__', self.edit.doc);\r\n\t\t\trange.selectNodeContents(p[0]);\r\n\t\t\tp.removeAttr('id');\r\n\t\t\tcmd.select();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('plainpaste', function(K) {\r\n\tvar self = this, name = 'plainpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<textarea class=\"ke-textarea\" style=\"width:408px;height:260px;\"></textarea>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar html = textarea.val();\r\n\t\t\t\t\t\thtml = K.escape(html);\r\n\t\t\t\t\t\thtml = html.replace(/ {2}/g, ' &nbsp;');\r\n\t\t\t\t\t\tif (self.newlineTag == 'p') {\r\n\t\t\t\t\t\t\thtml = html.replace(/^/, '<p>').replace(/$/, '</p>').replace(/\\n/g, '</p><p>');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\thtml = html.replace(/\\n/g, '<br />$&');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttextarea = K('textarea', dialog.div);\r\n\t\ttextarea[0].focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('preview', function(K) {\r\n\tvar self = this, name = 'preview', undefined;\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:708px;height:400px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 750,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html\r\n\t\t\t}),\r\n\t\t\tiframe = K('iframe', dialog.div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tdoc.open();\r\n\t\tdoc.write(self.fullHtml());\r\n\t\tdoc.close();\r\n\t\tK(doc.body).css('background-color', '#FFF');\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('quickformat', function(K) {\r\n\tvar self = this, name = 'quickformat',\r\n\t\tblockMap = K.toMap('blockquote,center,div,h1,h2,h3,h4,h5,h6,p');\r\n\tfunction getFirstChild(knode) {\r\n\t\tvar child = knode.first();\r\n\t\twhile (child && child.first()) {\r\n\t\t\tchild = child.first();\r\n\t\t}\r\n\t\treturn child;\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tself.focus();\r\n\t\tvar doc = self.edit.doc,\r\n\t\t\trange = self.cmd.range,\r\n\t\t\tchild = K(doc.body).first(), next,\r\n\t\t\tnodeList = [], subList = [],\r\n\t\t\tbookmark = range.createBookmark(true);\r\n\t\twhile(child) {\r\n\t\t\tnext = child.next();\r\n\t\t\tvar firstChild = getFirstChild(child);\r\n\t\t\tif (!firstChild || firstChild.name != 'img') {\r\n\t\t\t\tif (blockMap[child.name]) {\r\n\t\t\t\t\tchild.html(child.html().replace(/^(\\s|&nbsp;|　)+/ig, ''));\r\n\t\t\t\t\tchild.css('text-indent', '2em');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubList.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tif (!next || (blockMap[next.name] || blockMap[child.name] && !blockMap[next.name])) {\r\n\t\t\t\t\tif (subList.length > 0) {\r\n\t\t\t\t\t\tnodeList.push(subList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsubList = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchild = next;\r\n\t\t}\r\n\t\tK.each(nodeList, function(i, subList) {\r\n\t\t\tvar wrapper = K('<p style=\"text-indent:2em;\"></p>', doc);\r\n\t\t\tsubList[0].before(wrapper);\r\n\t\t\tK.each(subList, function(i, knode) {\r\n\t\t\t\twrapper.append(knode);\r\n\t\t\t});\r\n\t\t});\r\n\t\trange.moveToBookmark(bookmark);\r\n\t\tself.addBookmark();\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('table', function(K) {\r\n\tvar self = this, name = 'table', lang = self.lang(name + '.'), zeroborder = 'ke-zeroborder';\r\n\tfunction _setColor(box, color) {\r\n\t\tcolor = color.toUpperCase();\r\n\t\tbox.css('background-color', color);\r\n\t\tbox.css('color', color === '#000000' ? '#FFFFFF' : '#000000');\r\n\t\tbox.html(color);\r\n\t}\r\n\tvar pickerList = [];\r\n\tfunction _initColorPicker(dialogDiv, colorBox) {\r\n\t\tcolorBox.bind('click,mousedown', function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t});\r\n\t\tfunction removePicker() {\r\n\t\t\tK.each(pickerList, function() {\r\n\t\t\t\tthis.remove();\r\n\t\t\t});\r\n\t\t\tpickerList = [];\r\n\t\t\tK(document).unbind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.unbind('click,mousedown', removePicker);\r\n\t\t}\r\n\t\tcolorBox.click(function(e) {\r\n\t\t\tremovePicker();\r\n\t\t\tvar box = K(this),\r\n\t\t\t\tpos = box.pos();\r\n\t\t\tvar picker = K.colorpicker({\r\n\t\t\t\tx : pos.x,\r\n\t\t\t\ty : pos.y + box.height(),\r\n\t\t\t\tz : 811214,\r\n\t\t\t\tselectedColor : K(this).html(),\r\n\t\t\t\tcolors : self.colorTable,\r\n\t\t\t\tnoColor : self.lang('noColor'),\r\n\t\t\t\tshadowMode : self.shadowMode,\r\n\t\t\t\tclick : function(color) {\r\n\t\t\t\t\t_setColor(box, color);\r\n\t\t\t\t\tremovePicker();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpickerList.push(picker);\r\n\t\t\tK(document).bind('click,mousedown', removePicker);\r\n\t\t\tdialogDiv.bind('click,mousedown', removePicker);\r\n\t\t});\r\n\t}\r\n\tfunction _getCellIndex(table, row, cell) {\r\n\t\tvar rowSpanCount = 0;\r\n\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\tif (row.cells[i] == cell) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\trowSpanCount += row.cells[i].rowSpan - 1;\r\n\t\t}\r\n\t\treturn cell.cellIndex - rowSpanCount;\r\n\t}\r\n\tself.plugin.table = {\r\n\t\tprop : function(isInsert) {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keRows\" style=\"width:90px;\">' + lang.cells + '</label>',\r\n\t\t\t\tlang.rows + ' <input type=\"text\" id=\"keRows\" class=\"ke-input-text ke-input-number\" name=\"rows\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.cols + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"cols\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"kePadding\" style=\"width:90px;\">' + lang.space + '</label>',\r\n\t\t\t\tlang.padding + ' <input type=\"text\" id=\"kePadding\" class=\"ke-input-text ke-input-number\" name=\"padding\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.spacing + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"spacing\" value=\"\" maxlength=\"4\" />',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\t'<select id=\"keAlign\" name=\"align\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar rows = rowsBox.val(),\r\n\t\t\t\t\t\t\tcols = colsBox.val(),\r\n\t\t\t\t\t\t\twidth = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\talign = alignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (rows == 0 || !/^\\d+$/.test(rows)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\trowsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cols == 0 || !/^\\d+$/.test(cols)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidRows'));\r\n\t\t\t\t\t\t\tcolsBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(padding)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidPadding'));\r\n\t\t\t\t\t\t\tpaddingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(spacing)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidSpacing'));\r\n\t\t\t\t\t\t\tspacingBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (table) {\r\n\t\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\t\ttable.width(width + widthType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('width', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].width !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('width');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\t\ttable.height(height + heightType);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.css('height', '');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (table[0].height !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('height');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttable.css('background-color', bgColor);\r\n\t\t\t\t\t\t\tif (table[0].bgColor !== undefined) {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('bgColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellPadding = padding;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellPadding');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].cellSpacing = spacing;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('cellSpacing');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\t\ttable[0].align = align;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('align');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('border', border);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('border');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\t\ttable.addClass(zeroborder);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeClass(zeroborder);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\t\ttable.attr('borderColor', borderColor);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttable.removeAttr('borderColor');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar style = '';\r\n\t\t\t\t\t\tif (width !== '') {\r\n\t\t\t\t\t\t\tstyle += 'width:' + width + widthType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (height !== '') {\r\n\t\t\t\t\t\t\tstyle += 'height:' + height + heightType + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (bgColor !== '') {\r\n\t\t\t\t\t\t\tstyle += 'background-color:' + bgColor + ';';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '<table';\r\n\t\t\t\t\t\tif (style !== '') {\r\n\t\t\t\t\t\t\thtml += ' style=\"' + style + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (padding !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellpadding=\"' + padding + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (spacing !== '') {\r\n\t\t\t\t\t\t\thtml += ' cellspacing=\"' + spacing + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (align !== '') {\r\n\t\t\t\t\t\t\thtml += ' align=\"' + align + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border !== '') {\r\n\t\t\t\t\t\t\thtml += ' border=\"' + border + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (border === '' || border === '0') {\r\n\t\t\t\t\t\t\thtml += ' class=\"' + zeroborder + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (borderColor !== '') {\r\n\t\t\t\t\t\t\thtml += ' bordercolor=\"' + borderColor + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '>';\r\n\t\t\t\t\t\tfor (var i = 0; i < rows; i++) {\r\n\t\t\t\t\t\t\thtml += '<tr>';\r\n\t\t\t\t\t\t\tfor (var j = 0; j < cols; j++) {\r\n\t\t\t\t\t\t\t\thtml += '<td>' + (K.IE ? '&nbsp;' : '<br />') + '</td>';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += '</tr>';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thtml += '</table>';\r\n\t\t\t\t\t\tif (!K.IE) {\r\n\t\t\t\t\t\t\thtml += '<br />';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tself.insertHtml(html);\r\n\t\t\t\t\t\tself.select().hideDialog().focus();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\trowsBox = K('[name=\"rows\"]', div).val(3),\r\n\t\t\tcolsBox = K('[name=\"cols\"]', div).val(2),\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\talignBox = K('[name=\"align\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\trowsBox[0].focus();\r\n\t\t\trowsBox[0].select();\r\n\t\t\tvar table;\r\n\t\t\tif (isInsert) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttable = self.plugin.getSelectedTable();\r\n\t\t\tif (table) {\r\n\t\t\t\trowsBox.val(table[0].rows.length);\r\n\t\t\t\tcolsBox.val(table[0].rows.length > 0 ? table[0].rows[0].cells.length : 0);\r\n\t\t\t\trowsBox.attr('disabled', true);\r\n\t\t\t\tcolsBox.attr('disabled', true);\r\n\t\t\t\tvar match,\r\n\t\t\t\t\ttableWidth = table[0].style.width || table[0].width,\r\n\t\t\t\t\ttableHeight = table[0].style.height || table[0].height;\r\n\t\t\t\tif (tableWidth !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableWidth))) {\r\n\t\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twidthBox.val('');\r\n\t\t\t\t}\r\n\t\t\t\tif (tableHeight !== undefined && (match = /^(\\d+)((?:px|%)*)$/.exec(tableHeight))) {\r\n\t\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t\t}\r\n\t\t\t\tpaddingBox.val(table[0].cellPadding || '');\r\n\t\t\t\tspacingBox.val(table[0].cellSpacing || '');\r\n\t\t\t\talignBox.val(table[0].align || '');\r\n\t\t\t\tborderBox.val(table[0].border === undefined ? '' : table[0].border);\r\n\t\t\t\t_setColor(colorBox.eq(0), K.toHex(table.attr('borderColor') || ''));\r\n\t\t\t\t_setColor(colorBox.eq(1), K.toHex(table[0].style.backgroundColor || table[0].bgColor || ''));\r\n\t\t\t\twidthBox[0].focus();\r\n\t\t\t\twidthBox[0].select();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcellprop : function() {\r\n\t\t\tvar html = [\r\n\t\t\t\t'<div style=\"padding:20px;\">',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keWidth\" style=\"width:90px;\">' + lang.size + '</label>',\r\n\t\t\t\tlang.width + ' <input type=\"text\" id=\"keWidth\" class=\"ke-input-text ke-input-number\" name=\"width\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"widthType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select> &nbsp; ',\r\n\t\t\t\tlang.height + ' <input type=\"text\" class=\"ke-input-text ke-input-number\" name=\"height\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\t'<select name=\"heightType\">',\r\n\t\t\t\t'<option value=\"%\">' + lang.percent + '</option>',\r\n\t\t\t\t'<option value=\"px\">' + lang.px + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keAlign\" style=\"width:90px;\">' + lang.align + '</label>',\r\n\t\t\t\tlang.textAlign + ' <select id=\"keAlign\" name=\"textAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"left\">' + lang.alignLeft + '</option>',\r\n\t\t\t\t'<option value=\"center\">' + lang.alignCenter + '</option>',\r\n\t\t\t\t'<option value=\"right\">' + lang.alignRight + '</option>',\r\n\t\t\t\t'</select> ',\r\n\t\t\t\tlang.verticalAlign + ' <select name=\"verticalAlign\">',\r\n\t\t\t\t'<option value=\"\">' + lang.alignDefault + '</option>',\r\n\t\t\t\t'<option value=\"top\">' + lang.alignTop + '</option>',\r\n\t\t\t\t'<option value=\"middle\">' + lang.alignMiddle + '</option>',\r\n\t\t\t\t'<option value=\"bottom\">' + lang.alignBottom + '</option>',\r\n\t\t\t\t'<option value=\"baseline\">' + lang.alignBaseline + '</option>',\r\n\t\t\t\t'</select>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBorder\" style=\"width:90px;\">' + lang.border + '</label>',\r\n\t\t\t\tlang.borderWidth + ' <input type=\"text\" id=\"keBorder\" class=\"ke-input-text ke-input-number\" name=\"border\" value=\"\" maxlength=\"4\" /> &nbsp; ',\r\n\t\t\t\tlang.borderColor + ' <span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-dialog-row\">',\r\n\t\t\t\t'<label for=\"keBgColor\" style=\"width:90px;\">' + lang.backgroundColor + '</label>',\r\n\t\t\t\t'<span class=\"ke-inline-block ke-input-color\"></span>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\t\t\tvar bookmark = self.cmd.range.createBookmark();\r\n\t\t\tvar dialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 500,\r\n\t\t\t\ttitle : self.lang('tablecell'),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tbeforeRemove : function() {\r\n\t\t\t\t\tcolorBox.unbind();\r\n\t\t\t\t},\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar width = widthBox.val(),\r\n\t\t\t\t\t\t\theight = heightBox.val(),\r\n\t\t\t\t\t\t\twidthType = widthTypeBox.val(),\r\n\t\t\t\t\t\t\theightType = heightTypeBox.val(),\r\n\t\t\t\t\t\t\tpadding = paddingBox.val(),\r\n\t\t\t\t\t\t\tspacing = spacingBox.val(),\r\n\t\t\t\t\t\t\ttextAlign = textAlignBox.val(),\r\n\t\t\t\t\t\t\tverticalAlign = verticalAlignBox.val(),\r\n\t\t\t\t\t\t\tborder = borderBox.val(),\r\n\t\t\t\t\t\t\tborderColor = K(colorBox[0]).html() || '',\r\n\t\t\t\t\t\t\tbgColor = K(colorBox[1]).html() || '';\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(width)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidWidth'));\r\n\t\t\t\t\t\t\twidthBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(height)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidHeight'));\r\n\t\t\t\t\t\t\theightBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!/^\\d*$/.test(border)) {\r\n\t\t\t\t\t\t\talert(self.lang('invalidBorder'));\r\n\t\t\t\t\t\t\tborderBox[0].focus();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.css({\r\n\t\t\t\t\t\t\twidth : width !== '' ? (width + widthType) : '',\r\n\t\t\t\t\t\t\theight : height !== '' ? (height + heightType) : '',\r\n\t\t\t\t\t\t\t'background-color' : bgColor,\r\n\t\t\t\t\t\t\t'text-align' : textAlign,\r\n\t\t\t\t\t\t\t'vertical-align' : verticalAlign,\r\n\t\t\t\t\t\t\t'border-width' : border,\r\n\t\t\t\t\t\t\t'border-style' : border !== '' ? 'solid' : '',\r\n\t\t\t\t\t\t\t'border-color' : borderColor\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tself.hideDialog().focus();\r\n\t\t\t\t\t\tself.cmd.range.moveToBookmark(bookmark);\r\n\t\t\t\t\t\tself.cmd.select();\r\n\t\t\t\t\t\tself.addBookmark();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\twidthBox = K('[name=\"width\"]', div).val(100),\r\n\t\t\theightBox = K('[name=\"height\"]', div),\r\n\t\t\twidthTypeBox = K('[name=\"widthType\"]', div),\r\n\t\t\theightTypeBox = K('[name=\"heightType\"]', div),\r\n\t\t\tpaddingBox = K('[name=\"padding\"]', div).val(2),\r\n\t\t\tspacingBox = K('[name=\"spacing\"]', div).val(0),\r\n\t\t\ttextAlignBox = K('[name=\"textAlign\"]', div),\r\n\t\t\tverticalAlignBox = K('[name=\"verticalAlign\"]', div),\r\n\t\t\tborderBox = K('[name=\"border\"]', div).val(1),\r\n\t\t\tcolorBox = K('.ke-input-color', div);\r\n\t\t\t_initColorPicker(div, colorBox.eq(0));\r\n\t\t\t_initColorPicker(div, colorBox.eq(1));\r\n\t\t\t_setColor(colorBox.eq(0), '#000000');\r\n\t\t\t_setColor(colorBox.eq(1), '');\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t\tvar cell = self.plugin.getSelectedCell();\r\n\t\t\tvar match,\r\n\t\t\t\tcellWidth = cell[0].style.width || cell[0].width || '',\r\n\t\t\t\tcellHeight = cell[0].style.height || cell[0].height || '';\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellWidth))) {\r\n\t\t\t\twidthBox.val(match[1]);\r\n\t\t\t\twidthTypeBox.val(match[2]);\r\n\t\t\t} else {\r\n\t\t\t\twidthBox.val('');\r\n\t\t\t}\r\n\t\t\tif ((match = /^(\\d+)((?:px|%)*)$/.exec(cellHeight))) {\r\n\t\t\t\theightBox.val(match[1]);\r\n\t\t\t\theightTypeBox.val(match[2]);\r\n\t\t\t}\r\n\t\t\ttextAlignBox.val(cell[0].style.textAlign || '');\r\n\t\t\tverticalAlignBox.val(cell[0].style.verticalAlign || '');\r\n\t\t\tvar border = cell[0].style.borderWidth || '';\r\n\t\t\tif (border) {\r\n\t\t\t\tborder = parseInt(border);\r\n\t\t\t}\r\n\t\t\tborderBox.val(border);\r\n\t\t\t_setColor(colorBox.eq(0), K.toHex(cell[0].style.borderColor || ''));\r\n\t\t\t_setColor(colorBox.eq(1), K.toHex(cell[0].style.backgroundColor || ''));\r\n\t\t\twidthBox[0].focus();\r\n\t\t\twidthBox[0].select();\r\n\t\t},\r\n\t\tinsert : function() {\r\n\t\t\tthis.prop(true);\r\n\t\t},\r\n\t\t'delete' : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable();\r\n\t\t\tself.cmd.range.setStartBefore(table[0]).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\ttable.remove();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex + offset;\r\n\t\t\tindex += table.rows[0].cells.length - row.cells.length;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(index);\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tindex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolinsertleft : function() {\r\n\t\t\tthis.colinsert(0);\r\n\t\t},\r\n\t\tcolinsertright : function() {\r\n\t\t\tthis.colinsert(1);\r\n\t\t},\r\n\t\trowinsert : function(offset) {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0];\r\n\t\t\tvar rowIndex = row.rowIndex;\r\n\t\t\tif (offset === 1) {\r\n\t\t\t\trowIndex = row.rowIndex + (cell.rowSpan - 1) + offset;\r\n\t\t\t}\r\n\t\t\tvar newRow = table.insertRow(rowIndex);\r\n\t\t\tfor (var i = 0, len = row.cells.length; i < len; i++) {\r\n\t\t\t\tif (row.cells[i].rowSpan > 1) {\r\n\t\t\t\t\tlen -= row.cells[i].rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar newCell = newRow.insertCell(i);\r\n\t\t\t\tif (offset === 1 && row.cells[i].colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = row.cells[i].colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tfor (var j = rowIndex; j >= 0; j--) {\r\n\t\t\t\tvar cells = table.rows[j].cells;\r\n\t\t\t\tif (cells.length > i) {\r\n\t\t\t\t\tfor (var k = cell.cellIndex; k >= 0; k--) {\r\n\t\t\t\t\t\tif (cells[k].rowSpan > 1) {\r\n\t\t\t\t\t\t\tcells[k].rowSpan += 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowinsertabove : function() {\r\n\t\t\tthis.rowinsert(0);\r\n\t\t},\r\n\t\trowinsertbelow : function() {\r\n\t\t\tthis.rowinsert(1);\r\n\t\t},\r\n\t\trowmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tnextRowIndex = rowIndex + cell.rowSpan,\r\n\t\t\t\tnextRow = table.rows[nextRowIndex];\r\n\t\t\tif (table.rows.length <= nextRowIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = cell.cellIndex;\r\n\t\t\tif (nextRow.cells.length <= cellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = nextRow.cells[cellIndex];\r\n\t\t\tif (cell.colSpan !== nextCell.colSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.rowSpan += nextCell.rowSpan;\r\n\t\t\tnextRow.deleteCell(cellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolmerge : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex,\r\n\t\t\t\tcellIndex = cell.cellIndex,\r\n\t\t\t\tnextCellIndex = cellIndex + 1;\r\n\t\t\tif (row.cells.length <= nextCellIndex) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar nextCell = row.cells[nextCellIndex];\r\n\t\t\tif (cell.rowSpan !== nextCell.rowSpan) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcell.colSpan += nextCell.colSpan;\r\n\t\t\trow.deleteCell(nextCellIndex);\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tif (cell.rowSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cellIndex = _getCellIndex(table, row, cell);\r\n\t\t\tfor (var i = 1, len = cell.rowSpan; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[rowIndex + i],\r\n\t\t\t\t\tnewCell = newRow.insertCell(cellIndex);\r\n\t\t\t\tif (cell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan = cell.colSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t\tcellIndex = _getCellIndex(table, newRow, newCell);\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('rowSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcolsplit : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tcellIndex = cell.cellIndex;\r\n\t\t\tif (cell.colSpan === 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (var i = 1, len = cell.colSpan; i < len; i++) {\r\n\t\t\t\tvar newCell = row.insertCell(cellIndex + i);\r\n\t\t\t\tif (cell.rowSpan > 1) {\r\n\t\t\t\t\tnewCell.rowSpan = cell.rowSpan;\r\n\t\t\t\t}\r\n\t\t\t\tnewCell.innerHTML = K.IE ? '' : '<br />';\r\n\t\t\t}\r\n\t\t\tK(cell).removeAttr('colSpan');\r\n\t\t\tself.cmd.range.selectNodeContents(cell).collapse(true);\r\n\t\t\tself.cmd.select();\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\tcoldelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\tindex = cell.cellIndex;\r\n\t\t\tfor (var i = 0, len = table.rows.length; i < len; i++) {\r\n\t\t\t\tvar newRow = table.rows[i],\r\n\t\t\t\t\tnewCell = newRow.cells[index];\r\n\t\t\t\tif (newCell.colSpan > 1) {\r\n\t\t\t\t\tnewCell.colSpan -= 1;\r\n\t\t\t\t\tif (newCell.colSpan === 1) {\r\n\t\t\t\t\t\tK(newCell).removeAttr('colSpan');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewRow.deleteCell(index);\r\n\t\t\t\t}\r\n\t\t\t\tif (newCell.rowSpan > 1) {\r\n\t\t\t\t\ti += newCell.rowSpan - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (row.cells.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t},\r\n\t\trowdelete : function() {\r\n\t\t\tvar table = self.plugin.getSelectedTable()[0],\r\n\t\t\t\trow = self.plugin.getSelectedRow()[0],\r\n\t\t\t\tcell = self.plugin.getSelectedCell()[0],\r\n\t\t\t\trowIndex = row.rowIndex;\r\n\t\t\tfor (var i = cell.rowSpan - 1; i >= 0; i--) {\r\n\t\t\t\ttable.deleteRow(rowIndex + i);\r\n\t\t\t}\r\n\t\t\tif (table.rows.length === 0) {\r\n\t\t\t\tself.cmd.range.setStartBefore(table).collapse(true);\r\n\t\t\t\tself.cmd.select();\r\n\t\t\t\tK(table).remove();\r\n\t\t\t} else {\r\n\t\t\t\tself.cmd.selection(true);\r\n\t\t\t}\r\n\t\t\tself.addBookmark();\r\n\t\t}\r\n\t};\r\n\tself.clickToolbar(name, self.plugin.table.prop);\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('template', function(K) {\r\n\tvar self = this, name = 'template', lang = self.lang(name + '.'),\r\n\t\thtmlPath = self.pluginsPath + name + '/html/';\r\n\tfunction getFilePath(fileName) {\r\n\t\treturn htmlPath + fileName + '?ver=' + encodeURIComponent(K.DEBUG ? K.TIME : K.VERSION);\r\n\t}\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\tarr = ['<div style=\"padding:10px 20px;\">',\r\n\t\t\t\t'<div class=\"ke-header\">',\r\n\t\t\t\t'<div class=\"ke-left\">',\r\n\t\t\t\tlang. selectTemplate + ' <select>'];\r\n\t\t\tK.each(lang.fileList, function(key, val) {\r\n\t\t\t\tarr.push('<option value=\"' + key + '\">' + val + '</option>');\r\n\t\t\t});\r\n\t\t\thtml = [arr.join(''),\r\n\t\t\t\t'</select></div>',\r\n\t\t\t\t'<div class=\"ke-right\">',\r\n\t\t\t\t'<input type=\"checkbox\" id=\"keReplaceFlag\" name=\"replaceFlag\" value=\"1\" /> <label for=\"keReplaceFlag\">' + lang.replaceContent + '</label>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<div class=\"ke-clearfix\"></div>',\r\n\t\t\t\t'</div>',\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:458px;height:260px;background-color:#FFF;\"></iframe>',\r\n\t\t\t\t'</div>'].join('');\r\n\t\tvar dialog = self.createDialog({\r\n\t\t\tname : name,\r\n\t\t\twidth : 500,\r\n\t\t\ttitle : self.lang(name),\r\n\t\t\tbody : html,\r\n\t\t\tyesBtn : {\r\n\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\tclick : function(e) {\r\n\t\t\t\t\tvar doc = K.iframeDoc(iframe);\r\n\t\t\t\t\tself[checkbox[0].checked ? 'html' : 'insertHtml'](doc.body.innerHTML).hideDialog().focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar selectBox = K('select', dialog.div),\r\n\t\t\tcheckbox = K('[name=\"replaceFlag\"]', dialog.div),\r\n\t\t\tiframe = K('iframe', dialog.div);\r\n\t\tcheckbox[0].checked = true;\r\n\t\tiframe.attr('src', getFilePath(selectBox.val()));\r\n\t\tselectBox.change(function() {\r\n\t\t\tiframe.attr('src', getFilePath(this.value));\r\n\t\t});\r\n\t});\r\n});\r\n\r\n/*******************************************************************************\r\n* KindEditor - WYSIWYG HTML Editor for Internet\r\n* Copyright (C) 2006-2011 kindsoft.net\r\n*\r\n* @author Roddy <luolonghao@gmail.com>\r\n* @site http://www.kindsoft.net/\r\n* @licence http://www.kindsoft.net/license.php\r\n*******************************************************************************/\r\nKindEditor.plugin('wordpaste', function(K) {\r\n\tvar self = this, name = 'wordpaste';\r\n\tself.clickToolbar(name, function() {\r\n\t\tvar lang = self.lang(name + '.'),\r\n\t\t\thtml = '<div style=\"padding:10px 20px;\">' +\r\n\t\t\t\t'<div style=\"margin-bottom:10px;\">' + lang.comment + '</div>' +\r\n\t\t\t\t'<iframe class=\"ke-textarea\" frameborder=\"0\" style=\"width:408px;height:260px;\"></iframe>' +\r\n\t\t\t\t'</div>',\r\n\t\t\tdialog = self.createDialog({\r\n\t\t\t\tname : name,\r\n\t\t\t\twidth : 450,\r\n\t\t\t\ttitle : self.lang(name),\r\n\t\t\t\tbody : html,\r\n\t\t\t\tyesBtn : {\r\n\t\t\t\t\tname : self.lang('yes'),\r\n\t\t\t\t\tclick : function(e) {\r\n\t\t\t\t\t\tvar str = doc.body.innerHTML;\r\n\t\t\t\t\t\tstr = K.clearMsWord(str, self.filterMode ? self.htmlTags : K.options.htmlTags);\r\n\t\t\t\t\t\tself.insertHtml(str).hideDialog().focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tdiv = dialog.div,\r\n\t\t\tiframe = K('iframe', div),\r\n\t\t\tdoc = K.iframeDoc(iframe);\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.designMode = 'on';\r\n\t\t}\r\n\t\tdoc.open();\r\n\t\tdoc.write('<!doctype html><html><head><title>WordPaste</title></head>');\r\n\t\tdoc.write('<body style=\"background-color:#FFF;font-size:12px;margin:2px;\">');\r\n\t\tif (!K.IE) {\r\n\t\t\tdoc.write('<br />');\r\n\t\t}\r\n\t\tdoc.write('</body></html>');\r\n\t\tdoc.close();\r\n\t\tif (K.IE) {\r\n\t\t\tdoc.body.contentEditable = 'true';\r\n\t\t}\r\n\t\tiframe[0].contentWindow.focus();\r\n\t});\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/kindeditor/kindeditor-all.js\n// module id = 4uE9\n// module chunks = 0 1 2 3 4","var anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar newPromiseCapability = require('./_new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_promise-resolve.js\n// module id = 5Czc\n// module chunks = 0","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/core.get-iterator-method.js\n// module id = 7AqT\n// module chunks = 0","'use strict';\nvar LIBRARY = require('./_library');\nvar global = require('./_global');\nvar ctx = require('./_ctx');\nvar classof = require('./_classof');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar aFunction = require('./_a-function');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar speciesConstructor = require('./_species-constructor');\nvar task = require('./_task').set;\nvar microtask = require('./_microtask')();\nvar newPromiseCapabilityModule = require('./_new-promise-capability');\nvar perform = require('./_perform');\nvar userAgent = require('./_user-agent');\nvar promiseResolve = require('./_promise-resolve');\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/es6.promise.js\n// module id = 9kJF\n// module chunks = 0","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.promise');\nrequire('../modules/es7.promise.finally');\nrequire('../modules/es7.promise.try');\nmodule.exports = require('../modules/_core').Promise;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/fn/promise.js\n// module id = 9u1Q\n// module chunks = 0","'use strict';\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = require('./_a-function');\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_new-promise-capability.js\n// module id = AIlg\n// module chunks = 0","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = require('./_an-object');\nvar aFunction = require('./_a-function');\nvar SPECIES = require('./_wks')('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_species-constructor.js\n// module id = B1ls\n// module chunks = 0","'use strict';\nvar global = require('./_global');\nvar core = require('./_core');\nvar dP = require('./_object-dp');\nvar DESCRIPTORS = require('./_descriptors');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (KEY) {\n  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_set-species.js\n// module id = FGzK\n// module chunks = 0","var global = require('./_global');\nvar macrotask = require('./_task').set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = require('./_cof')(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_microtask.js\n// module id = H109\n// module chunks = 0","module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_an-instance.js\n// module id = KUik\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/promise\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/babel-runtime/core-js/promise.js\n// module id = L3Vt\n// module chunks = 0","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_iter-detect.js\n// module id = Lli7\n// module chunks = 0","var hide = require('./_hide');\nmodule.exports = function (target, src, safe) {\n  for (var key in src) {\n    if (safe && target[key]) target[key] = src[key];\n    else hide(target, key, src[key]);\n  } return target;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_redefine-all.js\n// module id = O6kh\n// module chunks = 0","<template>\r\n  <el-container class=\"project\">\r\n    <el-aside width=\"200px\" class=\"select-project\">\r\n      <button @click=\"dialogToggle\">新增课题</button>\r\n      <el-menu :default-active=\"0\">\r\n        <el-menu-item v-for=\"(item,index) in newsLists\" :key=\"index\" :index=\"index\" @click=\"showdetail(item)\">\r\n          <span slot=\"title\">{{item.subjectName}}</span>\r\n        </el-menu-item>\r\n      </el-menu>\r\n    </el-aside>\r\n    <el-main>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"24\">\r\n          <div class=\"grid-content bg-purple\">\r\n            <div class=\"article-header\">\r\n              <div class=\"article-title\">{{newsList.subjectName}}</div>\r\n              <div class=\"article-info clearfix\">\r\n                <div class=\"article-info-left\">\r\n                  <span>学习天数：{{newsList.subjectTime}}天</span><span>|</span>\r\n                  <span>技能分类：{{newsList.knowGroupTypeValue}}</span><span>|</span>\r\n                  <span>技能类型：{{newsList.knowTypeValue}}</span>\r\n                </div>\r\n                <div class=\"article-info-right\">\r\n                  <span class=\"edit-project\" @click=\"edit()\"><i class=\"fa fa-edit\"></i>&nbsp;编辑</span><span>|</span>\r\n                  <span class=\"del-project\" @click=\"deleteProject() \"><i class=\"fa fa-trash-o\"></i>&nbsp;删除</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"article-content\">\r\n              <div class=\"know-article\">\r\n                <div class=\"know-articles\">学习目标：<br>\r\n                  <p>{{newsList.subjectDest}}</p>\r\n                </div>\r\n                <div class=\"know-articles\" v-html=\"'技能描述：'+'<br>'+'<p>'+this.newsList.subjectRemark+'</p>'\"></div>\r\n              </div>\r\n              <div class=\"article-attachs\">\r\n                <span class=\"tag-name\">附件：无</span>\r\n                <!-- <span class=\"tag-content\" v-show=\"typeof this.newsList.attaches === 'undefined'||articleInfo.attaches.length == 0\">无</span>\r\n                <span class=\"attach-group\" v-for=\"(item,index) in articleInfo.attaches\" @click=\"previewAttach(item)\"> {{item.attachName}}</span> -->\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </el-main>\r\n    <el-dialog title=\"新增\" :visible.sync=\"dialogFormVisible\" size=\"mini\" class=\"main-content\" width=\"70%\">\r\n      <el-form :label-position=\"labelPosition\" :inline=\"true\" label-width=\"150px\" :rules=\"rules\" :model=\"addDetail\" size=\"mini\" ref=\"formName\">\r\n        <el-form-item label=\"课题名称\" prop=\"subjectName\">\r\n          <el-input v-model=\"addDetail.subjectName\" placeholder=\"课题名称\" name=\"subjectName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"学习天数\" prop=\"subjectTime\">\r\n          <el-input v-model.number=\"addDetail.subjectTime\" placeholder=\"学习天数\" name=\"subjectTime\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"学习目标\" prop=\"subjectDest\">\r\n          <el-input v-model=\"addDetail.subjectDest\" placeholder=\"学习目标\" name=\"subjectDest\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"技能类型\" prop=\"subjectType\">\r\n          <el-select v-model=\"addDetail.subjectType\" placeholder=\"请选择技能类型\">\r\n            <el-option v-for=\"item in subjectType\" :key=\"item.typeId\" :label=\"item.typeValue\" :value=\"item.typeId\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"归属组\" prop=\"subjectGroupType\">\r\n          <el-select v-model=\"addDetail.subjectGroupType\" placeholder=\"请选择您的归属组\">\r\n            <el-option v-for=\"item in subjectGroupType\" :key=\"item.typeId\" :label=\"item.typeValue\" :value=\"item.typeId\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"技能描述\" prop=\"subjectRemark\" style=\"height:calc(100% - 200px)\" class=\"subjectledge-content-editor\">\r\n          <div style=\"height:100%\">\r\n            <textarea name=\"editor\" id=\"editor\"></textarea>\r\n          </div>\r\n        </el-form-item>\r\n        <el-upload class=\"upload-demo clearfix\" ref=\"upload\" action=\"www.baidu.com\" :on-remove=\"handleRemove\" :file-list=\"fileList\" :auto-upload=\"false\">\r\n          <div class=\"updateweekly\">上传周报附件</div>\r\n          <el-button slot=\"trigger\" size=\"small\" type=\"primary\" class=\"selfile\">选取文件</el-button>\r\n          <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload\">上传到服务器</el-button>\r\n        </el-upload>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"addProject(addDetail,'formName',fileList)\" size=\"small\">新增</el-button>\r\n              <el-button type=\"primary\" @click=\"dialogFormVisible= false\" size=\"small\">取消</el-button>\r\n            </span>\r\n    </el-dialog>\r\n    <el-dialog title=\"编辑\" :visible.sync=\"dialogVisible\" width=\"70%\" size=\"mini\" class=\"main-content\">\r\n      <el-form :label-position=\"labelPosition\" :inline=\"true\" label-width=\"130px\" :rules=\"rules\" :model=\"editDetail\" size=\"mini\" ref=\"formName\">\r\n        <el-form-item label=\"课题名称\" prop=\"subjectName\">\r\n          <el-input v-model=\"editDetail.subjectName\" placeholder=\"课题名称\" name=\"subjectName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"学习天数\" prop=\"subjectTime\">\r\n          <el-input v-model.number=\"editDetail.subjectTime\" placeholder=\"学习天数\" name=\"subjectTime\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"学习目标\" prop=\"subjectDest\">\r\n          <el-input v-model=\"editDetail.subjectDest\" placeholder=\"学习目标\" name=\"subjectDest\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"技能类型\" prop=\"subjectType\">\r\n          <el-select v-model=\"editDetail.subjectType\" placeholder=\"请选择技能类型\">\r\n            <el-option v-for=\"item in subjectType\" :key=\"item.typeId\" :label=\"item.typeValue\" :value=\"item.typeId\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"归属组\" prop=\"subjectGroupType\">\r\n          <el-select v-model=\"editDetail.subjectGroupType\" placeholder=\"请选择您的归属组\">\r\n            <el-option v-for=\"item in subjectGroupType\" :key=\"item.typeId\" :label=\"item.typeValue\" :value=\"item.typeId\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"技能描述\" prop=\"subjectRemarks\" style=\"height:calc(100% - 200px)\" class=\"subjectledge-content-editors\">\r\n          <div style=\"height:100%\">\r\n            <textarea name=\"editor\" id=\"edit\"></textarea>\r\n          </div>\r\n        </el-form-item>\r\n        <el-upload class=\"upload-demo clearfix\" ref=\"upload\" action=\"www.baidu.com\" :on-remove=\"handleRemove\" :file-list=\"fileList\" :auto-upload=\"false\">\r\n          <div class=\"updateweekly\">上传周报附件</div>\r\n          <el-button slot=\"trigger\" size=\"small\" type=\"primary\" class=\"selfile\">选取文件</el-button>\r\n          <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload(editDetail, filesList)\">上传到服务器</el-button>\r\n        </el-upload>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"update(editDetail,'formName',filesList)\" size=\"small\">更新</el-button>\r\n          <el-button type=\"primary\" @click=\"dialogVisible = false\" size=\"small\">取消</el-button>\r\n        </span>\r\n    </el-dialog>\r\n  </el-container>\r\n</template>\r\n<script>\r\n  import service from \"../scripts/service.js\";\r\n  require(\"kindeditor\");\r\n  require(\"kindeditor/themes/default/default.css\");\r\n  export default {\r\n    name: \"table1\",\r\n    data() {\r\n      return {\r\n        activeIndex: 8,\r\n        list: [{\r\n            subjectId: 1,\r\n            subjectName: \"课题一\"\r\n          },\r\n          {\r\n            subjectId: 2,\r\n            subjectName: \"课题二\"\r\n          },\r\n          {\r\n            subjectId: 3,\r\n            subjectName: \"课题三\"\r\n          },\r\n          {\r\n            subjectId: 4,\r\n            subjectName: \"课题四\"\r\n          }\r\n        ],\r\n        addDetail: {\r\n          subjectType: \"\",\r\n          subjectGroupType: \"\"\r\n        },\r\n        editDetail: {},\r\n        filesList: [{\r\n            attachName: \"附件三\",\r\n            attachRemark: \"www.baidu.com\"\r\n          },\r\n          {\r\n            attachName: \"附件四\",\r\n            attachRemark: \"www.baidu.com\"\r\n          }\r\n        ],\r\n        subjecttype: [],\r\n        index: 0,\r\n        dialogVisible: false,\r\n        dialogFormVisible: false,\r\n        newsList: {},\r\n        newsLists: {},\r\n        fileList: [{\r\n            attachName: \"\",\r\n            attachRemark: \"\"\r\n          },\r\n          {\r\n            attachName: \"\",\r\n            attachRemark: \"\"\r\n          }\r\n        ],\r\n        //多选值\r\n        multipleSelection: [],\r\n        rules: {\r\n          subjectGroupType: [{\r\n            required: true,\r\n            message: \"请选择归属组\",\r\n            trigger: \"blur\"\r\n          }],\r\n          subjectName: [{\r\n            required: true,\r\n            message: \"请输入课题名称\",\r\n            trigger: \"blur\"\r\n          }],\r\n          subjectTime: [{\r\n              required: true,\r\n              message: \"请输入学习天数\",\r\n              trigger: \"blur\"\r\n            },\r\n            {\r\n              type: \"number\",\r\n              message: \"学习天数必须为数字值\"\r\n            }\r\n          ],\r\n          subjectDest: [{\r\n            required: true,\r\n            message: \"请输入学习目标\",\r\n            trigger: \"blur\"\r\n          }],\r\n          subjectType: [{\r\n            required: true,\r\n            message: \"请选择技能类型\",\r\n            trigger: \"blur\"\r\n          }]\r\n        }\r\n      };\r\n    },\r\n    mounted: function() {\r\n      this.getAllList();\r\n      this.getselect();\r\n    },\r\n    methods: {\r\n      dialogToggle() {\r\n        new Promise((resolve, reject) => {\r\n          this.dialogFormVisible = true;\r\n          resolve(\"success\");\r\n        }).then(() => {\r\n          this.initEdit();\r\n        });\r\n      },\r\n      //展示详情\r\n      showdetail(item) {\r\n        let params = {\r\n          subjectId: item.subjectId\r\n        };\r\n        console.log(params);\r\n        service\r\n          .getProjectDetail(params)\r\n          .then(res => {\r\n            console.log(res);\r\n            // 将获取回来的数据赋值给list\r\n            this.newsList = res.data;\r\n            console.log(this.newsList);\r\n            this.editDetail = {\r\n              subjectName: this.newsList.subjectName,\r\n              subjectTime: this.newsList.subjectTime,\r\n              subjectType: this.newsList.subjectType,\r\n              subjectGroupType: this.newsList.subjectGroupType,\r\n              subjectDest: this.newsList.subjectDest\r\n            };\r\n            console.log(this.editDetail);\r\n          })\r\n          .catch(err => {\r\n            console.log(err);\r\n          });\r\n        console.log(item.subjectId);\r\n      },\r\n      initEdit() {\r\n        KindEditor.create(\"#editor\", {\r\n          width: \"90%\",\r\n          height: this.editorHeight + \"px\",\r\n          themeType: \"simple\",\r\n          items: [\r\n            \"undo\",\r\n            \"redo\",\r\n            \"|\",\r\n            \"selectall\",\r\n            \"formatblock\",\r\n            \"fontname\",\r\n            \"fontsize\",\r\n            \"|\",\r\n            \"forecolor\",\r\n            \"hilitecolor\",\r\n            \"bold\",\r\n            \"italic\",\r\n            \"underline\",\r\n            \"strikethrough\",\r\n            \"lineheight\",\r\n            \"removeformat\",\r\n            \"|\",\r\n            \"preview\",\r\n            \"cut\",\r\n            \"copy\",\r\n            \"paste\",\r\n            \"plainpaste\",\r\n            \"|\",\r\n            \"justifyleft\",\r\n            \"justifycenter\",\r\n            \"justifyright\",\r\n            \"justifyfull\",\r\n            \"insertorderedlist\",\r\n            \"insertunorderedlist\",\r\n            \"indent\",\r\n            \"outdent\",\r\n            \"subscript\",\r\n            \"superscript\",\r\n            \"|\",\r\n            \"image\",\r\n            \"hr\",\r\n            \"code\"\r\n          ],\r\n          resizeType: \"\",\r\n          newlineTag: \"br\",\r\n          imageTabIndex: 1,\r\n          uploadJson: \"/KnowledgesController/savePic\",\r\n          filePostName: \"file\",\r\n          allowImageUpload: true,\r\n          allowFileManager: false,\r\n          formatUploadUrl: true,\r\n          allowImageRemote: false,\r\n          afterUpload: function(url) {\r\n            //console.log(url)\r\n          }\r\n        });\r\n        KindEditor.create(\"#edit\", {\r\n          width: \"90%\",\r\n          height: this.editorHeight + \"px\",\r\n          themeType: \"simple\",\r\n          items: [\r\n            \"undo\",\r\n            \"redo\",\r\n            \"|\",\r\n            \"selectall\",\r\n            \"formatblock\",\r\n            \"fontname\",\r\n            \"fontsize\",\r\n            \"|\",\r\n            \"forecolor\",\r\n            \"hilitecolor\",\r\n            \"bold\",\r\n            \"italic\",\r\n            \"underline\",\r\n            \"strikethrough\",\r\n            \"lineheight\",\r\n            \"removeformat\",\r\n            \"|\",\r\n            \"preview\",\r\n            \"cut\",\r\n            \"copy\",\r\n            \"paste\",\r\n            \"plainpaste\",\r\n            \"|\",\r\n            \"justifyleft\",\r\n            \"justifycenter\",\r\n            \"justifyright\",\r\n            \"justifyfull\",\r\n            \"insertorderedlist\",\r\n            \"insertunorderedlist\",\r\n            \"indent\",\r\n            \"outdent\",\r\n            \"subscript\",\r\n            \"superscript\",\r\n            \"|\",\r\n            \"image\",\r\n            \"hr\",\r\n            \"code\"\r\n          ],\r\n          resizeType: 1,\r\n          newlineTag: \"br\",\r\n          imageTabIndex: 1,\r\n          uploadJson: \"/KnowledgesController/savePic\",\r\n          filePostName: \"file\",\r\n          allowImageUpload: true,\r\n          allowFileManager: false,\r\n          formatUploadUrl: true,\r\n          allowImageRemote: false,\r\n          afterUpload: function(url) {\r\n            //console.log(url)\r\n          }\r\n        });\r\n      },\r\n      getselect() {\r\n        service\r\n          .getListGroupType()\r\n          .then(res => {\r\n            this.subjectGroupType = res.data;\r\n          })\r\n          .catch(err => {\r\n            console.log(err);\r\n          });\r\n        service\r\n          .getListType()\r\n          .then(res => {\r\n            this.subjectType = res.data;\r\n          })\r\n          .catch(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      //课题名称\r\n      getAllList() {\r\n        service\r\n          .getAllList()\r\n          .then(res => {\r\n            console.log(res);\r\n            // 将获取回来的数据赋值给list\r\n            this.newsLists = res.data;\r\n            console.log(this.newsLists);\r\n            this.newsList = this.newsLists[0];\r\n            // (this.activeIndex = this.newsList.subjectId),\r\n            console.log(this.activeIndex);\r\n            this.editDetail = {\r\n              subjectName: this.newsList.subjectName,\r\n              subjectTime: this.newsList.subjectTime,\r\n              subjectType: this.newsList.subjectType,\r\n              subjectGroupType: this.newsList.subjectGroupType,\r\n              subjectDest: this.newsList.subjectDest\r\n            };\r\n            console.log(this.editDetail);\r\n          })\r\n          .catch(err => {\r\n            console.log(err);\r\n          });\r\n      },\r\n      //新增\r\n      addProject(formName, fileList) {\r\n        let subjectRemark = KindEditor.instances[0]\r\n          .html()\r\n          .split(\"\\n\")\r\n          .join(\"\");\r\n        console.log(subjectRemark);\r\n        this.$refs[\"formName\"].validate(valid => {\r\n          if (valid) {\r\n            this.addDetail = {\r\n              subjectRemark: subjectRemark,\r\n              subjectName: this.addDetail.subjectName,\r\n              subjectTime: this.addDetail.subjectTime,\r\n              subjectType: this.addDetail.subjectType,\r\n              subjectGroupType: this.addDetail.subjectGroupType,\r\n              subjectDest: this.addDetail.subjectDest\r\n            };\r\n            let params = {\r\n              csl: this.addDetail,\r\n              cslas: this.fileList\r\n            };\r\n            console.log(params);\r\n            service\r\n              .addTogether(params)\r\n              .then(response => {\r\n                alert(\"submit!\");\r\n                this.getAllList();\r\n              })\r\n              .catch(error => {\r\n                console.log(error);\r\n              });\r\n            this.dialogFormVisible = false;\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n      },\r\n      //删除\r\n      deleteProject() {\r\n        this.$confirm(\"确认删除？\")\r\n          .then(_ => {\r\n            let params = {\r\n              subjectId: this.newsList.subjectId\r\n            };\r\n            console.log(params);\r\n            service\r\n              .delOneCheckSubject(params)\r\n              .then(response => {\r\n                console.log(response);\r\n                // 加载列表\r\n                this.getAllList();\r\n              })\r\n              .catch(error => {\r\n                console.log(error);\r\n              });\r\n          })\r\n          .catch(_ => {});\r\n      },\r\n      //编辑\r\n      edit() {\r\n        new Promise((resolve, reject) => {\r\n          this.dialogVisible = true;\r\n          resolve(\"success\");\r\n        }).then(() => {\r\n          this.initEdit();\r\n          KindEditor.instances[0].html(this.newsList.subjectRemark);\r\n          console.log(this.newsList.subjectRemark);\r\n        });\r\n      },\r\n      //确认更新\r\n      update(subjectId, formName) {\r\n        let subjectRemarks = KindEditor.instances[0]\r\n          .html()\r\n          .split(\"\\n\")\r\n          .join(\"\");\r\n        console.log(subjectRemarks);\r\n        this.$refs[formName].validate(valid => {\r\n          if (valid) {\r\n            this.editDetail = {\r\n              subjectId: this.newsList.subjectId,\r\n              subjectRemark: subjectRemarks,\r\n              subjectName: this.editDetail.subjectName,\r\n              subjectTime: this.editDetail.subjectTime,\r\n              subjectType: this.editDetail.subjectType,\r\n              subjectGroupType: this.editDetail.subjectGroupType,\r\n              subjectDest: this.editDetail.subjectDest\r\n            };\r\n            let params = {\r\n              csl: this.editDetail\r\n            };\r\n            console.log(params);\r\n            service\r\n              .getUpdate(params)\r\n              .then(response => {\r\n                this.showdetail();\r\n              })\r\n              .catch(error => {\r\n                console.log(error);\r\n              });\r\n            this.dialogVisible = false;\r\n            alert(\"submit!\");\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n      },\r\n      submitUpload(editDetail, filesList) {\r\n        this.$refs.upload.submit();\r\n        let params = {\r\n          subjectId: this.editDetail.subjectId,\r\n          csla: this.filesList\r\n        };\r\n        console.log(params);\r\n        service\r\n          .addAttachInfo(params)\r\n          .then(response => {})\r\n          .catch(error => {\r\n            console.log(error);\r\n          });\r\n      },\r\n      handleRemove(file, fileList) {\r\n        console.log(file, fileList);\r\n      },\r\n      handlePreview(file) {\r\n        console.log(file);\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  .project {\r\n    position: absolute;\r\n    top: 0px;\r\n    bottom: 0;\r\n    left: 0;\r\n    right: 0;\r\n    min-width: 1150px;\r\n  }\r\n  .el-menu-item,\r\n  .el-submenu__title,\r\n  .el-submenu .el-menu-item {\r\n    height: 40px !important;\r\n    line-height: 40px !important;\r\n    color: #666666 !important;\r\n    font-size: 14px;\r\n  }\r\n  .el-aside>div,\r\n  .el-aside>div>ul {\r\n    height: 100%;\r\n  }\r\n  .el-menu-item.is-active {\r\n    color: #666666 !important;\r\n    border-right: 3px solid rgba(24, 144, 255, 1);\r\n    background-color: rgba(230, 247, 255, 1);\r\n  }\r\n  .select-project button {\r\n    background: #008cd5;\r\n    border: 0;\r\n    cursor: pointer;\r\n    padding: 9px 18px;\r\n    border-radius: 3px;\r\n    color: #fff;\r\n    margin: 20px 44px;\r\n  }\r\n  .del-project {\r\n    color: red;\r\n    cursor: pointer;\r\n  }\r\n  .edit-project {\r\n    color: #008cd5;\r\n    cursor: pointer;\r\n  }\r\n  .dialog-footer {\r\n    margin-top: 20px !important;\r\n    margin-right: 40% !important;\r\n    margin-bottom: 20px !important;\r\n  }\r\n  .updateweekly {\r\n    margin-top: 5px;\r\n    float: left;\r\n  }\r\n  .bg-purple {\r\n    background: #ffffff;\r\n  }\r\n  .grid-content {\r\n    border-radius: 4px;\r\n    color: #333333;\r\n  }\r\n  .article-header {\r\n    color: #333333;\r\n    padding: 20px 40px 0px 30px;\r\n  }\r\n  .article-title {\r\n    font-size: 24px;\r\n  }\r\n  .article-info {\r\n    color: #a1a1a1;\r\n    font-size: 12px;\r\n    margin: 15px 0px 15px 0px;\r\n  }\r\n  .article-info span {\r\n    margin-right: 10px;\r\n  }\r\n  .article-info-left {\r\n    float: left;\r\n  }\r\n  .article-info-right {\r\n    float: right;\r\n  }\r\n  .article-content {\r\n    color: #666666;\r\n    padding: 0px 40px 14px 30px;\r\n  }\r\n  .know-article {\r\n    padding: 15px 0;\r\n    font-size: 14px;\r\n    margin-bottom: 20px;\r\n  }\r\n  .know-articles {\r\n    padding-bottom: 20px;\r\n  }\r\n  .article-attachs {\r\n    padding-top: 15px;\r\n    border-top: 1px #eeeeee solid;\r\n  }\r\n  .updateweekly {\r\n    margin-top: 5px;\r\n    float: left;\r\n  }\r\n  .selfile {\r\n    margin-left: 10px !important;\r\n  }\r\n  /* .el-form-item__content {\r\n    float: right;\r\n  } */\r\n</style>\n\n\n// WEBPACK FOOTER //\n// traineeExamineSys/views/project.vue","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-f5af96ae\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./project.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"2d9a7d22\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-style-loader!../node_modules/css-loader?minimize!../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-f5af96ae\",\"scoped\":true,\"hasInlineConfig\":false}!../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./traineeExamineSys/views/project.vue\n// module id = WcYe\n// module chunks = 0","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_classof.js\n// module id = ZHvQ\n// module chunks = 0","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_is-array-iter.js\n// module id = af0K\n// module chunks = 0","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_iter-call.js\n// module id = hEIm\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/kindeditor/themes/default/default.css\n// module id = iFdl\n// module chunks = 0 1 2 3 4","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_invoke.js\n// module id = o4G5\n// module chunks = 0","module.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_perform.js\n// module id = kX4D\n// module chunks = 0","var ctx = require('./_ctx');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar getIterFn = require('./core.get-iterator-method');\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_for-of.js\n// module id = ozpD\n// module chunks = 0","function injectStyle (ssrContext) {\n  require(\"!!vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-f5af96ae\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./project.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./project.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./project.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-f5af96ae\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./project.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-f5af96ae\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./traineeExamineSys/views/project.vue\n// module id = tleg\n// module chunks = 0","var ctx = require('./_ctx');\nvar invoke = require('./_invoke');\nvar html = require('./_html');\nvar cel = require('./_dom-create');\nvar global = require('./_global');\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (require('./_cof')(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/_task.js\n// module id = uzcO\n// module chunks = 0","// https://github.com/tc39/proposal-promise-finally\n'use strict';\nvar $export = require('./_export');\nvar core = require('./_core');\nvar global = require('./_global');\nvar speciesConstructor = require('./_species-constructor');\nvar promiseResolve = require('./_promise-resolve');\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/core-js/library/modules/es7.promise.finally.js\n// module id = zaru\n// module chunks = 0"],"sourceRoot":""}